<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="Author" content="Nikolay Kirov">
    <meta name="GENERATOR" content="Mozilla/4.75 [en] (Win98; U)
      [Netscape]">
    <title>lec12</title>
  </head>
  <body>
    <h2>12. Алгоритъм на Уоршал и топологично сортиране<br>
    </h2>
    *** <b>Алгоритъм на Уоршал и матрица на достижимост</b> [5.4.2,
    стр. 293]<br>
    <br>
    Нека е даден ориентиран граф G с <i>матрица на съседство</i> A.
    Mатрица A' се нарича <i>матрица на достижимост</i> когато:<br>
    - A'[i][j] = 1, тогава и само тогава, когато съществува път (с
    каквато и да е дъл- жина) между върховете i и j.<br>
    - A'[i][j] = 0, когато път между двата върха не съществува.<br>
    Графът G', чиято <i>матрица на </i><i>съседство </i>е матрицата
    A' се нарича транзитивно затворен граф на G.<br>
    <br>
    Алгоритъм на Уоршал за намиране на транзитивно затваряне:<br>
    1. G' съдържа всички дъги на G.<br>
    2. За всеки три върха k, i, j на графа G, ако има дъги (i, k) и (k,
    j), то добавяме (i, j) като ребро на графа G'.<br>
    <br>
    <font size="+1"><tt>for (k = 0; k &lt; n; k++)</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; for (i = 0; i &lt; n; i++) <br>
        {</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; if (A[i][k])</tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j = 0; j &lt; n; j++)</tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (A[k][j])
        A[i][j] = 1; <br>
        }<br>
      </tt></font>Сложност на алгоритъма <i>O</i>(<i>n</i><sup>3</sup>).<font
      size="+1"><tt><br>
      </tt></font>
    <hr size="2" width="100%"><b>*** Топологично сортиране </b>[5.5.5,
    стр. 320], [AL p.149]<br>
    <br>
    Toпологично сортиране на ориентиран ацикличен граф се нарича
    линейно нареден списък от върховете му, такъв, че за всеки два
    върха i и j,&nbsp; за които има път от i до j, върхът i е преди j.<br>
    За повечето ориентирани ациклични графи съществуват повече от един
    такива списъци.<br>
    <i>Пример: </i><br>
    (1, 2), (2, 3), (3, 6), (4, 1), (4, 5), (5, 2), (5, 3)<br>
    <br>
    <img src="images/ts1.png" alt="ts1" width="230" height="127"><br>
    <br>
    <img src="images/ts2.png" alt="ts2" width="323" height="60"><br>
    Първи вариант: 4, 1, 5, 2, 3, 6<br>
    Втори вариант: 4, 5, 1, 2, 3, 6<br>
    <br>
    <i>Алгоритъм 1 за топологично сортиране</i><i>:</i><br>
    1. Инициализираме Z като празен списък.<br>
    2. Избираме връх i без предшественици и го добавяме в края на
    списъка Z. <br>
    3. Изключваме i от графа, както и всички ребра, инцидентни с него.<br>
    4. Повтаряме стъпка 2, докато не остане нито един връх.<br>
    <img src="images/tsa1.png" alt="tsa1" width="237" height="113"><img
      src="images/tsa2.png" alt="tsa2" width="224" height="110"><img
      src="images/tsa3.png" alt="tsa3" width="217" height="101"><br>
    -- Ако на стъпка 2 има повече от един връх без предшественици,
    избираме произволен.<br>
    -- Ако на стъпка 2 няма нито един връх без предшественици, а в графа
    има още върхове, то следва, че графът е цикличен, което противоречи
    на условието и следователно не съществува топологично сортиране. <br>
    -- Обратното също е вярно: ако графът е цикличен, то на някоя стъпка
    от алгоритъма задължително ще попаднем в описаната ситуация.<br>
    За всеки ацикличн граф има топологично сортиране. Ако обаче графът
    съдържа<br>
    цикъл, няма топологично сортиране, тъй като няма възел от цикъла,
    който<br>
    може да бъде преди останалите възли на цикъла при подреждането.
    Следователно<br>
    алгоритъмът за топологичното сортиране може да се използва и за
    проверка дали ориентирани граф съдържа цикъл и, ако не съдържа
    цикъл, да се получи топологично сортиране.<br>
    Сложност на алгоритъма <i>O</i>(<i>n</i><sup>2</sup>).<br>
    Aко графът е представен чрез списък на наследниците (или списък на
    предшествениците), то алгоритъмът може да се реализира с обща
    сложност <i>О</i>(<i>n+m</i>).<br>
    <br>
    <i>Алгоритъм 2 за топологично сортиране:</i><br>
    На всяка стъпка търсим връх без наследници и така получаваме
    топологично сортиране на графа в обратен ред. Реализацията се
    извършва, като се използва обратният ход на рекурсията във функцията
    за обхождане в дълбочина:<br>
    <br>
    <font size="+1"><tt>void DFS(unsigned i) </tt><tt><br>
      </tt><tt>{ </tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp; </tt><tt>unsigned k;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp; used[i] = 1;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp; for (k = 0; k &lt; n; k++)</tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (A[i][k]
        &amp;&amp; !used[k]) DFS(k); </tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp; </tt><tt>cout &lt;&lt; i + 1 &lt;&lt;
        " ";</tt><tt><br>
      </tt><tt>}<br>
      </tt></font><br>
    <font size="+1">Сложност на алгоритъма </font><i>О</i>(<i>n+m</i>).
    <br>
    <br>
    <a
      href="https://www.cs.usfca.edu/%7Egalles/visualization/TopoSortDFS.html">Визуализация</a><br>
    <hr size="2" width="100%"><b>** Задача за намиране на всички пътища</b><br>
    Да се намери броя на пътищата между два върха на ориентиран граф.<br>
    <i>Пример:</i> Търси се колко пътища има от 1 до 6.<br>
    <img src="images/np1.png" alt="np1" width="200" height="121"><br>
    Ще приложим динамично оптимиране с рекурентна формула за броя на
    пътищата <i>p</i>(<i>x</i>) до връх <i>x</i>:<br>
    <i>p</i>(<i>x</i>) = <i>p</i>(<i>a</i><sub>1</sub>) + <i>p</i>(<i>a</i><sub>2</sub>)
    + ... + <i>p</i>(<i>a<sub>n</sub></i>).<br>
    където <i>a</i><sub>1</sub><i>, </i><i>a</i><sub>2</sub>, ..., <i>a<sub>n</sub></i>
    са предшественици на <i>x </i>(от които има дъги към <i>x</i>).<br>
    Изчисленията следват линейната наредба на топологическото сортиране.<br>
    <img
src="file:///Users/nkirov/git/nkirov.github.com/2020/CSCB325/lectures/images/np2.png"
      alt="np2" width="275" height="61"><br>
    Така получаваме броя на пътищата от връх 1 до всички други върхове
    на графа.<br>
    <img src="images/np3.png" alt="np3" width="184" height="148"><br>
    <hr size="2" width="100%"><b>*** Пълно топологично сортиране</b>
    [5.5.6, стр. 322]<br>
    <br>
    Mножеството от всички възможни списъци (топологични сортирания) се
    нарича пълно топологично сортиране.<br>
    <br>
    <br>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Програмиране = ++Алгоритми; (Programming = ++Algorithms;)</title>
    <hr size="2" width="100%">
  </body>
</html>
