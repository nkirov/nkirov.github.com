<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
   <meta name="Author" content="Nikolay Kirov">
   <meta name="GENERATOR" content="Mozilla/4.75 [en] (Win98; U) [Netscape]">
   <title>l10</title>
</head>
<body>

<hr WIDTH="100%">
<p><b>10. Реализация на свързани списъци</b>
<p><img SRC="bullet.gif" height=18 width=20 align=ABSCENTER>&nbsp; Реализация
на свързани списъци - класове, итератори,&nbsp; операции
<p><b><tt><font color="#000099">// list2.cpp</font></tt></b>
<br><b><tt><font color="#000099">#include &lt;string></font></tt></b>
<br><b><tt><font color="#000099">#include &lt;iostream></font></tt></b>
<br><b><tt><font color="#000099">#include &lt;cassert></font></tt></b>
<br><b><tt><font color="#000099">using namespace std;</font></tt></b>
<p><b><tt><font color="#000099">class List;</font></tt></b>
<br><b><tt><font color="#000099">class Iterator;</font></tt></b>
<p><b><tt><font color="#000099">class Link&nbsp; {</font></tt></b>
<br><b><tt><font color="#000099">public:</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; Link(string s);</font></tt></b>
<br><b><tt><font color="#000099">private:</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; string data;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* previous;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* next;</font></tt></b>
<br><b><tt><font color="#000099">friend class List;</font></tt></b>
<br><b><tt><font color="#000099">friend class Iterator;</font></tt></b>
<br><b><tt><font color="#000099">};</font></tt></b>
<p><b><tt><font color="#000099">class List&nbsp; {</font></tt></b>
<br><b><tt><font color="#000099">public:</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; List();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; void push_back(string s);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; void insert(Iterator iter,
string s);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; void erase(Iterator iter);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Iterator begin();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Iterator end();</font></tt></b>
<br><b><tt><font color="#000099">private:</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* first;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* last;</font></tt></b>
<br><b><tt><font color="#000099">};</font></tt></b>
<p><b><tt><font color="#000099">class Iterator&nbsp; {</font></tt></b>
<br><b><tt><font color="#000099">public:</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Iterator();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; string get() const;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; void next();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; void previous();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; bool not_equal(Iterator b)
const;</font></tt></b>
<br><b><tt><font color="#000099">private:</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* position;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* last;</font></tt></b>
<br><b><tt><font color="#000099">friend class List;</font></tt></b>
<br><b><tt><font color="#000099">};</font></tt></b>
<p><b><tt><font color="#000099">Link::Link(string s)</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; data = s;&nbsp;&nbsp; previous
= NULL;&nbsp;&nbsp; next = NULL;&nbsp; }</font></tt></b>
<p><b><tt><font color="#000099">List::List()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; first = NULL;&nbsp;&nbsp; last
= NULL;&nbsp; }</font></tt></b>
<p><b><tt><font color="#000099">void List::push_back(string s)</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; Link* newlink = new Link(s);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; if (last == NULL)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/* list is empty */</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; {&nbsp; first = newlink;&nbsp;&nbsp;&nbsp;&nbsp;
last = newlink;&nbsp;&nbsp; }</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; else</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; {&nbsp; newlink->previous
= last;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; last->next
= newlink;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; last =
newlink;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; }</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<p><b><tt><font color="#000099">void List::insert(Iterator iter, string
s)</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; if (iter.position == NULL)</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; {&nbsp; push_back(s);&nbsp;
return;&nbsp; }</font></tt></b>
<p><b><tt><font color="#000099">&nbsp;&nbsp; Link* after = iter.position;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* before = after->previous;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* newlink = new Link(s);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; newlink->previous = before;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; newlink->next = after;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; after->previous = newlink;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; if (before == NULL) /* insert
at beginning */</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; first =
newlink;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; else</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; before->next
= newlink;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<p><b><tt><font color="#000099">void List::erase(Iterator iter)</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; assert(iter.position != NULL);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* remove = iter.position;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* before = remove->previous;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Link* after = remove->next;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; if (remove == first) first
= after;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
before->next = after;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; if (remove == last)&nbsp;
last = before;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
after->previous = before;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; iter.position = after;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; delete remove;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<p><b><tt><font color="#000099">Iterator List::begin()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; Iterator iter;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; iter.position = first;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; iter.last = last;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; return iter;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<p><b><tt><font color="#000099">Iterator List::end()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; Iterator iter;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; iter.position = NULL;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; iter.last = last;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; return iter;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<p><b><tt><font color="#000099">Iterator::Iterator()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; position = NULL;&nbsp;&nbsp; last
= NULL;&nbsp; }</font></tt></b>
<p><b><tt><font color="#000099">string Iterator::get() const</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; assert(position != NULL);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; return position->data;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<p><b><tt><font color="#000099">void Iterator::next()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; assert(position != NULL);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; position = position->next;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<p><b><tt><font color="#000099">void Iterator::previous()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; if (position == NULL)&nbsp; position
= last;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
position = position->previous;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; assert(position != NULL);</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<p><b><tt><font color="#000099">bool Iterator::not_equal(Iterator b) const</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; return position != b.position;&nbsp;&nbsp;
}</font></tt></b>
<p><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; List staff;</font></tt></b>
<p><b><tt><font color="#000099">&nbsp;&nbsp; staff.push_back("Cracker,
Carl");</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; staff.push_back("Hacker,
Harry");</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; staff.push_back("Lam, Larry");</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; staff.push_back("Sandman,
Susan");</font></tt></b>
<p><b><tt><font color="#000099">&nbsp;&nbsp; /* add a value in fourth place
*/</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Iterator pos;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; pos = staff.begin();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; pos.next();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; pos.next();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; pos.next();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; staff.insert(pos, "Reindeer,
Rudolf");</font></tt></b>
<p><b><tt><font color="#000099">&nbsp;&nbsp; /* remove the value in second
place */</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; pos = staff.begin();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; pos.next();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; staff.erase(pos);</font></tt></b>
<p><b><tt><font color="#000099">&nbsp;&nbsp; /* print all values */</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; for (pos = staff.begin();
pos.not_equal(staff.end());</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pos.next())&nbsp;&nbsp; cout &lt;&lt; pos.get() &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br>
<hr WIDTH="100%">
</body>
</html>
