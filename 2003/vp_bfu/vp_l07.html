<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
   <meta name="Author" content="Nikolay Kirov">
   <meta name="GENERATOR" content="Mozilla/4.75 [en] (Win98; U) [Netscape]">
   <title>vp_l07</title>
</head>
<body>

<hr WIDTH="100%">
<center>
<p><b><font size=+1>7. Функции&nbsp; I</font></b></center>

<div align=right><b><i><font size=-1>&nbsp;</font></i></b>
<br><b><i><font size=-1>"Нормалната диастолна функция е левокамерно пълнене
при нормално</font></i></b>
<br><b><i><font size=-1>пулмокапилярно налягане (до 12 мм Нg) даващо възможност
за</font></i></b>
<br><b><i><font size=-1>минутен обем достатъчен за нуждите на тялото."</font></i></b>
<br><b><i><font size=-1>Съвременна медицина, 1991 кн 6.</font></i></b>
<br><b><i><font size=-1>&nbsp;</font></i></b></div>
<img SRC="bullet.gif" height=18 width=20>&nbsp; Използване на функции (функциите
като черни кутии).
<br>* Нека е дадена следната проста програма:
<br><b><tt><font color="#000099">#include &lt;iostream></font></tt></b>
<br><b><tt><font color="#000099">using namespace std;</font></tt></b>
<br><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{ double x = 2.5;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; cout &lt;&lt; sqrt(x);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><font color="#000000">&nbsp;&nbsp;&nbsp; Входната стойност или стойността
на параметъра<b><tt> x </tt></b>се предава на функцията <b><tt>sqrt</tt></b>.
Изпълнението на функцията <b><tt>main</tt></b> се преустановява временно.
Управлението се предава на функцията <b><tt>sqrt</tt></b>, която изчислява
изхода или стойността на функцията - квадратен корен от входната стойност.
Полученият резултат (върнатата от sqrt стойност) се предава обратно на
<b><tt>main</tt></b>,
която възобновява работата си, използвайки получената стойност (отпечатва
я на екрана).</font>
<br>* Входни стойности (параметри) на функции.
<table COLS=2 WIDTH="100%" >
<tr>
<td>- видове:
<table BORDER CELLSPACING=0 CELLPADDING=4 >
<tr>
<td><font color="#000000">функция</font></td>

<td>вид параметър</td>
</tr>

<tr>
<td><b><tt><font color="#009900">sqrt(x)</font></tt></b></td>

<td>променлива</td>
</tr>

<tr>
<td><b><tt><font color="#009900">sqrt(2.5)</font></tt></b></td>

<td>константа</td>
</tr>

<tr>
<td><b><tt><font color="#009900">sqrt(x+1.02)</font></tt></b></td>

<td>израз</td>
</tr>
</table>
</td>

<td>- брой:
<table BORDER CELLSPACING=0 CELLPADDING=4 >
<tr>
<td><font color="#000000">функция</font></td>

<td>брой параметри</td>
</tr>

<tr>
<td><b><tt><font color="#009900">sqrt(x)</font></tt></b></td>

<td>1</td>
</tr>

<tr>
<td><b><tt><font color="#009900">pow(x,y)</font></tt></b></td>

<td>2</td>
</tr>

<tr>
<td><b><tt><font color="#009900">p.get_x()</font></tt></b></td>

<td>0</td>
</tr>
</table>
</td>
</tr>
</table>
<font size=-2>&nbsp;</font>
<br>- неявни параметри - за член-функции:
<table BORDER CELLSPACING=0 CELLPADDING=4 >
<tr>
<td><font color="#000000">функция</font></td>

<td><font color="#000000">неявен параметър</font></td>

<td><font color="#000000">тип на неявния параметър</font></td>
</tr>

<tr>
<td><b><tt><font color="#006600">harry.get_salary()</font></tt></b></td>

<td><b><tt><font color="#006600">harry</font></tt></b></td>

<td><b><tt><font color="#006600">Employee</font></tt></b></td>
</tr>

<tr>
<td><b><tt><font color="#006600">t.add_seconds(10)</font></tt></b></td>

<td><b><tt><font color="#006600">t</font></tt></b></td>

<td><b><tt><font color="#006600">Time</font></tt></b></td>
</tr>

<tr>
<td><b><tt><font color="#006600">msg.move(dx,dy)</font></tt></b></td>

<td><b><tt><font color="#006600">msg</font></tt></b></td>

<td><b><tt><font color="#006600">Message</font></tt></b></td>
</tr>
</table>

<p>- изисквания за параметрите:
<table BORDER CELLSPACING=0 CELLPADDING=4 >
<tr>
<td><font color="#000000">функция</font></td>

<td><font color="#000000">изисквания за параметрите</font></td>
</tr>

<tr>
<td><b><tt><font color="#009900">fabs(w)</font></tt></b></td>

<td>параметърът&nbsp;<font color="#000000"> </font><b><tt><font color="#009900">w
</font></tt></b><font color="#000000">е
от тип </font><b><tt><font color="#009900">double</font></tt></b>, константа
или променлива</td>
</tr>

<tr>
<td NOWRAP><b><tt><font color="#006600">t.second_from(t1)</font></tt></b></td>

<td>параметърът&nbsp;<font color="#000000"> </font><b><tt><font color="#006600">t1
</font></tt></b><font color="#000000">е
от тип </font><b><tt><font color="#009900">Time</font></tt></b>, константа
или променлива</td>
</tr>

<tr>
<td><b><tt><font color="#009900">getline(cin,s)</font></tt></b></td>

<td><font color="#000000">първият параметър трябва да е </font><b><tt><font color="#009900">cin</font></tt></b><font color="#000000">,
вторият</font>
<br><font color="#000000">параметър трябва да е променлива от тип </font><b><tt><font color="#009900">string</font></tt></b></td>
</tr>
</table>

<p>* Изходната стойност (стойността на функцията) е от определен тип:
<table BORDER CELLSPACING=0 CELLPADDING=4 >
<tr>
<td><font color="#000000">функция</font></td>

<td><font color="#000000">тип на изходната стойност</font></td>
</tr>

<tr>
<td><b><tt><font color="#009900">sqrt(x)</font></tt></b></td>

<td><b><tt><font color="#009900">double</font></tt></b></td>
</tr>

<tr>
<td><b><tt><font color="#009900">c.get_center()</font></tt></b></td>

<td><b><tt><font color="#009900">Point</font></tt></b></td>
</tr>

<tr>
<td><b><tt><font color="#009900">m.get_text()</font></tt></b></td>

<td><b><tt><font color="#009900">string</font></tt></b></td>
</tr>

<tr>
<td><b><tt><font color="#009900">getline(cin,s)</font></tt></b></td>

<td><font color="#000000">не връща стойност</font></td>
</tr>
</table>

<hr WIDTH="100%">
<br><img SRC="bullet.gif" height=18 width=20>&nbsp; Писане на функции.
<br>&nbsp;&nbsp;&nbsp; Да се пресметне стойността на влог с начална сума
1000 лв. след 10 години при месечно начисляване на лихвата. Нека годишната
лихва да е p%. Използва се формулата за пресмятане на сложна лихва.
<br><b><tt><font color="#006600">double future_value(double p)</font></tt></b>
<br><b><tt><font color="#006600">{ double b = 1000*pow(1 + p/(12*100),
12*10);</font></tt></b>
<br><b><tt><font color="#006600">&nbsp; return b;</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br>Функцията се дефинира като се укаже: тип на резултата (на връщаната
стойност), име на функцията, тип на параметъра, име на параметъра, тяло
на функцията.
<br><b><tt><font color="#000099">// futeval.cpp</font></tt></b>
<br><b><tt><font color="#000099">#include &lt;iostream></font></tt></b>
<br><b><tt><font color="#000099">#include &lt;cmath></font></tt></b>
<br><b><tt><font color="#000099">using namespace std;</font></tt></b>
<p><b><tt><font color="#000099">double future_value(double p)</font></tt></b>
<br><b><tt><font color="#000099">{ double b = 1000*pow(1 + p/(12*100),
12*10);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; return b;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{ cout &lt;&lt; "Please enter the interest
rate in percent: ";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; double rate;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; cin >> rate;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; double balance = future_value(rate);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; cout &lt;&lt; "After 10 years,
the balance is " &lt;&lt; balance &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<table BORDER CELLPADDING=4 COLS=1 WIDTH="100%" >
<tr>
<td><b><tt><font color="#990000">Please enter the interest rate in percent:
</font><font color="#006600">6</font></tt></b>
<br><b><tt><font color="#990000">After 10 years, the balance is 1819.4</font></tt></b></td>
</tr>
</table>

<p><img SRC="bullet.gif" height=18 width=20> Връщане на стойност.
<br>** Използване на операто<font color="#000000">р <b><tt>return.</tt></b></font>
<br>&nbsp;&nbsp;&nbsp; Друго решение на същата задача - сега функцията
<b><tt><font color="#000000">future_value
</font></tt></b>има
3 параметъра - началната сума, годишната лихва и брой години на престоя
на влога в банката. Опе<font color="#000000">ратор <b><tt>return
</tt></b>се
изпол</font>зва за прекратяване на работата на функцията (при некоректни
входни данни).
<br><b><tt><font color="#000099">//futval0.cpp</font></tt></b>
<br><b><tt><font color="#000099">#include &lt;iostream></font></tt></b>
<br><b><tt><font color="#000099">#include &lt;cmath></font></tt></b>
<br><b><tt><font color="#000099">using namespace std;</font></tt></b>
<p><b><tt><font color="#000099">double future_value(double initial_balance,
double p, int nyear)</font></tt></b>
<br><b><tt><font color="#000099">/*</font></tt></b>
<br><b><tt><font color="#3333FF">ЦЕЛ:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
пресмята стойността на влог със сложна лихва</font></tt></b>
<br><b><tt><font color="#3333FF">ПОЛУЧАВА:&nbsp; initial_balance - начална
стойност на влога</font></tt></b>
<br><b><tt><font color="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
p - годишен лихвен процент</font></tt></b>
<br><b><tt><font color="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nyear - броя на годините</font></tt></b>
<br><b><tt><font color="#3333FF">ЗАБЕЛЕЖКИ: лихвата се начислява всеки
месец</font></tt></b>
<br><b><tt><font color="#000099">*/</font></tt></b>
<br><b><tt><font color="#000099">{ if (nyear &lt; 0) return 0;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp; if (p &lt; 0) return 0;</font></tt></b>
<br><font color="#000099">&nbsp;&nbsp;<b><tt> double b = initial_balance*pow(1
+ p/(12*100), 12*nyear);</tt></b></font>
<br><b><tt><font color="#000099">&nbsp; return b;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;cout &lt;&lt; "Interest rate in
percent: ";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;double rate;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;cin >> rate;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;double bal = future_value(1000,
rate, 10);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;cout &lt;&lt; "After 10 years, the
balance is " &lt;&lt; bal &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<table BORDER CELLPADDING=4 WIDTH="100%" >
<tr>
<td><b><tt><font color="#990000">Interest rate in percent: 8.5</font></tt></b>
<br><b><tt><font color="#990000">After 10 years, the balance is 2332.65</font></tt></b></td>
</tr>
</table>

<p>** Предикат - проверка дали точка лежи в кръг.
<br><b><tt><font color="#000099">// inside.cpp</font></tt></b>
<br><b><tt><font color="#000099">#include "ccc_win.cpp"</font></tt></b>
<p><b><tt><font color="#000099">bool is_inside(Point p, Circle c)</font></tt></b>
<br><b><tt><font color="#000066">/* </font><font color="#3333FF">ЦЕЛ:&nbsp;
проверява дали точка p лежи в кръга c</font></tt></b>
<br><b><tt><font color="#3333FF">&nbsp;&nbsp; ПОЛУЧАВА: p - точка, c -
кръг</font></tt></b>
<br><b><tt><font color="#3333FF">&nbsp;&nbsp; ВРЪЩА:&nbsp; true ако p лежи
в c, в противен случай - false</font></tt></b>
<br><b><tt><font color="#000066">*/</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; double dx = p.get_x() - c.get_center().get_x();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; double dy = p.get_y() - c.get_center().get_y();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; double r = c.get_radius();</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; return dx * dx + dy * dy
&lt;= r * r;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; Circle c(Point(1, 1), 2);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; cwin &lt;&lt; c;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Point m = cwin.get_mouse("Please
click inside the circle.");</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; if (is_inside(m, c))</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cwin &lt;&lt;
Message(Point(3, 3), "Congratulations!");</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; else</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cwin &lt;&lt;
Message(Point(3, 3), "You missed!");</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br>
<hr WIDTH="100%">
<br><img SRC="bullet.gif" height=18 width=20> Параметри на функции.
<br>** Формални параметри&nbsp; - параметри-променливи, задават се при
дефиниране на функцията.
<br><b><tt><font color="#006600">double future_value(double initial_balance,
double p, int nyear)</font></tt></b>
<br>** Фактически параметри - представляват изрази за инициализация на
параметрите-променливи, указват се при извикване на функцията.
<br><b><tt><font color="#003300">b = future_value(total/2, rate, year1-year2);</font></tt></b>
<br><font color="#000000">&nbsp;&nbsp;&nbsp; Фактическите параметри съответстват
по тип и брой на формалните параметри. В този пример променливите </font><b><tt><font color="#003300">total</font></tt></b><font color="#000000">
и </font><b><tt><font color="#003300">rate </font></tt></b><font color="#000000">са
от тип </font><b><tt><font color="#006600">double</font></tt></b><font color="#000000">,
а </font><font color="#003300"><b><tt>year1</tt></b> и <b><tt>year2</tt></b></font><font color="#000000">
са от тип </font><b><tt><font color="#003300">int</font></tt></b><font color="#000000">
.</font>
<br>
<hr WIDTH="100%">
<br><img SRC="bullet.gif" height=18 width=20> Деклариране на функции.
<br>&nbsp;&nbsp;&nbsp; Функциите трябва да бъдат известни, преди да бъдат
използвани. Дефинирането на дадена функция преди да бъде използвана не
винаги е удобно, особено при по-големи програми, които съдържат много функции.
За да използваме (извикаме) една функция достатъчно е са известни типа
и името на функцията и типовете на параметрите й. Тези данни се съдържат
в декларацията на функцията, която се състои от: тип на функцията (на връщаната
стойност), име на функцията, типове и имена на параметри, точка и запетая.
<br>&nbsp;&nbsp;&nbsp; В езика C++ файла с текста на програмата се подрежда
най-често по следния начин:&nbsp; декларация на функция, използване на
функция, дефиниране на функция. Декларациите на стандартните за езика функции
са в заглавните файлове.
<br><b><tt><font color="#006600">#include &lt;iostream></font></tt></b>
<br><b><tt><font color="#006600">#include &lt;cmath></font></tt></b>
<br><b><tt><font color="#006600">using namespace std;</font></tt></b>
<p><b><tt><font color="#006600">/* декларация на функцията future_value
*/</font></tt></b>
<br><b><tt><font color="#006600">double future_value(double initial_balance,
double p, int nyear);</font></tt></b>
<br><b><tt><font color="#006600">int main()</font></tt></b>
<br><b><tt><font color="#006600">{ ...</font></tt></b>
<br><b><tt><font color="#006600">/* използване на функцията future_value
*/</font></tt></b>
<br><b><tt><font color="#006600">&nbsp;double bal = future_value(10000,
rate, 10);</font></tt></b>
<br><b><tt><font color="#006600">&nbsp;...</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><b><tt><font color="#006600">/* дефиниция на функцията future_value
*/</font></tt></b>
<br><b><tt><font color="#006600">double future_value(double initial_balance,
double p, int nyear)</font></tt></b>
<br><b><tt><font color="#006600">{</font></tt></b>
<br><b><tt><font color="#006600">&nbsp;...</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br>
<hr WIDTH="100%">
<br><img SRC="bullet.gif" height=18 width=20> Странични ефекти и процедури.
<br>** Външно забележимият ефект от функция се нарича страничен ефект -
отпечатване на някакво съобщение, прекратяване работата на програмата и
др. Функциите по принцип не трябва да имат странични ефекти.
<br>** Когато едно действие трябва да бъде извършено многократно (поне
2 пъти), има смисъл да бъде обособено като функция. Функция, която не връща
стойност се нарича процедура.
<br>* Процедура за отпечатване на обект от тип <b><tt><font color="#000000">Time.</font></tt></b>
<br><b><tt><font color="#000099">// printtime.cpp</font></tt></b>
<br><b><tt><font color="#000099">#include &lt;iostream></font></tt></b>
<br><b><tt><font color="#000099">#include &lt;iomanip></font></tt></b>
<br><b><tt><font color="#000099">using namespace std;</font></tt></b>
<br><b><tt><font color="#000099">#include "ccc_time.cpp"</font></tt></b>
<p><b><tt><font color="#000099">void print_time(Time t)</font></tt></b>
<br><b><tt><font color="#000099">/* </font><font color="#3333FF">ЦЕЛ:&nbsp;
отпечатва времето във формат hh:mm:ss</font></tt></b>
<br><b><tt><font color="#3333FF">&nbsp;&nbsp; ПОЛУЧАВА: t - времето, което
ще се отпечати</font></tt></b>
<br><b><tt><font color="#000099">*/</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; cout &lt;&lt; t.get_hours() &lt;&lt;
":";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; if (t.get_minutes() &lt;
10) cout &lt;&lt; "0";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; t.get_minutes()
&lt;&lt; ":";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; if (t.get_seconds() &lt;
10) cout &lt;&lt; "0";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; t.get_seconds();</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{&nbsp; Time liftoff(7, 0, 15);</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; "Liftoff: ";
print_time(liftoff); cout &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; Time now;</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; "Now: "; print_time(now);
cout &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#000099">&nbsp;&nbsp; return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<table BORDER CELLPADDING=4 WIDTH="100%" >
<tr>
<td><b><tt><font color="#990000">Liftoff: 7:00:15</font></tt></b>
<br><b><tt><font color="#990000">Now: 11:59:02</font></tt></b></td>
</tr>
</table>

</body>
</html>
