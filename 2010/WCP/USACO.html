<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="ProgId" content="Word.Document">
  <meta name="Generator" content="Microsoft Word 10">
  <meta name="Originator" content="Microsoft Word 10">
  <link rel="File-List" href="USACO_files/filelist.xml">
  <title>USACO</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Velislav</o:Author>
  <o:LastAuthor>Nikolay Kirov</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:Created>2009-10-19T10:34:00Z</o:Created>
  <o:LastSaved>2009-10-19T10:34:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>23906</o:Words>
  <o:Characters>136267</o:Characters>
  <o:Company>Netage</o:Company>
  <o:Lines>1135</o:Lines>
  <o:Paragraphs>319</o:Paragraphs>
  <o:CharactersWithSpaces>159854</o:CharactersWithSpaces>
  <o:Version>10.2625</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HideSpellingErrors/>
  <w:PunctuationKerning/>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
  <style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"New York";
	panose-1:2 2 5 2 6 3 5 6 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;
	mso-font-alt:\BC14\D0D5;
	mso-font-charset:129;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1342176593 1775729915 48 0 524447 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;
	mso-font-alt:\65B0\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 134742016 16 0 1048576 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;
	mso-font-alt:"\FF2D\FF33 \30B4\30B7\30C3\30AF";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;
	mso-font-alt:\B3CB\C6C0;
	mso-font-charset:129;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\9ED1\4F53;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;
	mso-font-alt:\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134742016 16 0 1048576 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;
	mso-font-alt:\660E\671D;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;
	mso-font-alt:\AD74\B9BC;
	mso-font-charset:129;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:222;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16777217 0 0 0 65536 0;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;
	mso-font-charset:222;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16777217 0 0 0 65536 0;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:32771 0 0 0 1 0;}
@font-face
	{font-family:Latha;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1048579 0 0 0 1 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:67110535 0 0 0 159 0;}
@font-face
	{font-family:Vrinda;
	panose-1:1 1 6 0 1 1 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:65539 0 0 0 1 0;}
@font-face
	{font-family:Raavi;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:131075 0 0 0 1 0;}
@font-face
	{font-family:Shruti;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:262147 0 0 0 1 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:2097155 0 0 0 1 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:4194307 0 0 0 1 0;}
@font-face
	{font-family:"Estrangella Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129279 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421319 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Cambria Math";
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1107304683 0 0 159 0;}
@font-face
	{font-family:Calibri;
	mso-font-alt:"Century Gothic";
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073750139 0 0 159 0;}
@font-face
	{font-family:Cambria;
	mso-font-alt:"Palatino Linotype";
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073741899 0 0 159 0;}
@font-face
	{font-family:Marlett;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482993 6144 0 0 31 0;}
@font-face
	{font-family:"Lucida Sans Unicode";
	panose-1:2 11 6 2 3 5 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-2147476737 14699 0 0 63 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Comic Sans MS";
	panose-1:3 15 7 2 3 3 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Georgia;
	panose-1:2 4 5 2 5 4 5 2 3 3;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Franklin Gothic Medium";
	panose-1:2 11 6 3 2 1 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870009 1073741843 0 0 415 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Webdings;
	panose-1:5 3 1 2 1 5 9 6 7 3;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:-2147459005 0 128 0 1 0;}
@font-face
	{font-family:"MV Boli";
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 256 0 1 0;}
@font-face
	{font-family:"Microsoft Sans Serif";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421663 -2147483648 8 0 66047 0;}
@font-face
	{font-family:Kartika;
	panose-1:2 2 5 3 3 4 4 6 2 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:8388611 0 0 0 1 0;}
@font-face
	{font-family:"Arial Narrow";
	panose-1:2 11 5 6 2 2 2 3 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129279 0;}
@font-face
	{font-family:"\@Batang";
	panose-1:2 3 6 0 0 1 1 1 1 1;
	mso-font-charset:129;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1342176593 1775729915 48 0 524447 0;}
@font-face
	{font-family:"Book Antiqua";
	panose-1:2 4 6 2 5 3 5 3 3 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Century Gothic";
	panose-1:2 11 5 2 2 2 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Garamond;
	panose-1:2 2 4 4 3 3 1 1 8 3;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Haettenschweiler;
	panose-1:2 11 7 6 4 9 2 6 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"MS Outlook";
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;
	mso-font-charset:204;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"Wingdings 2";
	panose-1:5 2 1 2 1 5 7 7 7 7;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Wingdings 3";
	panose-1:5 4 1 2 1 8 7 7 7 7;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MT Extra";
	panose-1:5 5 1 2 1 2 5 2 2 2;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Lucida Sans";
	panose-1:2 11 6 2 3 5 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:SAfon;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536902279 -2147483648 8 0 511 0;}
@font-face
	{font-family:"Bitstream Vera Sans";
	panose-1:2 11 6 3 3 8 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-2147483473 268443722 0 0 1 0;}
@font-face
	{font-family:"Bitstream Vera Sans Mono";
	panose-1:2 11 6 9 3 8 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147483473 268443722 0 0 1 0;}
@font-face
	{font-family:"Bitstream Vera Serif";
	panose-1:2 6 6 3 5 6 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-2147483473 268443722 0 0 1 0;}
@font-face
	{font-family:Courant;
	panose-1:2 0 5 9 3 0 0 2 0 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147483609 0 0 0 1 0;}
@font-face
	{font-family:Helonia;
	panose-1:2 0 5 3 4 0 0 2 0 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:-2147483609 0 0 0 1 0;}
@font-face
	{font-family:MaplePi;
	panose-1:2 0 5 0 7 0 0 2 0 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Thames;
	panose-1:2 0 5 3 8 0 0 2 0 3;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:-2147483609 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXOne;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXTwo;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXThree;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXFour;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXFive;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXSix;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXSeven;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXEight;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXNine;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXTen;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXEleven;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXTwelve;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXThirteen;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXFourteen;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXFifteen;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXSixteen;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ESSTIXSeventeen;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:FigurineCrrCB;
	panose-1:2 2 5 9 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:FigurineTmsCB;
	panose-1:2 2 5 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:SymbolPi;
	panose-1:2 0 5 0 7 0 0 2 0 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Albertus Medium";
	panose-1:2 14 6 2 3 3 4 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Albertus Extra Bold";
	panose-1:2 14 8 2 4 3 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"ITC Avant Garde Gothic";
	panose-1:2 11 6 2 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"ITC Avant Garde Gothic Demi";
	panose-1:2 11 8 2 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"ITC Bookman Light";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"ITC Bookman Demi";
	panose-1:2 5 8 4 4 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"CG Omega";
	panose-1:2 11 5 2 5 5 8 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"CG Times";
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"ITC Zapf Chancery";
	panose-1:3 2 7 2 4 4 3 8 8 4;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Clarendon Condensed";
	panose-1:2 4 7 6 4 7 5 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Coronet;
	panose-1:3 3 5 2 4 4 6 7 6 5;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:CourierPS;
	panose-1:2 7 6 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"ITC Zapf Dingbats";
	panose-1:5 2 1 2 1 7 4 2 6 9;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Map Symbol - EnBde";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnBk";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnBn";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnCoy";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnD&C";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnMsc";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnPl";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnRgt";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnSct";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - EnSqd";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Mapsym - G5";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Helvetica Narrow";
	panose-1:2 11 6 6 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Letter Gothic";
	panose-1:2 11 4 9 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Map Symbols - Blank";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - Pl";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbols - Coy";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbols - Bn";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbols - Regt";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbols - Bde";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbols - Div & Corps";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbols - Eqpt";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbols - Bde&Regt";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbols - Misc";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Marigold;
	panose-1:3 2 7 2 4 4 2 2 5 4;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Military;
	panose-1:2 11 6 3 5 3 2 2 2 4;
	mso-font-charset:2;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Mil SymMod 01";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Mil SymMod 02";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Mil Red 01";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Mil Symbols 01";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:fixed;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Mil Symbols 02";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:fixed;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Mil Symbols 03";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:fixed;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Mil Symbols 04";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Mil Symbols 05";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"New Century Schoolbook";
	panose-1:2 4 6 3 5 7 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Antique Olive";
	panose-1:2 11 6 3 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Palatino;
	panose-1:2 4 5 2 5 5 5 3 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:CoronetPS;
	panose-1:3 3 5 2 4 4 6 7 6 5;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Eurostile;
	panose-1:2 11 5 4 2 2 2 5 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Eurostile Bold";
	panose-1:2 11 8 4 2 2 2 5 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:ClarendonPS;
	panose-1:2 4 6 4 4 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Cooper Black";
	panose-1:2 8 9 4 4 3 11 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Goudy;
	panose-1:2 2 5 2 5 3 5 2 3 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Antique Olive Roman";
	panose-1:2 11 6 3 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Antique Olive CompactPS";
	panose-1:2 11 9 4 3 5 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"StempelGaramond Roman";
	panose-1:2 2 5 2 5 3 6 2 2 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Optima;
	panose-1:2 11 5 2 5 5 8 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Goudy ExtraBold";
	panose-1:2 4 7 2 5 3 5 2 3 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:BodoniPS;
	panose-1:2 7 6 3 6 7 6 2 3 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Lubalin Graph";
	panose-1:2 6 5 3 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Albertus MT";
	panose-1:2 14 6 2 3 3 4 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Bodoni Poster";
	panose-1:2 7 10 4 8 9 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Univers 45 Light";
	panose-1:2 11 4 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Univers ExtendedPS";
	panose-1:2 11 6 5 3 5 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Letter GothicPS";
	panose-1:2 11 4 9 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"GillSans Light";
	panose-1:2 11 4 2 2 2 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:GillSans;
	panose-1:2 11 6 2 2 2 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Univers 55";
	panose-1:2 1 6 3 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Univers 57 Condensed";
	panose-1:2 11 6 6 2 2 2 6 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Univers 47 CondensedLight";
	panose-1:2 11 7 6 3 5 3 5 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"GillSans ExtraBold";
	panose-1:2 11 9 2 2 2 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"GillSans Condensed";
	panose-1:2 11 5 6 2 2 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Oxford;
	panose-1:3 8 7 2 3 3 2 2 5 3;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Joanna MT";
	panose-1:2 6 5 2 5 5 5 3 2 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Taffy;
	panose-1:3 5 4 2 3 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Bodoni PosterCompressed";
	panose-1:2 7 6 8 8 9 5 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Eurostile ExtendedTwo";
	panose-1:2 11 5 7 2 2 2 6 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Clarendon Light";
	panose-1:2 4 6 4 4 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Copperplate32bc;
	panose-1:2 14 6 7 2 2 6 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Copperplate33bc;
	panose-1:2 14 9 7 2 2 6 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Mona Lisa Recut";
	panose-1:4 5 5 4 8 6 3 3 5 2;
	mso-font-charset:0;
	mso-generic-font-family:decorative;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Helvetica Condensed";
	panose-1:2 11 6 6 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Albertus MT Lt";
	panose-1:2 14 5 2 3 3 4 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Geneva;
	panose-1:2 11 5 3 3 4 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Apple Chancery";
	panose-1:3 2 7 2 4 5 6 6 5 4;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:Candid;
	panose-1:5 2 1 2 1 6 7 2 7 5;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Chicago;
	panose-1:2 11 8 6 8 6 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Hoefler Text";
	panose-1:2 3 6 2 5 5 6 2 2 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Hoefler Text Black";
	panose-1:2 3 8 2 6 7 6 2 2 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Hoefler Text Ornaments";
	panose-1:5 9 1 2 1 2 7 2 2 2;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Monaco;
	panose-1:2 11 5 9 3 4 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:MarigoldPS;
	panose-1:3 2 7 2 4 4 2 2 5 4;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - Section";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Map Symbol - Squad";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:SymbolPS;
	panose-1:5 5 1 2 1 6 7 2 6 7;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Times;
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Mapsym - Tools";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Univers;
	panose-1:2 11 6 3 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Univers Condensed";
	panose-1:2 11 6 6 2 2 2 6 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 147 0;}
@font-face
	{font-family:"Mapsym - US - Gen";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"DejaVu Sans Condensed";
	panose-1:2 11 6 6 3 8 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-419422465 1375794687 270369 0 447 0;}
@font-face
	{font-family:"DejaVu Serif";
	panose-1:2 6 6 3 5 6 5 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-469761281 1342206459 262176 0 159 0;}
@font-face
	{font-family:"DejaVu Serif Condensed";
	panose-1:2 6 6 6 5 6 5 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-469761281 1342206459 262176 0 159 0;}
@font-face
	{font-family:"DejaVu Sans Mono";
	panose-1:2 11 6 9 3 8 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-436206849 1342208507 32 0 159 0;}
@font-face
	{font-family:"DejaVu Sans";
	panose-1:2 11 6 3 3 8 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-419414273 -771686913 270377 0 -2147483137 0;}
@font-face
	{font-family:"DejaVu Sans Light";
	panose-1:2 11 2 3 3 8 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-536860929 1342177403 32 0 415 0;}
@font-face
	{font-family:OpenSymbol;
	panose-1:5 1 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:-2147483473 268561642 0 0 1 0;}
@font-face
	{font-family:Mathematica1;
	panose-1:5 0 5 2 6 1 0 0 0 1;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica1Mono;
	panose-1:5 6 4 0 3 1 0 0 1 1;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica2;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica2Mono;
	panose-1:5 0 4 0 3 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica3;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica3Mono;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica4;
	panose-1:5 1 4 0 4 1 1 0 1 1;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica4Mono;
	panose-1:5 1 4 0 4 1 1 0 1 1;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica5;
	panose-1:2 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica5Mono;
	panose-1:2 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica6;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica6Mono;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica7;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Mathematica7Mono;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Calibri;
	mso-fareast-font-family:Calibri;
	mso-bidi-font-family:"Times New Roman";}
h1
	{mso-style-link:" Char";
	mso-style-next:Normal;
	margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:18.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	color:#365F91;
	mso-font-kerning:0pt;
	font-weight:bold;}
h2
	{mso-style-link:" Char";
	mso-style-next:Normal;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:13.0pt;
	mso-bidi-font-size:18.0pt;
	font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
h3
	{mso-style-link:" Char";
	mso-style-next:Normal;
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:11.0pt;
	font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	color:#4F81BD;
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Calibri;
	mso-fareast-font-family:Calibri;
	mso-bidi-font-family:"Times New Roman";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Calibri;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Calibri;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{mso-style-link:" Char";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
span.Char
	{mso-style-name:" Char";
	mso-style-link:"Heading 2";
	mso-ansi-font-size:13.0pt;
	mso-bidi-font-size:18.0pt;
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:Cambria;
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;}
span.Char0
	{mso-style-name:" Char";
	mso-style-link:"HTML Preformatted";
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
span.Char1
	{mso-style-name:" Char";
	mso-style-link:"Heading 1";
	mso-ansi-font-size:18.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:Cambria;
	mso-bidi-font-family:"Times New Roman";
	color:#365F91;
	font-weight:bold;}
p.TOCHeading, li.TOCHeading, div.TOCHeading
	{mso-style-name:"TOC Heading";
	mso-style-noshow:yes;
	mso-style-parent:"Heading 1";
	mso-style-next:Normal;
	margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:18.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:#365F91;
	font-weight:bold;}
span.Char2
	{mso-style-name:" Char";
	mso-style-noshow:yes;
	mso-style-link:"Balloon Text";
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;
	font-family:Tahoma;
	mso-ascii-font-family:Tahoma;
	mso-hansi-font-family:Tahoma;
	mso-bidi-font-family:Tahoma;}
span.Char3
	{mso-style-name:" Char";
	mso-style-link:"Heading 3";
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:Cambria;
	mso-bidi-font-family:"Times New Roman";
	color:#4F81BD;
	font-weight:bold;}
ins
	{mso-style-type:export-only;
	text-decoration:none;}
span.msoIns
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:underline;
	text-underline:single;}
span.msoDel
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:line-through;
	color:red;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:346951421;
	mso-list-template-ids:1817316358;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:507520816;
	mso-list-template-ids:675325536;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l2
	{mso-list-id:791094936;
	mso-list-template-ids:-1443050772;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3
	{mso-list-id:1301686324;
	mso-list-template-ids:247780340;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4
	{mso-list-id:1575385753;
	mso-list-template-ids:-501865226;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l5
	{mso-list-id:1613898810;
	mso-list-template-ids:521064246;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
  </style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Calibri;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="4098"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>
<body style="" lang="EN-US" link="blue" vlink="purple">
<div class="Section1">
<p class="TOCHeading">USACO</p>
<p class="MsoToc1" style=""><!--[if supportFields]><span
style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'></span>TOC \o &quot;1-3&quot; \h \z \u <span
style='mso-element:field-separator'></span><![endif]--><span style=""><span class="MsoHyperlink"><span style="">Elite 2008 January
Competition USACO Contest Analysis
and Data</span></span><span style="display: none;"><span style="">.. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248219 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">3<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200310039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">BRONZE PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248220 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">3<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Costume Party [Neal Wu, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248221 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">3<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Election Time [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248222 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">5<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">iCow [Jeffrey Wang, 2008]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248223 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">SILVER PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248224 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">9<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Cow Contest [Neal Wu, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248225 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">9<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Running [Neal Wu, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248226 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">11<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Telephone Lines [Paul Christiano, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248227 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">13<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">GOLD PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248228 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">16<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Haybale Guessing [Brian Dean, 2003]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248229 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">16<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200320039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Artificial Lake [Matt McCutchen, 2006]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248230 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">19<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Cell Phone Network [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248231 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">23<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc1" style=""><span style=""><span class="MsoHyperlink"><span style="">Special 2007 Chinese Competition contest</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248232 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">26<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">GOLD PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248233 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">26<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Summing Sums [Neal Wu, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248234 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">26<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">The Bovine Accordion and Banjo Orchestra [Lei Huang,
2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248235 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">31<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Treasure [Yang Yi, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248236 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">35<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc1" style=""><span style=""><span class="MsoHyperlink"><span style="">Elite 2007 December Competition contest</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248237 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">41<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">BRONZE PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248238 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">41<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Bookshelf [Neal Wu, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248239 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">42<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200330039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Bookshelf 2 [Neal Wu, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248240 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">44<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Card Stacking [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248241 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">46<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">SILVER PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248242 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">49<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Charm Bracelet [Kolstad/Cox, 2006]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248243 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">49<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Building Roads<span style="">
</span>[Richard Ho, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248244 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">53<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Mud Puddles [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248245 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">56<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">GOLD PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248246 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">61<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Sightseeing Cows [Reid Barton, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248247 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">61<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Gourmet Grazers [Alex Schwendner, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248248 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">65<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Best Cow Line, Gold [Christos Tzamos, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248249 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">68<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200340039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc1" style=""><span style=""><span class="MsoHyperlink"><span style="">Elite 2007 November Competition contest</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248250 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">71<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">BRONZE PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248251 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">71<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Exploration [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248252 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">71<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Speed Reading [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248253 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">74<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Avoid The Lakes [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248254 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">76<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">SILVER PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248255 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">78<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Cow Hurdles [Neal Wu, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248256 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">78<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Milking Time [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248257 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">81<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Best Cow Line [Christos Tzamos, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248258 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">84<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc2" style=""><span style=""><span class="MsoHyperlink"><span style="">GOLD PROBLEMS</span></span><span style="display: none;"><span style="">. </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;mso-no-proof:yes'><span style='mso-element:
field-begin'></span> PAGEREF _Toc188248259 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">88<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200350039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Telephone Wire [Jeffrey Wang, 2007]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248260 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">88<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200360030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Cow Relays [Erik Bernhardsson, 2003]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248261 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">90<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200360031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoToc3" style=""><span style=""><span class="MsoHyperlink"><span style="">Sunscreen [Russ Cox, 2001]</span></span><span style="display: none;"><span style=""> </span></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-begin'></span>
PAGEREF _Toc188248262 \h <span style='mso-element:field-separator'></span></span><![endif]--><span style="display: none;">93<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100380038003200340038003200360032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;mso-no-proof:yes'><span style='mso-element:field-end'></span></span><![endif]--></span><span style=""><p></p></span></p>
<p class="MsoNormal"><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><p></p></p>
<b><span style="font-size: 16pt; line-height: 115%; font-family: Calibri;"><br style="page-break-before: always;" clear="all">
</span></b>
<p class="MsoNormal"><b><span style="font-size: 16pt; line-height: 115%;"><p></p></span></b></p>
<h1>
<a name="_Toc188248219">Elite 2008 January Competition USACO
Contest
Analysis and Data</a><p></p>
</h1>
<p class="MsoNormal" style="text-align: justify;"><b><span style='font-size: 16pt; line-height: 115%; font-family: "Courier New";'><p></p></span></b></p>
<h2>
<a name="_Toc188248220">BRONZE PROBLEMS</a><p></p>
</h2>
<pre style="text-align: center;">*****************************************************************************<p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3>
<a name="_Toc188248221">Costume Party [Neal Wu, 2007]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>It's
Halloween! Farmer John is taking the cows to a costume party, but
unfortunately
he only has one costume. The costume fits precisely two cows with a
length of S
(1 &lt;= S &lt;= 1,000,000). FJ has N cows (2 &lt;= N &lt;= 20,000)
conveniently numbered 1...N; cow i has length L<sub>i</sub> (1 &lt;= L<sub>i</sub>
&lt;= 1,000,000). Two cows can fit into the costume if the sum of their
lengths
is no greater than the length of the costume. FJ wants to know how many
pairs
of two distinct cows will fit into the costume.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: Two space-separated integers: N and S<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..N+1: Line i+1 contains a single integer: L<sub>i</sub><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file costume.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4
6<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: A single integer representing the number of pairs of cows FJ<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>can choose. Note that the order of the
two cows does not<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>matter.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file costume.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
four pairs are as follows: cow 1 and cow 3; cow 1 and cow 4; cow 2 and<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>cow
4; and finally cow 3 and cow 4.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>We
first sort the heights, using an efficient sort, which takes O(N log N)
time.
Then, for each height k in the list, we wish to (efficiently) find the
index of
the largest height that, when added to k, produces a sum less than H.
After we
find this index, we can count the number of heights that, when added to
k,
satisfy the given property. The simplest way to find this is with a
binary
search, which is implemented in the solution below:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;algorithm&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fout =
fopen (<span style="color: maroon;">"costume.out"</span>, <span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fin = fopen
(<span style="color: maroon;">"costume.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAXN = 20005;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> N, H,
total;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> height
[MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
finds the
index of the first position whose height is &lt;= value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>inline</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> binsearch (<span style="color: blue;">int</span>
value)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> lo = 0,
hi = N - 1, mid;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (lo
&lt; hi)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>mid = (lo + hi + 1) &gt;&gt; 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (height [mid] &lt;=
value)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lo = mid;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">else<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hi = mid - 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> lo;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> main ()<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;N, &amp;H);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d"</span>,
height + i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sort (height, height + N);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>total = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// query the largest index
satisfying
the conditions<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> ind = binsearch (H -
height [i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// only count if ind &gt; i<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (ind &gt; i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>total +=
ind -
i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">else</span> <span style="color: blue;">break</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
total);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3>
<a name="_Toc188248222">Election Time [Jeffrey Wang, 2007]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
cows are having their first election after overthrowing the tyrannical
Farmer
John, and Bessie is one of N cows (1 &lt;= N &lt;= 50,000) running for
President. Before the election actually happens, however, Bessie wants
to
determine who has the best chance of winning.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
election consists of two rounds. In the first round, the K cows (1
&lt;= K
&lt;= N) cows with the most votes advance to the second round. In the
second
round, the cow with the most votes becomes President.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Given
that cow i expects to get A<sub>i</sub> votes (1 &lt;= A<sub>i</sub>
&lt;=
1,000,000,000) in the first round and B<sub>i</sub> votes (1 &lt;= B<sub>i</sub>
&lt;= 1,000,000,000) in the second round (if he or she makes it),
determine
which cow is expected to win the election. Happily for you, no vote
count
appears twice in the A<sub>i</sub> list; likewise, no vote count
appears twice
in the B<sub>i</sub> list.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: Two space-separated integers: N and K<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..N+1: Line i+1 contains two space-separated integers: A<sub>i </sub>and
B<sub>i</sub><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file elect.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5
3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
10<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>9
2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5
6<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>8
4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>6
5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>There
are 5 cows, 3 of which will advance to the second round. The cows
expect to get
3, 9, 5, 8, and 6 votes, respectively, in the first round and 10, 2, 6,
4, and
5 votes, respectively, in the second.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: The index of the cow that is expected to win the election.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file elect.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Cows
2, 4, and 5 advance to the second round; cow 5 gets 5 votes in the<span style=""> </span>second round, winning the election.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Problem where the
goal is simply to
follow the rules of the task description. This one is slightly complex
owing to
the requirement for a 'sort' routine. C and C++ programmers have easily
used
built-in sort routines (e.g., qsort).<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Furthermore,
the sort routine has to be able to sort one number while carrying two
other
numbers in the exchanges. The program below is a simple demonstration
of how
qsort can be used to perform such operations. Java and Pascal
programmers had
merely to augment their variable-swap routines to swap three variables.
Some
folks wrote two separate but similar sort routines; some used an if
statement
to differentiate variable for testing. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Complete
credit relied on an O(N<sub>log</sub>N) solution; O(N<sup>2</sup>)
sorts were
not fast enough to get full points. <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;stdio.h&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;stdlib.h&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>struct</span><span style='font-size: 10pt; font-family: "Courier New";'> vote_f {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> a;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> b;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> cownum;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>} votes[50000];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>comparea (<span style="color: blue;">struct</span> vote_f *a, <span style="color: blue;">struct</span>
vote_f *b) { <span style="color: blue;">return</span> b-&gt;a -
a-&gt;a; }<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>compareb (<span style="color: blue;">struct</span> vote_f *a, <span style="color: blue;">struct</span>
vote_f *b) { <span style="color: blue;">return</span> b-&gt;b -
a-&gt;b; }<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>main() {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fin<span style="">
</span>= fopen (<span style="color: maroon;">"elect.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fout = fopen (<span style="color: maroon;">"elect.out"</span>,
<span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> n, k,
i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;n, &amp;k);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; n; i++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;votes[i].a, &amp;votes[i].b);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>votes[i].cownum = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>qsort(votes, n, <span style="color: blue;">sizeof</span>
(<span style="color: blue;">struct</span> vote_f), comparea);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>qsort(votes, k, <span style="color: blue;">sizeof</span>
(<span style="color: blue;">struct</span> vote_f), compareb);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
votes[0].cownum+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>exit (0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3>
<a name="_Toc188248223">iCow [Jeffrey Wang, 2008]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Fatigued
by the endless toils of farming, Farmer John has decided to try his
hand in the
MP3 player market with the new iCow. It is an MP3 player that stores N
songs (1
&lt;= N &lt;= 1,000) indexed 1 through N that plays songs in a
"shuffled" order, as determined by Farmer John's own algorithm:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>* Each song i has an initial rating R<sub>i</sub>
(1 &lt;= R<sub>i</sub> &lt;= 10,000).<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>* The next song to be played is always the
one with <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>the highest rating (or, if two or more are
tied, the highest<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>rated song with the lowest index is
chosen).<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>* After being played, a song's rating is set
to zero, and its rating<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>points are distributed evenly among the
other N-1 songs.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>* If the rating points cannot be distributed
evenly (i.e.,<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>they are not divisible by N-1), then the
extra points are<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>parceled out one at a time to the first
songs on the list<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>(i.e., R_1, R_2, etc. -- but not the
played song) until no<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>more extra points remain.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This
process is repeated with the new ratings after the next song is played.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Determine
the first T songs (1 &lt;= T &lt;= 1000) that are played by the iCow.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: Two space-separated integers: N and T<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..N+1: Line i+1 contains a single integer: R<sub>i</sub><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file icow.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>10<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>8<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>11<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
iCow contains 3 songs, with ratings 10, 8, and 11, respectively. You
must
determine the first 4 songs to be played.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 1..T: Line i contains a single integer that is the i-th song <span style=""></span>that
the iCow plays.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file icow.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
ratings before each song played are:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>R_1<span style="">
</span>R_2<span style=""> </span>R_3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>10<span style="">
</span>8<span style=""> </span>11<span style=""> </span>-&gt;
play #3<span style="">
</span>11/2 = 5, leftover = 1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>16<span style="">
</span>13<span style=""> </span>0<span style="">
</span>-&gt; play #1<span style="">
</span>16/2 = 8<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>21<span style=""> </span>8<span style="">
</span>-&gt; play #2<span style="">
</span>21/2 = 10, leftover = 1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>11<span style="">
</span>0<span style=""> </span>18<span style=""> </span>-&gt;
play #3<span style="">
</span>...<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
program is a "pure programming" task. It requires nothing more than
the implementation of a set of rules. The example even showed how one
of the
potentially troublesome rules actually worked. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
program below is commented to show how each step is performed. The only
potentially tricky part is the use of two variables for the
distribution: one
to count how many pieces get distributed and the second to say where
they go.
The second variable is the trick for implementing the "Don't
redistribute
back to the currently playing song" rule. <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;stdio.h&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;stdlib.h&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main() {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span>
bestrate, bestj, i, j, k, n, t, r[1000+1];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span>
evenlydistribute, leftover;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fin<span style="">
</span>= fopen (<span style="color: maroon;">"icow.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fout = fopen (<span style="color: maroon;">"icow.out"</span>,
<span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;n, &amp;t);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; n; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d"</span>,
&amp;r[i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; t; i++) {<span style="">
</span><span style="color: green;">/* play t songs */<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">/* find
highest rated song */<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bestrate = -1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (j
= 0; j &lt; n; j++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(r[j] &gt; bestrate) {<span style=""> </span><span style="color: green;">/* best, lowest index */<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bestj = j;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bestrate = r[j];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
bestj+1);<span style=""> </span><span style="color: green;">/*
play it */<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>evenlydistribute = r[bestj]/(n-1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>leftover = r[bestj] % (n-1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>r[bestj] = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (j
= 0; j &lt; n; j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(j != bestj)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>r[j] += evenlydistribute;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (k
= j = 0; j &lt; leftover; j++, k++)<span style=""> </span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(j == bestj) k++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>r[k]++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<h2 style="text-align: left;" align="left">
<span style="">
</span><span style=""></span><a name="_Toc188248224"><u>SILVER PROBLEMS</u></a><u><p></p></u>
</h2>
<pre style="text-align: justify;">**********************************************************************<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248225">Cow Contest [Neal Wu, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">N (1 &lt;= N &lt;= 100) cows, conveniently numbered 1..N, are participating in a programming contest. As we all know, some cows code better than others. Each cow has a certain constant skill rating that is unique among the competitors.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The contest is conducted in several head-to-head rounds, each between two cows. If cow A has a greater skill level than cow B (1 &lt;= A &lt;= N; 1 &lt;= B &lt;= N; A != B), then cow A will always beat cow B.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John is trying to rank the cows by skill level. Given a list the results of M (1 &lt;= M &lt;= 4,500) two-cow rounds, determine the number of cows whose ranks can be precisely determined from the results. It is guaranteed that the results of the rounds will not be contradictory.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and M<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..M+1: Each line contains two space-separated integers that <span style=""></span><span style=""></span>describe the competitors and results (the first integer, A, is the winner) of a single round of competition: A and B<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file contest.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">5 5<p></p></pre>
<pre style="text-align: justify;">4 3<p></p></pre>
<pre style="text-align: justify;">4 2<p></p></pre>
<pre style="text-align: justify;">3 2<p></p></pre>
<pre style="text-align: justify;">1 2<p></p></pre>
<pre style="text-align: justify;">2 5<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer representing the number of cows whose ranks<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>can be determined<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file contest.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">2<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Cow 2 loses to cows 1, 3, and 4. Thus, cow 2 is no better than any of the cows 1, 3, and 4. Cow 5 loses to cow 2, so cow 2 is better than cow 5.<span style=""> </span>Thus, cow 2 must be fourth, and cow 5 must be fifth. The ranks of the other cows cannot be determined.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>First,
note that the problem can be converted into a graph, with the cows as
the
nodes, and the games as the edges. (In particular, note that the graph
is a
directed acyclic graph, or a DAG.)<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>For
a certain cow X, X's rank can be determined if and only if the
following
property is true: for every other cow Y, either cow X must be better
than cow Y,
or cow Y must be better than cow X.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Thus,
we can find which pairs of vertices in the graph are connected either
by doing
a BFS for O(NM) overall or Floyd-Warshall for O(N<sup>3</sup>) overall.
Then,
for each cow, we check if every other cow is connected to it, and if
so, we
increment our answer by 1.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
following is a sample solution:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fout =
fopen (<span style="color: maroon;">"contest.out"</span>, <span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fin = fopen
(<span style="color: maroon;">"contest.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAXN = 105;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> N, M,
total = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>bool</span><span style='font-size: 10pt; font-family: "Courier New";'> reach
[MAXN][MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main ()<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;N, &amp;M);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
cows are
'connected' to themselves<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>reach [i][i] = <span style="color: blue;">true</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
read input<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> a, b;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; M; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d %d"</span>,
&amp;a, &amp;b);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a--, b--;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>reach [a][b] = <span style="color: blue;">true</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
use
Floyd-Warshall to compute transitive closure<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
k = 0; k &lt; N; k++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (reach [i][k])<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
j = 0; j &lt; N; j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(reach [k][j])<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>reach [i][j] = <span style="color: blue;">true</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">bool</span> good = <span style="color: blue;">true</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// we can find the rank of a cow if
all other cows are connected to it<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
j = 0; j &lt; N; j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (!reach [i][j]
&amp;&amp; !reach [j][i])<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>good = <span style="color: blue;">false</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">break</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (good)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>total++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
total);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248226">Running [Neal Wu, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The cows are trying to become better athletes, so Bessie is running on a track for exactly N (1 &lt;= N &lt;= 10,000) minutes. During each minute, she can choose to either run or rest for the whole minute.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The ultimate distance Bessie runs, though, depends on her 'exhaustion factor', which starts at 0. When she chooses to run in minute i, she will run exactly a distance of D<sub>i</sub> (1 &lt;= D<sub>i</sub> &lt;= 1,000) and her exhaustion factor will increase by 1 -- but must never be allowed to exceed M (1 &lt;= M &lt;= 500).<span style=""> </span>If she chooses to rest, her exhaustion factor will decrease by 1 for each minute she rests. She cannot commence running again until her exhaustion factor reaches 0. At that point, she can choose to run or rest.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">At the end of the N minute workout, Bessie's exaustion factor must be exactly 0, or she will not have enough energy left for the rest of the day.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Find the maximal distance Bessie can run.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and M<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Line i+1 contains the single integer: D<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file cowrun.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">5 2<p></p></pre>
<pre style="text-align: justify;">5<p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;">4<p></p></pre>
<pre style="text-align: justify;">2<p></p></pre>
<pre style="text-align: justify;">10<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer representing the largest distance Bessie can run while satisfying the conditions.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file cowrun.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">9<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie runs during the first minute (distance=5), rests during the second minute, runs for the third (distance=4), and rests for the fourth and fifth. Note that Bessie cannot run on the fifth minute because she would not end with a rest factor of 0.<p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
is a straightforward dynamic programming (DP) problem. To solve the
problem, we
want to find, for each k such that 0 &lt;= k &lt;= N, the maximum
possible
distance Bessie could have run after the first k minutes, if she has a
rest
factor of 0. (For example, if we can obtain a distance of 14 after 5
minutes
with a rest factor of 0, or we can obtain a distance of 15 after 5
minutes with
a rest factor of 0, we would always choose the second over the first.)
Clearly,
the best such value for 0 is 0. Then, for each minute i of the N
minutes, we
can compute all of the next values possible with the following method:<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>-First,
try to not run during the minute, and see if this produces an
improvement.
(Thus, check if the best value for i is better than the one for i + 1.)<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>-Then,
for each number k from 1 to M, let Bessie run for exactly k minutes and
then
rest for k minutes. See if this new value produces a greater value than
the
best value for i + 2k (which is the number of minutes finished after
running
for k minutes and resting for another k minutes).<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Thus,
since we do M updates for each of the N minutes, our total complexity
is O(NM).
The following is a sample solution:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fout =
fopen (<span style="color: maroon;">"cowrun.out"</span>, <span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fin = fopen
(<span style="color: maroon;">"cowrun.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAXN = 10005;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> N, M, dist
[MAXN], best [MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main ()<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;N, &amp;M);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d"</span>,
dist + i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span><span style="color: green;">//
skip the value<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(best [i] &gt; best [i + 1])<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>best [i + 1] = best [i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> sum
= best [i], pos = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
j = 0; j &lt; M &amp;&amp; pos &lt; N; j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// update each value<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sum += dist [i + j];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>pos += 2;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(sum &gt; best [pos])<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>best [pos] = sum;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
best [N]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248227">Telephone Lines [Paul Christiano, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John wants to set up a telephone line at his farm. Unfortunately, the phone company is uncooperative, so he needs to pay for some of the cables required to connect his farm to the phone system.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">There are N (1 &lt;= N &lt;= 1,000) forlorn telephone poles conveniently numbered 1...N that are scattered around Farmer John's property; no cables connect any them.<span style=""> </span>A total of P (1 &lt;= P &lt;= 10,000) pairs of poles can be connected by a cable; the rest are too far apart.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The i<sup>th</sup> cable can connect the two distinct poles A<sub>i</sub> and B<sub>i</sub>, with length L<sub>i</sub> <span style=""></span>(1 &lt;= L_i &lt;= 1,000,000) units if used. The input data set never names any {A<sub>i</sub>,B<sub>i</sub>} pair more than once. Pole 1 is already connected to the phone system, and pole N is at the farm. Poles 1 and N need to be connected by a path of cables; the rest of the poles might be used or might not be used.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">As it turns out, the phone company is willing to provide Farmer John with K (0 &lt;= K &lt; N) lengths of cable for free. Beyond that he will have to pay a price equal to the length of the longest remaining cable he requires (each pair of poles is connected with a separate cable), or 0 if he does not need any additional cables.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Determine the minimum amount that Farmer John must pay.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Three space-separated integers: N, P, and K<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..P+1: Line i+1 contains the three space-separated integers:<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>A<sub>i</sub>, B<sub>i</sub>, and L<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file phoneline.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">5 7 1<p></p></pre>
<pre style="text-align: justify;">1 2 5<p></p></pre>
<pre style="text-align: justify;">3 1 4<p></p></pre>
<pre style="text-align: justify;">2 4 8<p></p></pre>
<pre style="text-align: justify;">3 2 3<p></p></pre>
<pre style="text-align: justify;">5 2 9<p></p></pre>
<pre style="text-align: justify;">3 4 7<p></p></pre>
<pre style="text-align: justify;">4 5 6<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">There are 5 poles. Pole 1 cannot be connected directly to poles 4 or 5. Pole 5 cannot be connected directly to poles 1 or 3. All other pairs can be connected. The phone company will provide one free cable.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer, the minimum amount Farmer John can pay. If it is impossible to connect the farm to the phone company, print -1.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file phoneline.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">If pole 1 is connected to pole 3, pole 3 to pole 2, and pole 2 to pole 5 then Farmer John requires cables of length 4, 3, and 9. The phone company will provide the cable of length 9, so the longest cable needed has length 4.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">We construct the following graph G: each pole is a vertex, and each possible connection between poles is an edge between corresponding vertices with weight equal to the distance between the poles. </pre>
<pre style="text-align: justify;">Now imagine we have a function f(lim) that tells us if there exists a path from vertex 1 to vertex N using no more than K edges whose weights are greater than lim. If we have such a function f, we can perform a binary search for the answer: the smallest lim that works (in other words, the smallest k such that f(k) is true) is the minimum amount Farmer John must pay. </pre>
<pre style="text-align: justify;">So the problem now is implementing function f(lim) efficiently, and to do so, we consider the graph H, which has the same vertices and edges as G but different edge weights. More precisely, an edge between vertices a and b in H has weight 0 if the corresponding edge in G has weight w &lt;= lim, and weight 1 otherwise (if the corresponding edge in G has weight w &gt; lim), so the shortest path between two vertices a and b in H represents the minimum number of edges with weight greater than lim on a path between a and b in G. Thus computing f(lim) is equivalent to checking if the shortest path between 1 and N in H is less than or equal to K, and we can do this in O(E log V) time with Dijkstra's. </pre>
<pre style="text-align: justify;">In the worst case, we will need to evaluate function f O(log V) times (because of the binary search), so the total running time of the entire algorithm is O(E log2 V). (It's actually possible to compute the shortest path between two vertices in a graph where all edges have weight 0 or 1 in linear time, but that's not needed here.) </pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'>&lt;fstream&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'>&lt;vector&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>ifstream fin (<span style="color: maroon;">"phoneline.in"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>ofstream fout (<span style="color: maroon;">"phoneline.out"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAX = 1000 + 5;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>vector &lt;<span style="color: blue;">int</span>&gt; a[MAX], b[MAX];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>e[MAX * 10];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>bool</span><span style='font-size: 10pt; font-family: "Courier New";'> mark[MAX];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dis [MAX], saf[MAX], head, tail;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> n, k, D,
M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> dfs (<span style="color: blue;">int</span> u)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dis[u] = D;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>mark[u] = <span style="color: blue;">true</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>saf[tail++] = u;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; a[u].size (); i++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (!mark[a[u][i]]
&amp;&amp; b[u][i] &lt;= M)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dfs (a[u][i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> Bfs (<span style="color: blue;">int</span> MM)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>M = MM;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset (mark, 0, <span style="color: blue;">sizeof</span>
mark);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>head = tail = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>D = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dfs (n - 1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (head
&lt; tail) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> k =
saf[head++];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; a[k].size (); ++i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(!mark[a[k][i]]) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>D = dis[k] + 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dfs (a[k][i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> bs (<span style="color: blue;">int</span> x, <span style="color: blue;">int</span>
y)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (y == x
+ 1) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fout &lt;&lt; e[y] &lt;&lt; endl;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>exit (0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span><span style="">
</span>mid = (y + x) / 2;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>Bfs (e[mid]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (dis[0]
&lt;= k)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bs (x, mid);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">else<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bs (mid, y);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main () <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> ee;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fin &gt;&gt; n &gt;&gt; ee &gt;&gt; k;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span><span style="">
</span>u, v, w;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; ee; ++i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fin &gt;&gt; u &gt;&gt; v &gt;&gt; w;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>u--;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>v--;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a[u].push_back (v);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>b[u].push_back (w);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a[v].push_back (u);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>b[v].push_back (w);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>e[i + 1] = w;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sort (e, e + 1 + ee);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>Bfs (0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(!mark[0]) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fout &lt;&lt; <span style="color: maroon;">"-1"</span>
&lt;&lt; endl;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>
0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (dis[0]
&lt;= k) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fout &lt;&lt; <span style="color: maroon;">"0"</span>
&lt;&lt; endl;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>
0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bs (0, ee);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h2 style="text-align: left;" align="left"><span style='font-size: 10pt; font-family: "Courier New"; font-weight: normal;'><p></p></span></h2>
<h2 style="text-align: left;" align="left">
<span style="">
</span><a name="_Toc188248228"><span style="">
</span><u>GOLD
PROBLEMS</u></a><u><p></p></u>
</h2>
<pre style="text-align: justify;">*****************************************************************************<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248229">Haybale Guessing [Brian Dean, 2003]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The cows, who always have an inferiority complex about their intelligence, have a new guessing game to sharpen their brains.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">A designated 'Hay Cow' hides behind the barn and creates N (1 &lt;= N &lt;= 1,000,000) uniquely-sized stacks (conveniently numbered 1..N) of hay bales, each with 1..1,000,000,000 bales of hay.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The other cows then ask the Hay Cow a series of Q (1 &lt;= Q &lt;= 25,000) questions about the the stacks, all having the same form:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">What is the smallest number of bales of any stack in the range of stack numbers Q<sub>l</sub>..Q<sub>h</sub> (1 &lt;= Q<sub>l</sub> &lt;= N; Q<sub>l</sub> &lt;= Q<sub>h</sub> &lt;= N)?<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The Hay Cow answers each of these queries with a single integer A whose truthfulness is not guaranteed.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Help the other cows determine if the answers given by the Hay Cow are self-consistent or if certain answers contradict others.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and Q<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..Q+1: Each line contains three space-separated integers that represent a single query and its reply: Q<sub>l</sub>, Q<sub>h</sub>, and A<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file bales.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">20 4<p></p></pre>
<pre style="text-align: justify;">1 10 7<p></p></pre>
<pre style="text-align: justify;">5 19 7<p></p></pre>
<pre style="text-align: justify;">3 12 8<p></p></pre>
<pre style="text-align: justify;">11 15 12<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The minimum number of bales in stacks 1..10 is 7, the minimum number of bales in stacks 5..19 is 7, the minimum number of bales in stacks 3..12 is 8, and the minimum number of bales in stacks 11..15 is 12.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Print the single integer 0 if there are no inconsistencies<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>among the replies (i.e., if there exists a valid realization<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>of the hay stacks that agrees with all Q queries).<span style=""> </span>Otherwise,<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>print the index from 1..Q of the earliest query whose answer<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>is inconsistent with the answers to the queries before it.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file bales.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Query 3 ("3 12 8") is the first that is inconsistent with those before it. From queries 1 and 2 and the fact that all hay stacks have a distinct number of bales, we deduce that one of stacks 5..10 must contain exactly 7 bales.<span style=""> </span>However, this stack contradicts the answer to query 3.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
first (and most crucial) observation to make is that if there exists a
list of
stack sizes that satisfies queries 1...m, then the same set satisfies
queries
1...m-1. So we can perform binary search on the biggest sequence of
queries
that can be satisfied, and reduce the problem to finding whether a set
of
queries is satisfiable. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Then,
given a sequence of query results, we can find out what's the lowest
number of
bales in each stack in O(N+Q<sub>log</sub>Q) time by sweeping through
the
queries and tracking the 'limiting query' using a heap. This can
alternatively
be done using a range tree, although that's a bit slower. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>We
then need to check that minimum values are indeed present in the
ranges. For
all the queries whose answer is x, the value x must be present in their
intersection since x can only appear once total. Then x must appear
once as one
of the 'minimum' values since x is also an upper bound on that region
as well.
So this can be checked in O(N) time using a lookup list as well. Note
that this
condition is sufficient since all the other duplicated values (in the
lower
bound list) can have their values rised to arbitrary values without
causing any
further problems. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Below
is Richard Peng's solution: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;algorithm&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;queue&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;vector&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#define</span><span style='font-size: 10pt; font-family: "Courier New";'> MAXN
1100000<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#define</span><span style='font-size: 10pt; font-family: "Courier New";'> MAXQ 30000<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>struct</span><span style='font-size: 10pt; font-family: "Courier New";'> qtype {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> p1, p2,
res, id;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">bool</span> <span style="color: blue;">operator</span> &lt; (<span style="color: blue;">const</span>
qtype &amp; o)<span style="color: blue;">const</span> { <span style="color: blue;">return</span>
p1 &lt; o.p1; }<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}lis[MAXQ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>pair &lt;<span style="color: blue;">int</span>, <span style="color: blue;">int</span>&gt;
lis1[MAXQ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>last[MAXQ], v[MAXN], left[MAXQ], right[MAXQ],
n, q, needt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>priority_queue
&lt;pair &lt;<span style="color: blue;">int</span>, <span style="color: blue;">int</span>&gt; &gt;lim;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>pair &lt;pair &lt;<span style="color: blue;">int</span>, <span style="color: blue;">int</span>&gt;,
<span style="color: blue;">int</span>&gt; need[MAXQ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> work (<span style="color: blue;">int</span> len) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span><span style="">
</span><span style="">
</span>i, i1, i2;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (len
&gt; q) <span style="color: blue;">return</span> 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span>
(!lim.empty ()) lim.pop ();<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; q; i++) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>left[i] = last[i] = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>right[i] = n;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; q; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (lis[i].id &lt; len) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>left[lis[i].res] &gt;?= lis[i].p1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>right[lis[i].res] &lt;?= lis[i].p2;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>needt = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0; i &lt; q; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (left[i] != 0)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>need[needt].first.first = right[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>need[needt].first.second = left[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>need[needt++].second = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sort (need, need + needt);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 1, i1 = i2 = 0; i
&lt;= n; i++) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (; (i1 &lt; q)
&amp;&amp; (lis[i1].p1 == i); i1++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (lis[i1].id &lt;
len) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lim.push (pair &lt; <span style="color: blue;">int</span>,
<span style="color: blue;">int</span> &gt;(lis[i1].res, lis[i1].p2));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> ((!lim.empty ())
&amp;&amp; (lim.top ().second &lt; i)) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lim.pop ();<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>v[i] = lim.empty () ? 0 : v[i] = lim.top ().first;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>last[v[i]] = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (; (i2 &lt; needt)
&amp;&amp; (need[i2].first.first == i); i2++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (last[need[i2].second]
&lt; need[i2].first.second)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main ()<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span><span style="">
</span>i, j, tot, ans, del;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen (<span style="color: maroon;">"bales.in"</span>,
<span style="color: maroon;">"r"</span>, stdin);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen (<span style="color: maroon;">"bales.out"</span>,
<span style="color: maroon;">"w"</span>, stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf (<span style="color: maroon;">"%d%d"</span>,
&amp;n, &amp;q);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; q; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf (<span style="color: maroon;">"%d%d%d"</span>,
&amp;lis[i].p1, &amp;lis[i].p2, &amp;lis[i].res);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lis[i].id = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lis1[i].first = lis[i].res;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lis1[i].second = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sort (lis1, lis1 + q);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = tot = 0; i &lt; q;
i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tot += ((i == 0) || (lis1[i].first != lis1[i -
1].first));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lis[lis1[i].second].res = tot;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sort (lis, lis + q);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (del =
1 &lt;&lt; 16, ans = 0; del; del /= 2)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (work (ans + del))<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>ans += del;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf (<span style="color: maroon;">"%d\n"</span>,
(ans &lt; q) ? (ans + 1) : 0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<h3><p></p></h3>
<p class="MsoNormal"><p></p></p>
<p class="MsoNormal"><p></p></p>
<p class="MsoNormal"><p></p></p>
<h3>
<a name="_Toc188248230">Artificial Lake [Matt McCutchen, 2006]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The oppressively hot summer days have raised the cows' clamoring to its highest level. Farmer John has finally decided to build an artificial lake. For his engineering studies, he is modeling the lake as a two-dimensional landscape consisting of a contiguous sequence of N soon-to-be-submerged levels (1 &lt;= N &lt;= 100,000) conveniently numbered 1..N from left to right.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Each level i is described by two integers, its width W_i (1 &lt;= W<sub>i</sub> &lt;= 1,000) and height (like a relative elevation) H<sub>i</sub> (1 &lt;= H<sub>i</sub> &lt;= 1,000,000). The heights of FJ's levels are unique. An infinitely tall barrier encloses the lake's model on the left and right. One example lake profile is shown below.<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>*<span style=""> </span>:<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>*<span style=""> </span>:<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span><span style=""></span>*<span style=""> </span>8<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>***<span style=""> </span>*<span style=""> </span>7<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>***<span style=""> </span>*<span style=""> </span>6<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>***<span style=""> </span>*<span style=""> </span>5<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>**********<span style=""> </span>4 &lt;- height<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>**********<span style=""> </span>3<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>***************<span style=""> </span>2<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>***************<span style=""> </span>1<p></p></pre>
<pre style="text-align: justify;">Level<span style=""> </span>|<span style=""> </span>1 |2|<span style=""> </span>3<span style=""> </span>|<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">In FJ's model, he starts filling his lake at sunrise by flowing water into the bottom of the lowest elevation at a rate of 1 square unit of water per minute. The water falls directly downward until it hits something, and then it flows and spreads as room-temperature water always does.<span style=""> </span>As in all good models, assume that falling and flowing happen instantly. Determine the time at which each elevation's becomes submerged by a single unit of water.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>WATER<span style=""> </span>WATER OVERFLOWS<span style=""> </span><p></p></pre>
<pre style="text-align: justify;"><span style=""></span>|<span style=""> </span><span style=""></span>|<span style=""> </span><p></p></pre>
<pre style="text-align: justify;"><span style=""></span>* |<span style=""> </span>*<span style=""> </span>*<span style=""> </span>|<span style=""> </span>*<span style=""> </span>*<span style=""> </span>*<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>* V<span style=""> </span>*<span style=""> </span>*<span style=""> </span>V<span style=""> </span>*<span style=""> </span>*<span style=""> </span>*<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>*<span style=""> </span>*<span style=""> </span>....<span style=""> </span>*<span style=""> </span>*~~~~~~~~~~~~*<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>**<span style=""> </span>*<span style=""> </span>*~~~~** :<span style=""> </span>*<span style=""> </span>*~~~~**~~~~~~*<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>**<span style=""> </span>*<span style=""> </span>*~~~~** :<span style=""> </span>*<span style=""> </span>*~~~~**~~~~~~*<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>**<span style=""> </span>*<span style=""> </span>*~~~~**~~~~~~*<span style=""> </span>*~~~~**~~~~~~*<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*<span style=""> </span>*********<span style=""> </span>*~~~~*********<span style=""> </span>*~~~~*********<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>*~~~~*********<span style=""> </span>*~~~~*********<span style=""> </span>*~~~~*********<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>**************<span style=""> </span>**************<span style=""> </span>**************<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>**************<span style=""> </span>**************<span style=""> </span>**************<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>After 4 mins<span style=""> </span>After 26 mins<span style=""> </span>After 50 mins<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Lvl 1 submerged<span style=""> </span>Lvl 3 submerged<span style=""> </span>Lvl 2 submerged<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Warning: The answer will not always fit in 32 bits.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer: N<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Line i+1 describes level i with two space-separated<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>integers: W<sub>i</sub> and H<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file alake.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;">4 2<p></p></pre>
<pre style="text-align: justify;">2 7<p></p></pre>
<pre style="text-align: justify;">6 4<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Three levels just as in the example above.<span style=""> </span>Water will fill the first level because it is the lowest.</pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 1..N: Line i contains a single integer that is the number of<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>minutes that since sunrise when level #i is covered by water<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>of height 1.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file alake.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4<p></p></pre>
<pre style="text-align: justify;">50<p></p></pre>
<pre style="text-align: justify;">26<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>We try to
solve the problem for each level separately. For each level, the amount
of
water required until it overflows can be broken down into three parts.
WOLOG,
we assume the level is to the left of the level of minimum height. The
three
parts are: <p></p></span></p>
<ul type="disc">
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>To the left of
the level. Water will flow this way unti it encounters the first level
that has a higher height. So, for each level, we need to find the first
level to its left that has a higher height. This can be done using a
stack in O(n) time. <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Between the level
and the lowest level. The water levels forms a series of 'steps', which
can be tracked in a stack if we consider the levels from right to left.
This can also be calculated in O(n) time. <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>To the right of
the lowest level. If we consider the levels one by one leftwards
starting from the one to the left of the lowest level, the water level
at the lowest level can only increase. So it suffices to keep a pointer
to how far to the right gets submerged and increase this counter as we
go. This clearly also runs in O(n) <p></p></span></li>
</ul>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Combining
these three parts, we get an O(n) algorithm. Many of the solutions
submitted by
contestants used much cleverer algorithms that combines these three
steps into
a single one, but most are still based on this 'step' idea. Here is
Neal Wu's
explanation on how he did this problem: <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Add in the
two infinite barriers as 'levels' with infinite height for simplicity.
We will
find the answer for each level in the order they are filled, keeping
track of
the current time when calculating each.<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Note that
after we have filled level L, the water will go in the direction of the
shorter
neighbor level of L. For example, in the following diagram, after level
2 is
filled, the water will flow to the right:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*<span style="">
</span>* 8<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*<span style="">
</span>* 7<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>****<span style="">
</span>* 6<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>****<span style="">
</span>**<span style="">
</span>* 5<span style=""> </span>&lt;-- heights<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>****<span style="">
</span>****<span style="">
</span>* 4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>****<span style="">
</span>******* * 3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>****<span style="">
</span>********* 2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>***************
1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>1<span style=""> </span>2 3 4
5<span style=""> </span>6<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>Levels<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The water
will keep flowing to the right (and thus 'skipping' levels) until an
increase
in height occurs. Thus, in the example above, level 6 will be filled
next after
level 2 is finished.<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Also, note
that at this point both level 2 and level 3 share the same water level.
They
will always remain at the same height since the water fills them
evenly. Thus,
we can 'merge' level 2 into level 3 (the new width of level 3 will be
the sum
of its original width and the width of level 2), and delete level 2.
Note that
to implement this merging efficiently we can use a linked list of
levels (which
enables constant time deletion of a level).<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This gives
us a fairly simple algorithm: find the level which the water currently
fills
(starting with the shortest level), and calculate the time at which it
becomes
submerged (which is equal to the time when the level began to fill up
added to
the width of the level). Next, find how long it takes for the level to
fill up
to the height of the shorter of its two neighbors, and add this to our
current
time. Finally, continue in the direction of the shorter neighbor until
we reach
an increase in level heights. This level is the next level to fill with
water.<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>At first,
it seems this approach is O(N<sup>2</sup>), since we can skip up to
O(N) levels
each time. However, the algorithm is actually linear time because of
the
following fact: after we skip a level, we cannot skip it again. This is
because
after a level is skipped, the water must come back to it from the
opposite
direction, which means it must fill the level. (In the above example,
the water
will skip level 5, fill level 6, and then come back to level 5 and fill
it.)
Therefore each level can be skipped at most once, so the algorithm
takes O(N)
time overall. The following is a sample implementation:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><a name="_Toc188248231"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span></a><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fin = fopen
(<span style="color: maroon;">"alake.in"</span>,
<span style="color: maroon;">"r"</span>);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fout =
fopen (<span style="color: maroon;">"alake.out"</span>,
<span style="color: maroon;">"w"</span>);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAXN = 100005, INF = 1000000000;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
N, width
[MAXN], height [MAXN];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
prev
[MAXN], next [MAXN];<span style=""> </span><span style="color: green;">// simplified linked list<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>long</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">long</span> ans [MAXN], total = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
main () {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d"</span>, &amp;N);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>height [0] = height
[N + 1] = INF;<span style=""> </span><span style="color: green;">// infinite walls<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: green;'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> ind = 1;<span style="">
</span><span style="color: green;">// the current level being filled
with water<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: green;'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 1; i
&lt;= N; i++) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d %d"</span>, width
+ i, height + i);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>prev [i] = i -
1, next [i] = i + 1;<span style=""> </span><span style="color: green;">// initialize<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: green;'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// ind starts as the shortest level<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (height [i] &lt; height
[ind])<span style=""> </span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ind = i;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// continue until the current level
is one of the walls<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (height [ind] &lt; INF)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<span style=""> </span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// calculate our current index<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ans [ind] =
total + width [ind];<span style=""> </span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// delete the current index<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>next [prev
[ind]] = next [ind], prev [next [ind]] = prev [ind];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// take the smaller of the neighbors<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (height [prev [ind]] &lt;
height [next [ind]]) <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<span style=""> </span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// add the time taken to our current
total<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>total += (<span style="color: blue;">long</span> <span style="color: blue;">long</span>) width
[ind] * (height [prev [ind]] - height [ind]);<span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// merge the levels together<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>width
[prev [ind]] += width [ind];<span style=""> </span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ind = prev
[ind];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// find the next index<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (ind &gt; 0 &amp;&amp;
height [prev [ind]] &lt;
height [ind]) <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ind =
prev [ind];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>} <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">else</span> <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<span style=""> </span><span style="color: green;">// do
similarly for
the other neighbor<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>total += (<span style="color: blue;">long</span> <span style="color: blue;">long</span>) width
[ind] * (height [next [ind]] - height [ind]);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>width [next
[ind]] += width [ind];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ind = next
[ind];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (ind &lt;= N &amp;&amp;
height [next [ind]]
&lt; height [ind])<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ind =
next [ind]; <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 1; i
&lt;= N; i++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%lld\n"</span>,
ans [i]);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<h3>
<span style="">Cell Phone Network [Jeffrey Wang,
2007]</span><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John has decided to give each of his cows a cell phone in hopes to encourage their social interaction. This, however, requires him to set up cell phone towers on his N (1 &lt;= N &lt;= 10,000) pastures (conveniently numbered 1..N) so they can all communicate.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Exactly N-1 pairs of pastures are adjacent, and for any two pastures A and B (1 &lt;= A &lt;= N; 1 &lt;= B &lt;= N; A != B) there is a sequence of adjacent pastures such that A is the first pasture in the sequence and B is the last. Farmer John can only place cell phone towers in the pastures, and each tower has enough range to provide service to the pasture it is on and all pastures adjacent to the pasture with the cell tower.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Help him determine the minimum number of towers he must install to provide cell phone service to each pasture.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">PROBLEM NAME: tower<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer: N<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N: Each line specifies a pair of adjacent pastures with two space-separated integers: A and B<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file tower.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">5<p></p></pre>
<pre style="text-align: justify;">1 3<p></p></pre>
<pre style="text-align: justify;">5 2<p></p></pre>
<pre style="text-align: justify;">4 3<p></p></pre>
<pre style="text-align: justify;">3 5<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John has 5 pastures: pastures 1 and 3 are adjacent, as are pastures 5 and 2, pastures 4 and 3, and pastures 3 and 5. Geometrically, the farm looks like this (or some similar configuration)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>4<span style=""> </span>2<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>|<span style=""> </span>|<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>1--3--5<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer indicating the minimum number of towers to<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>install<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file tower.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">2<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
towers can be placed at pastures 2 and 3 or pastures 3 and 5.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This
problem, known as the "minimum dominating set problem" in a tree, has
a nice greedy solution. Note that the graph in the problem is indeed a
tree
because it has V-1 edges. We say a vertex is dominated by a set of
vertices if
it is either in the set or adjacent to a vertex in the set. The
algorithm is as
follows: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>(1)
Keep track of a set of vertices S.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>(2)
Root the tree at an arbitrary node.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>(3)
Visit the vertices of the tree with a postorder traversal.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>(4)
At each vertex, if it is not dominated by S, add it and all of its
neighbors to
S.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>(5)
Once the traversal is done, visit the vertices in S in the reverse
order that
they were added.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>(6)
At each vertex, if S is still a dominating set when the vertex is
removed, then
do so. <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
vertices left in S form a minimum dominating set. For a proof of why
this
works, see http://www.cs.clemson.edu/~bcdean/greedy_tree_dom.swf. <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Note
that the running time of this algorithm is very good, O(N), since each
vertex
is visited once in the postorder traversal and each vertex is added to
S at
most once. Checking whether a vertex can be removed can also be done
efficiently by keeping track of how many vertices in S it is adjacent
to. An
implementation of this algorithm is shown below.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><a name="_Toc188248232"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span></a><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;stdio.h&gt;<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;iostream&gt;<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;vector&gt;<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
N,
c[10100], p[10100];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>vector &lt;vector
&lt;<span style="color: blue;">int</span>&gt;
&gt; E;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>vector &lt;<span style="color: blue;">int</span>&gt; B;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
traverse(<span style="color: blue;">int</span> v)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(<span style="color: blue;">int</span>
i=0;
i&lt;E[v].size(); i++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>(p[v] != E[v][i]) <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>{ <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>p[E[v][i]] = v; <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>traverse(E[v][i]); <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>(c[v] == 0)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>B.push_back(v); <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>c[v]++;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span><span style="color: blue;">for</span>(<span style="color: blue;">int</span> i=0; i&lt;E[v].size(); i++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c[E[v][i]]
+= 2; B.push_back(E[v][i]);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span><span style="color: blue;">for</span>(<span style="color: blue;">int</span>
j=0; j&lt;E[E[v][i]].size(); j++) <p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>c[E[E[v][i]][j]]++;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
main()<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE* in = fopen(<span style="color: maroon;">"tower.in"</span>,
<span style="color: maroon;">"r"</span>);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE* out = fopen(<span style="color: maroon;">"tower.out"</span>,
<span style="color: maroon;">"w"</span>);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf(in, <span style="color: maroon;">"%d"</span>, &amp;N);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>E.resize(N);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(<span style="color: blue;">int</span>
i=0; i&lt;N;
i++) { p[i] = -1; c[i] = 0; }<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> u, v;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(<span style="color: blue;">int</span>
i=0;
i&lt;N-1; i++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf(in, <span style="color: maroon;">"%d %d"</span>, &amp;u,
&amp;v);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>E[u-1].push_back(v-1);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>E[v-1].push_back(u-1);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>traverse(0);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> numRemove = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(<span style="color: blue;">int</span>
i=B.size()-1;
i&gt;=0; i--)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">bool</span> canRemove = (c[B[i]] &gt;
1);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(<span style="color: blue;">int</span>
j=0;
j&lt;E[B[i]].size(); j++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>canRemove =
canRemove &amp;&amp; (c[E[B[i]][j]] &gt; 1);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>(canRemove)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c[B[i]]--;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(<span style="color: blue;">int</span>
j=0;
j&lt;E[B[i]].size(); j++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c[E[B[i]][j]]--;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>numRemove +=
canRemove;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf(out, <span style="color: maroon;">"%d\n"</span>,
B.size()-numRemove);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<h1>
<span style="">Special 2007 Chinese Competition
contest</span><p></p>
</h1>
<p class="MsoNormal" style="text-align: justify;"><b><span style='font-size: 16pt; line-height: 115%; font-family: "Courier New";'><p></p></span></b></p>
<h2 style="margin-left: 144pt; text-align: left; text-indent: 36pt;" align="left">
<a name="_Toc188248233"><u>GOLD PROBLEMS</u></a><u><p></p></u>
</h2>
<pre style="text-align: justify;">*****************************************************************************<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248234">Summing Sums [Neal Wu, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The N (1 &lt;= N &lt;= 50,000) cows, conveniently numbered 1..N, are trying to learn some encryption algorithms. After studying a few examples, they have decided to make one of their own! However, they are not very experienced at this, so their algorithm is very simple:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Each cow i is given a starting number C<sub>i</sub> (0 &lt;= C<sub>i</sub> &lt; 90,000,000), and then all the cows perform the following process in parallel:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>* First, each cow finds the sum of the numbers of the other N-1<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>cows.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>* After all cows are finished, each cow replaces her number<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>with the sum she computed. To avoid very large numbers, the<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>cows will keep track of their numbers modulo 98,765,431.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">They told Canmuu the moose about it in November; he was quite impressed.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Then one foggy Christmas Eve, Canmuu came to say: "Your algorithm is too easy to break! You should repeat it T (1 &lt;= T &lt;= 1,414,213,562) times instead."<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Obviously, the cows were very frustrated with having to perform so many repetitions of the same boring algorithm, so after many hours of arguing, Canmuu and the cows reached a compromise: You are to calculate the numbers after the encryption is performed!<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">*Some extra feedback will be provided for the first 10 submissions to this problem.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and T<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Line i+1 contains a single integer: C<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file sumsums.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3 4<p></p></pre>
<pre style="text-align: justify;">1<p></p></pre>
<pre style="text-align: justify;">0<p></p></pre>
<pre style="text-align: justify;">4<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Three cows, with starting numbers 1, 0, and 4; four repetitions of the encryption algorithm.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 1..N: Line i contains a single integer representing the number of cow i (modulo 98,765,431) at the end of the encryption.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file sumsums.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">26<p></p></pre>
<pre style="text-align: justify;">25<p></p></pre>
<pre style="text-align: justify;">29<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The following is a table of the cows' numbers for each turn:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Cows' numbers<p></p></pre>
<pre style="text-align: justify;">Turn<span style=""> </span>Cow1<span style=""> </span>Cow2<span style=""> </span>Cow3<p></p></pre>
<pre style="text-align: justify;"> 0<span style=""> </span>1<span style=""> </span>0<span style=""> </span>4<p></p></pre>
<pre style="text-align: justify;"> 1<span style=""> </span>4<span style=""> </span>5<span style=""> </span>1<p></p></pre>
<pre style="text-align: justify;"> 2<span style=""> </span>6<span style=""> </span>5<span style=""> </span>9<p></p></pre>
<pre style="text-align: justify;"> 3<span style=""> </span>14<span style=""> </span>15<span style=""> </span>11<p></p></pre>
<pre style="text-align: justify;"> 4<span style=""> </span>26<span style=""> </span>25<span style=""> </span>29<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Let
S be the sum of all the numbers at the beginning. We can construct a
table of
the value of each cow's numbers after each turn:<p></p></span></p>
<pre style="text-align: justify;">Turn<span style=""> </span>Cow i's number<span style=""> </span>Sum of all cows' numbers<p></p></pre>
<pre style="text-align: justify;">0<span style=""> </span>C<sub>i</sub><span style=""> </span><span style=""></span>S<p></p></pre>
<pre style="text-align: justify;">1<span style=""> </span>S - C<sub>i</sub><span style=""> </span><span style=""></span>(n - 1) * S<p></p></pre>
<pre style="text-align: justify;">2<span style=""> </span>(n - 2) * S + C<sub>i</sub><span style=""> </span><span style=""></span>(n - 1)<sup>2</sup> * S<p></p></pre>
<pre style="text-align: justify;">3<span style=""> </span>(n<sup>2</sup> - 3n + 3) * S + C<sub>i</sub><span style=""> </span><span style=""></span>(n - 1)<sup>3</sup> * S<p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>In
particular, note that the coefficient of S in cow i's number on the
t-th turn
is (n - 1)<sup>t - 1</sup> - (n - 1)<sup>t - 2</sup> + (n - 1)<sup>t - 3</sup>
- ...  (n - 1)<sup>1</sup> </span><span style='font-size: 10pt; font-family: "Cambria Math";'></span><span style='font-size: 10pt; font-family: "Courier New";'> (n - 1)<sup>0</sup>,
and
the coefficient of C<sub>i</sub> is (-1)<sup>t</sup>. (Both of these
statements
can be proven by induction.)<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Now,
all we need to do to solve the problem is evaluate this sum (modulo
98,765,431). However, the sum can have 1 billion terms, so we need to
find an
efficient way of doing this. Two possible methods, that can both be
implemented
in O(log t), are described below:<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
first is to evaluate the sum somewhat directly. Note that (n - 1)<sup>t
- 1</sup>
- (n - 1)<sup>t - 2</sup> + (n - 1)<sup>t - 3</sup> - (n - 1)<sup>t - 4</sup>
+
...  (n - 1)<sup>1</sup> </span><span style='font-size: 10pt; font-family: "Cambria Math";'></span><span style='font-size: 10pt; font-family: "Courier New";'> (n - 1)<sup>0</sup>
= (n -
2) * (n - 1)<sup>t - 2</sup> + (n - 2) * (n - 1)<sup>t - 4</sup> + ...,
with
two possible endings for the sum depending on whether t is even or odd.
We can
compute the value of the sum for values of t that are powers of two,
and then
combine these values to find our actual sum.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
second method is to find the sum using matrix powering. We note that on
each
turn, the coefficient of S in each cow's number is multiplied by (n -
1), and
then 1 is either added to the coefficient or subtracted from it,
depending on
whether t is even or odd. In order to simulate this using matrix
powering, we
would like to create a 2-element vector V and a 2 x 2 matrix M such
that V [0]
is the coefficient of S, and V [1] is either 1 or -1. Multiplying V by
the
matrix M once should simulate one turn. In particular, we want to
multiply V
[0] by n - 1, and then add V [1] to it, and we want to 'flip' V [1]
between 1
and -1 each time. Thus, M should be the following matrix:<p></p></span></p>
<pre style="text-align: justify;">| n - 1<span style=""> </span>0 |<p></p></pre>
<pre style="text-align: justify;">|<span style=""> </span>|<p></p></pre>
<pre style="text-align: justify;">|<span style=""> </span>1<span style=""> </span>-1 |<p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>When
V is multiplied by M, V [0] becomes (n - 1) * V [0] + 1 * V [1], and V
[1]
becomes 0 * v [0] + (-1) * V [1], which was exactly what we wanted.
Thus,
multiplying V by M a total of t times will suffice, but instead we can
use
efficient O(log t) matrix powering to do this.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Two
solutions are presented corresponding to the two methods given above.
The
following is a power of two summation solution from Neal Wu:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fin = fopen
(<span style="color: maroon;">"sumsums.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fout =
fopen (<span style="color: maroon;">"sumsums.out"</span>, <span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAXN = 50005, MAXL = 35;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MOD = 98765431;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> N, T, nums
[MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>long</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">long</span> power [MAXL], ssum [MAXL];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
computes A^(B
- 1) - A^(B - 2) + ... +/- A -/+ 1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
by computing
(A - 1) * A^(B - 2) + ...<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
takes O(log
B) time<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>long</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">long</span> calc (<span style="color: blue;">int</span>
A, <span style="color: blue;">int</span> B)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>power [0] = A % MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ssum [0] = (A - 1) % MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
power [i] =
A^(2^i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
ssum [i] =
the sum of the first 2^i terms of the second sum above<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i + 1 &lt; MAXL; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>power [i + 1] = (power [i] * power [i]) % MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ssum [i + 1] = (ssum [i] * power [i + 1] + ssum [i]) % MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">bool</span> odd =
(B &amp; 1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>B &gt;&gt;= 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">long</span> <span style="color: blue;">long</span> p = 1, total = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; (1 &lt;&lt; i) &lt;= B; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (B &amp; (1 &lt;&lt; i))<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
combine the
sums for each power of two in the binary representation of B<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>total = (total + ssum
[i] * p) % MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>p = (p * power [i +
1]) % MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>//
do a special
case for odd B<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (odd)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>total = (total * A + 1) % MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>
total;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>Void
</span><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>main ()<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;N, &amp;T);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">long</span> <span style="color: blue;">long</span> sum = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d"</span>,
nums + i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sum += nums [i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sum %= MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> add =
(sum * calc (N - 1, T)) % MOD;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
(add + (T &amp; 1 ? -nums [i] : nums [i]) + MOD) % MOD);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The following is
a matrix
multiplication solution from Richard Peng:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstring&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#define</span><span style='font-size: 10pt; font-family: "Courier New";'> MAXN<span style=""> </span>50000<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#define</span><span style='font-size: 10pt; font-family: "Courier New";'> M<span style="">
</span>98765431<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'>
res[2],v[2][2],tem[2][2],t,t1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'>
lis[MAXN],dif[MAXN],n;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>long</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">long</span> tot;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> mul(<span style="color: blue;">int</span> a[2][2],<span style="color: blue;">int</span>
b[2][2]){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> i,j,k;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(i=0;i&lt;2;i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(j=0;j&lt;2;j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(tem[i][j]=0,k=0;k&lt;2;k++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tem[i][j]=(tem[i][j]+(<span style="color: blue;">long</span> <span style="color: blue;">long</span>)a[i][k]*b[k][j])%M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main(){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>freopen(<span style="color: maroon;">"sumsums.in"</span>,<span style="color: maroon;">"r"</span>,stdin);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>freopen(<span style="color: maroon;">"sumsums.out"</span>,<span style="color: maroon;">"w"</span>,stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf(<span style="color: maroon;">"%d%d"</span>,&amp;n,&amp;t);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(i=tot=0,0;i&lt;n;i++){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf(<span style="color: maroon;">"%d"</span>,&amp;lis[i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dif[i]=lis[i]-lis[0];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tot+=dif[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(v,0,<span style="color: blue;">sizeof</span>(v));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(res,0,<span style="color: blue;">sizeof</span>(res));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>res[0]=lis[0]%M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>res[1]=tot%M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>v[0][0]=(n-1)%M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>v[0][1]=1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>v[1][1]=-1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(t1=t;t1;t1/=2){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>(t1%2){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>res[0]=((<span style="color: blue;">long</span> <span style="color: blue;">long</span>)res[0]*v[0][0]+(<span style="color: blue;">long</span>
<span style="color: blue;">long</span>)res[1]*v[0][1])%M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>res[1]=((<span style="color: blue;">long</span> <span style="color: blue;">long</span>)res[1]*v[1][1])%M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>mul(v,v);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memcpy(v,tem,<span style="color: blue;">sizeof</span>(v));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(i=0;i&lt;n;i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf(<span style="color: maroon;">"%d\n"</span>,((res[0]+((t%2==0)?(dif[i]):(-dif[i])))%M+M)%M);}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248235">The Bovine Accordion and Banjo Orchestra
[Lei
Huang, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The 2*N (3 &lt;= N &lt;= 1,000) cows have assembled the Bovine Accordion and Banjo Orchestra!<span style=""> </span>They possess various levels of skill on their respective instruments: accordionist i has an associated talent level A<sub>i</sub> (0 &lt;= A<sub>i</sub> &lt;= 1,000); banjoist j has an associated talent level B<sub>j</sub>(0 &lt;= B<sub>j</sub> &lt;= 1,000).<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The combined `awesomeness' of a pairing between cows with talents A<sub>i</sub> and B<sub>j</sub> is directly proportional to the talents of each cow in the pair so a concert with those two cows will earn FJ precisely A<sub>i</sub> * B<sub>j</sub> dollars in "charitable donations".<span style=""> </span>FJ wishes to maximize the sum of all revenue obtained by his cows by pairing them up in the most profitable way.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Unfortunately, FJ's accordionists are a bit stuck up and stubborn. If accordionist i is paired with banjoist j, then accordionists i+1..N refuse to be paired with banjoists 1..j-1. This creates restrictions on which pairs FJ can form. FJ thus realizes that in order to maximize his profits, he may have to leave some cows unpaired.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">To make matters worse, when one or more of the musicians is skipped, they will be greatly upset at their wasted talent and will engage in massive binge drinking to wash away their sorrows.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">After all pairings are made, a list is constructed of the groups of each of the consecutive skipped musicians (of either instrument). Every group of one or more consecutive skipped cows will gather together to consume kegs of ice cold orange soda in an amount proportional to the square of the sum of their wasted talent.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Specifically, FJ has calculated that if the x-th to y-th accordionists are skipped, they will consume precisely (A<sub>x</sub> + A<sub>x+1</sub> + A<sub>x+2</sub> + ... + A<sub>y</sub>)<sup>2</sup> dollars worth of orange soda in the process of drinking themselves into oblivion. An identical relationship holds for the banjoists. FJ realizes that he'll end up getting stuck with the bill for his cows' drinking, and thus takes this into account when choosing which pairings to make.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Find the maximum amount of total profit that FJ can earn after the contributions are collected and the orange soda is paid for.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Memory Limit: 64MB<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer: N<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Line i+1 contains the single integer: A<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines N+2..2*N+1: Line i+N+1 contains the single integer: B<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file baabo.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;">1<p></p></pre>
<pre style="text-align: justify;">1<p></p></pre>
<pre style="text-align: justify;">5<p></p></pre>
<pre style="text-align: justify;">5<p></p></pre>
<pre style="text-align: justify;">1<p></p></pre>
<pre style="text-align: justify;">1<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">There are 6 cows: 3 accordionists and 3 banjoists. The accordionists have<p></p></pre>
<pre style="text-align: justify;">talent levels (1, 1, 5), and the banjoists have talent levels (5, 1, 1).<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer that represents the maximum amount of cash that FJ can earn.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file baabo.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">17<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">FJ pairs accordionist 3 with banjoist 1 to get earn A_3 * B_1 = 5 * 5 = 25 in profit.<span style=""> </span>He loses a total of (1 + 1)^2 + (1 + 1)^2 = 8 dollars due to the cost of soda for his remaining cows. Thus his final (net) profit is 25<p></p></pre>
<pre style="text-align: justify;">- 8 = 17.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Since
the pairings cannot intersect, this problem can be solved using DP with
the
state being the last 'pair' of accordionist and banjoist (denoted A and
B from
here on). This gives O(N<sup>2</sup>) states and O(N<sup>2</sup>) state
transitions for each state as there are O(N<sup>2</sup>) possible
previous
pairs, the state transition function is:<p></p></span></p>
<pre style="text-align: justify;">Best(i,j)=max{i1&lt;i,j1&lt;j|Best(i1,j1)-SQR(sum(A_i1...A_(i-1)))-SQR(sum(B_j1...B_(j-1)))}+A_i*B_j<p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>where
SQR is the square of a number.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
gives an O(N<sup>4</sup>) solution, which we try to optimize all the
way down
to O(N<sup>2</sup>). The first observation we make is we cannot skip
cows in
both A and B when we go from the current pair to the previous one. This
because
pairing any two from those skipped ones will increase the total profit.
So this
gives an O(n^3) solution, sufficient to get 60% of the points.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Now
we try to get down to O(N<sup>2</sup>) by optimizing the state
transition using
convexity. We first consider the case where no cows in A are skipped,
or when
i1=i-1. So we need to find:<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>max{j1&lt;j|Best(i-1,j)-SQR(sum(B_j1...B_(j-1))}+A_i*B_j<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>If
we let SB denote the partial sum of the B array, then our transition
formula
becomes:<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>max{j1&lt;j|Best(i-1,j)-SQR(SB_(j-1)-SB(j1-1))}+A_i*B_j
=max{j1&lt;j|Best(i-1,j)-SQR(SB_(j1-1))+2*SB_(j1-1)*SB_(j-1)}+A_i*B_j+SQR(SB_(j-1))<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>We
can ignore the last two terms since they're constant depending only on
i and j.
If we look at the first term, we're looking for the max of a linear
combination
of two values depending on j1 where the ratio is dependent on j.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Geometrically,
this is equivalent to taking the y-intercept of a line with a given
slope
within a set of points. With some proof, it can be shown that only
points on
the convex hull matters. So we can insert values of
(2*SB_j,Best(i-1,j)-SQR(SB_(j-1)))) into the convex hull (note SB_j is
always
increasing, so we can do this using a stack). And when we query, we can
show
the point where this value is minimized/maximized is always monotone in
respect
to x. This gives an algorithm that does this in O(1) amortized cost.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
case where nothing in B is skipped can be dealt with similarly. The
only catch
is that should we process the states in incremental i and then
incremental j,
we'll need to keep track of N+1 convex hulls, one for the previous
'row' and
one for each of the columns.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
gives the desired O(N<sup>2</sup>) algorithm. <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstring&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#define</span><span style='font-size: 10pt; font-family: "Courier New";'> MAXN 1200<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> n;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>double</span><span style='font-size: 10pt; font-family: "Courier New";'>
a[MAXN],b[MAXN],bes[MAXN][MAXN],ans;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>double</span><span style='font-size: 10pt; font-family: "Courier New";'>
s1[MAXN],s2[MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>double</span><span style='font-size: 10pt; font-family: "Courier New";'> sqr(<span style="color: blue;">double</span> x){<span style="color: blue;">return</span>
x*x;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>double</span><span style='font-size: 10pt; font-family: "Courier New";'>
hull[MAXN][MAXN][2];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'>
hullt[MAXN],p[MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'>
initialize(<span style="color: blue;">int</span> id){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hullt[id]=p[id]=0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>double</span><span style='font-size: 10pt; font-family: "Courier New";'> crossp(<span style="color: blue;">double</span> a[2],<span style="color: blue;">double</span>
b[2],<span style="color: blue;">double</span> c[2]){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>
(b[0]-a[0])*(c[1]-a[1])-(c[0]-a[0])*(b[1]-a[1]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> hulladd(<span style="color: blue;">int</span> id,<span style="color: blue;">double</span>
x,<span style="color: blue;">double</span> y){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">double</span> point[2];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>point[0]=x;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>point[1]=y;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>((hullt[id]&gt;0)&amp;&amp;(x==hull[id][hullt[id]-1][0])){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>(y&gt;hull[id][hullt[id]-1][1])
hullt[id]--;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">else</span> <span style="color: blue;">return</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span>((hullt[id]&gt;1)&amp;&amp;(crossp(point,hull[id][hullt[id]-1],hull[id][hullt[id]-2])&lt;=0))<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hullt[id]--;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hull[id][hullt[id]][0]=x;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hull[id][hullt[id]][1]=y;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>p[id]&lt;?=hullt[id];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hullt[id]++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>double</span><span style='font-size: 10pt; font-family: "Courier New";'> query(<span style="color: blue;">int</span> id,<span style="color: blue;">double</span>
a){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">double</span> tem,tem1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tem=hull[id][p[id]][0]*a+hull[id][p[id]][1];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span>((p[id]+1&lt;hullt[id])&amp;&amp;((tem1=(hull[id][p[id]+1][0]*a+hull[id][p[id]+1][1]))&gt;tem)){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tem=tem1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>p[id]++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> tem;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main()<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> i,j,i1,j1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen(<span style="color: maroon;">"mkpairs.in"</span>,<span style="color: maroon;">"r"</span>,stdin);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen(<span style="color: maroon;">"mkpairs.out"</span>,<span style="color: maroon;">"w"</span>,stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf(<span style="color: maroon;">"%d"</span>,&amp;n);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(i=0;i&lt;n;i++)<span style=""> </span>scanf(<span style="color: maroon;">"%lf"</span>,&amp;a[i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(s1[0]=a[0],i=1;i&lt;n;i++)
s1[i]=s1[i-1]+a[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(i=0;i&lt;n;i++)<span style=""> </span>scanf(<span style="color: maroon;">"%lf"</span>,&amp;b[i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(s2[0]=b[0],i=1;i&lt;n;i++)
s2[i]=s2[i-1]+b[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(bes,0,<span style="color: blue;">sizeof</span>(bes));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(i=1;i&lt;n;i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>initialize(i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(ans=i=0;i&lt;n;i++){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>initialize(0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(j=0;j&lt;n;j++){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bes[i][j]=-((i==0)?0:sqr(s1[i-1]))-((j==0)?0:sqr(s2[j-1]));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>(i&gt;0){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>(j&gt;0){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bes[i][j]&gt;?=query(0,2*s2[j-1])-sqr(s2[j-1]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bes[i][j]&gt;?=query(j,2*s1[i-1])-sqr(s1[i-1]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hulladd(0,s2[j],bes[i-1][j]-sqr(s2[j]));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bes[i][j]+=a[i]*b[j];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ans&gt;?=bes[i][j]-sqr(s1[n-1]-s1[i])-sqr(s2[n-1]-s2[j]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span>(j=0;j+1&lt;n;j++){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hulladd(j+1,s1[i],bes[i][j]-sqr(s1[i]));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf(<span style="color: maroon;">"%0.0lf\n"</span>,ans);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248236">Treasure [Yang Yi, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Canmuu and his friends have recently acquired a large cache of plutonium and have agreed to bury their newfound treasure at some road intersection deep in the Canadian wilderness. Any sort of treasure burial calls for a treasure map so they've decided to create one of their own.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The road network consists of N (4 &lt;= N &lt;= 100,000) intersections (conveniently numbered 1..N) with N roads connecting them. As busy intersections confuse everybody, every intersection has at least one road that leads to it, and no intersection has more than four roads connected to it. Excellent maintenance has ensured that a moose can always run either way between any pair of intersections. Furthermore, Canmuu has decided the plutonium should not be buried at any of the 4-way intersections since busy traffic decreases the secrecy of the buried treasure.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The treasure map will contain all the roads and all the intersections. But, to conceal the treasure's location, only one road intersection on the treasure map is to be labeled: the intersection at which the treasure is buried (which has a big red 'X', of course).<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Ever the alert moose, Canmuu drew some trial maps to see what they would look like depending on where the treasure was buried. Canmuu noticed that the moose might draw similar maps even if they bury their treasure in two different locations. Their curiosity piqued, the herd began trying to figure out how many distinct maps they could end up making.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Maps are indistinct if it is possible to assign a mapping such that:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>* the X-labeled intersections on both maps correspond,<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>* a correspondence can be created for the other intersections,<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>such that<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>* when the well-chosen intersection correspondence is determined,<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>the roads that connect the intersections also correspond.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">By way of example, consider the maps below where N = 4; the treasure might be buried at any of four intersections:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>+<span style=""> </span>+<span style=""> </span>X<span style=""> </span>+<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>/|<span style=""> </span>/|<span style=""> </span>/|<span style=""> </span>/|<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>X---+ |<span style=""> </span>+---X |<span style=""> </span>+---+ |<span style=""> </span>+---+ |<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>\|<span style=""> </span>\|<span style=""> </span>\|<span style=""> </span>\|<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>+<span style=""> </span>+<span style=""> </span>+<span style=""> </span>X<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The final two maps, however, are not distinct since one can create a correspondence for the vertices (consider the map upside down) and then the roads correspond exactly. Thus, only three maps are distinct.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">How many distinct maps are possible for a given set of roads?<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">TIME LIMIT: 1 second; might be increased for big test cases<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">MEMORY LIMIT: 64MB<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">*Some extra feedback will be provided for the first 10 submissions to this problem.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">PROBLEM NAME: treasure<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer: N<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N + 1: Two space-separated integers: A and B (1 &lt;= A &lt;= N;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>1 &lt;= B &lt;= N), indicating that there is a road connecting<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>intersections A and B<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file treasure.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4<p></p></pre>
<pre style="text-align: justify;">1 2<p></p></pre>
<pre style="text-align: justify;">2 3<p></p></pre>
<pre style="text-align: justify;">3 1<p></p></pre>
<pre style="text-align: justify;">1 4<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Here is a drawing of the roads and the intersections.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>4---1---2<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>\ /<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>3<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer that is the number of distinct treasure<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>maps<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file treasure.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The treasure can be buried at any intersection. However, burying it at intersections 2 and 3 yields maps that are identical to each other. So the total number of distinct treasure maps is 3.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>To
tackle this problem most effectively, we first establish that the road
network
described in the problem is a cycle with trees 'coming off' it. So we
can root
all the trees by the vertex they have on the cycle and denote nodes by
'parent'
and children'. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>We
essentially want to assign an 'id' to the graph surrounding each of the
vertices, which is a collection of several subtrees (its children) and
a graph
that contains the cycle. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>There
are two ways of doing this, either by computing hash values for each
subgraph
or by computing 'ids' as we proceed and only hash cyclic shifts of the
cycle.
The first method is faster in practice and just accurate, but the
second is
slightly easier to code due to usage of C++ STL. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Since
a tree is a collection of its subtrees, we can assign 'id's to all the
subtrees
rooted at each vertex by proceeding at the outermost layer and proceed
inwards.
<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Then
we have to distinguish between all the cyclic shifts (with reflections)
of the
cycles (which is how we could 'orient' the cycle with respect to the
tree the
treasure is buried in). This can be accomplished by the standard
Rabin-Karp
string hash, done once clockwise and once counter clockwise. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Then
for each distinct tree, we can just count the trees that have distinct
ids by
going down recursively, and when we're at a node, only count its
children that
have distinct ids (so if two of its children have the same subtree,
only count
one of them). This is correct since the 'root' is now a special node
(an
orientation of the cycle). <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
runs in O(N) time if hashing is used and O(NlogN) if set/map is used.
The test
data were generated as follows: <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
1: Sample. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
2: 3 chains with different lengths. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
3: random tree with edge <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
4: random tree with edge <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
5: 10 trees with AAABBCCCBB pattern, N = 53, the trees are specially
designed
that they cover almost every simple cases. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
6: 50 same trees. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
7: 20 trees each with 20 nodes. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
8: random tree with edge <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
9: Twin fibonacci trees. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
10: A sequence repeated 7 times. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
11: A cycle connected with a chain. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
12: Repeated ABCACBA pattern. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
13: Repeated AB pattern, changed one B into a special big tree. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
14: A sequence repeated 6 times with reflection. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Case
15: random tree with edge<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><a name="_Toc188248237"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span></a><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;stdio.h&gt;<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;string.h&gt;<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#define</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
maxn 100000<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#define</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
maxh 200003<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#define</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
maxH 1000000003LL<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
ind[maxn],
next[maxn * 2], to[maxn * 2], p;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> n;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
used[maxn];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> f;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
stack[maxn], sp;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
hash[maxh], hashans[maxh], hp;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
hashlib[maxh][3];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>long</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">long</span> h1[maxn], h2[maxn];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>long</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">long</span> hash2[maxh];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
addhash (<span style="color: blue;">int</span> *data) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">long</span> <span style="color: blue;">long</span> c = 123456;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i
&lt; 3; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c = c * 47 ^
data[i];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c = c * 47 % maxh;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (hash[c] != -1
&amp;&amp; (hashlib[c][0] !=
data[0] || hashlib[c][1] !=<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>data[1] ||
hashlib[c][2] != data[2])) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c ++;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (c == maxh)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (hash[c] == -1) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hashlib[c][0] =
data[0];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hashlib[c][1] =
data[1];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hashlib[c][2] =
data[2];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>hash[c] = hp
++;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> hash[c];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
add2 (<span style="color: blue;">long</span> <span style="color: blue;">long</span>
x, <span style="color: blue;">int</span> i) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">long</span> <span style="color: blue;">long</span> c = x %
maxh;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c = c * 47 % maxh;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (hash2[c] != -1
&amp;&amp; hash2[c] != x) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c ++;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (c == maxh)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span><span style="color: blue;">if</span>
(hash2[c]
== -1) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hash2[c] = x;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hash[c] = i;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> -1;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">else<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> hash[c];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
test (<span style="color: blue;">int</span> a, <span style="color: blue;">int</span> b) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i
&lt; sp; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (stack[i + a &gt;= sp? i +
a - sp: i + a] !=
stack[i + b &gt;= sp? i<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>+ b -<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>sp: i + b])<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> 1;<span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
dfs2 (<span style="color: blue;">int</span> x, <span style="color: blue;">int</span> dad) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> lib[3], lp = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = ind[x];
i != -1; i = next[i])<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (to[i] != dad &amp;&amp;
!used[to[i]])<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lib[lp ++]
= dfs2(to[i], x);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (dad == -1)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lib[lp ++] =
maxh - 2;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (lp &lt; 3)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lib[lp ++] =
maxh - 1;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i
&lt; 3; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
j = 0; j
&lt; 2; j ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (lib[j] &gt; lib[j + 1])<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lib[j]
^= lib[j + 1] ^= lib[j] ^= lib[j + 1];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>lp = addhash(lib);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> ans = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i
&lt; 3; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (lib[i] != maxh - 1
&amp;&amp; lib[i] != maxh - 2
&amp;&amp; (i == 0<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>|| lib[i] !=<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>lib[i-1]))<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ans +=
hashans[lib[i]];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (lib[2] == maxh - 1)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>ans ++;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hashans[lp] = ans;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span> lp;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
dfs (<span style="color: blue;">int</span> x, <span style="color: blue;">int</span> dad) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (f)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (used[x] != 0xFEFEFEFE) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>f = 1;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sp = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dad = to[dad];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>stack[sp ++] =
dad;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">while</span> (dad != x) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span>dad
= used[dad];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>stack[sp
++] = dad;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>used[x] = dad ==
-1? -1 : to[dad];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = ind[x];
i != -1; i = next[i])<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (i != dad)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dfs(to[i],
i^1);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span></span><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>
main () {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""></span><span style="color: blue;">int</span>
i, a, b,
c;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen(<span style="color: maroon;">"cowmstr.in"</span>, <span style="color: maroon;">"r"</span>,
stdin);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen(<span style="color: maroon;">"cowmstr.out"</span>, <span style="color: maroon;">"w"</span>,
stdout);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf(<span style="color: maroon;">"%d"</span>,&amp;n);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>p = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(ind, -1, <span style="color: blue;">sizeof</span>(ind));<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0; i &lt; n; i ++) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf(<span style="color: maroon;">"%d%d"</span>,&amp;a,&amp;b);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a --;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>b --;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>next[p] =
ind[a];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>to[p] = b;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ind[a] = p ++;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>next[p] =
ind[b];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>to[p] = a;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ind[b] = p ++;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(used, -2, <span style="color: blue;">sizeof</span>(used));<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>f = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sp = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dfs(0, -1);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(used, 0, <span style="color: blue;">sizeof</span>(used));<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0; i &lt; sp; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>used[stack[i]]
= 1;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>/*<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: green;'><span style=""> </span>for (i
= 0; i &lt; sp; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: green;'><span style="">
</span>printf("%d\n",stack[i]);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: green;'><span style="">
</span>fflush(stdout);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New"; color: green;'>*/<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(hash, -1, <span style="color: blue;">sizeof</span>(hash));<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>hp = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0; i &lt; sp; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>stack[i] =
dfs2(stack[i], -1);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">long</span> <span style="color: blue;">long</span> big = 1;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>h1[0] = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = sp - 1; i &gt;= 0; i
--) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>h1[0] = (h1[0]
* 147804523 + stack[i]) % maxH;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>big = big *
147804523 % maxH;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = sp - 1; i &gt; 0; i
--)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>h1[i] = (h1[(i
+ 1) % sp] * 147804523 % maxH + stack[i] + maxH - big *<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>stack[i] % maxH)
% maxH;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>h2[0] = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 1; i &lt; sp; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>h2[0] = (h2[0]
* 147804523 + stack[i]) % maxH;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>h2[0] = (h2[0] *
147804523 + stack[0]) % maxH;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 1; i &lt; sp; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>h2[i] = (h2[i -
1] * 147804523 % maxH + stack[i] + maxH - big *<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'>stack[i] % maxH)
% maxH;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(hash2, -1, <span style="color: blue;">sizeof</span>(hash2));<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a = -1;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0; a == -1 &amp;&amp;
i &lt; sp; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> ((b = add2(h1[i], i)) != -1)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (test(b, i))<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a = i -
b;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (a == -1)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a = sp;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>b = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0; i &lt; sp; i ++) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (h1[i] == h2[i]) {<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>b |= 1;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c = i;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (h1[i] == h2[(i + 1) % sp]
&amp;&amp; !(b&amp;1))
{<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>b |= 2;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>c = (i + 1)
% sp;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (b &amp; 1)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a = a / 2 + 1;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">else<p></p></span></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (b &amp; 2)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>a = a / 2;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> ans = 0;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0; i &lt; a; i ++)<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ans +=
hashans[stack[(i + c) % sp]];<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf(<span style="color: maroon;">"%d\n"</span>, ans);<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style=""><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></span></p>
<h1>
<span style="">Elite 2007 December Competition
contest</span><p></p>
</h1>
<h2 style="text-align: left;" align="left"><p></p></h2>
<h2 style="margin-left: 108pt; text-align: left; text-indent: 36pt;" align="left">
<a name="_Toc188248238"><span style="">
</span>BRONZE
PROBLEMS</a><p></p>
</h2>
<pre style="text-align: justify;">*****************************************************************************<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248239">Bookshelf [Neal Wu, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John recently bought a bookshelf for cow library, but the shelf is getting filled up quite quickly, and now the only available space is at the top.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Each of the N cows (1 &lt;= N &lt;= 20,000) has some height of H<sub>i</sub> (1 &lt;= H<sub>i</sub> &lt;= 10,000) and a total height summed across all N cows of S. The bookshelf has a height of B (1 &lt;= B &lt;= S &lt; 2,000,000,007).<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">To reach the top of the bookshelf taller than the tallest cow, one or more of the cows can stand on top of each other in a stack, so that their total height is the sum of each of their individual heights. This total height must be no less than the height of the bookshelf. Since more cows than necessary in the stack can be dangerous, your job is to find the set of cows that produces a stack of the smallest number of cows possible such that the stack can reach the bookshelf.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and B<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Line i+1 contains a single integer: H<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file shelf.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">6 40<p></p></pre>
<pre style="text-align: justify;">6<p></p></pre>
<pre style="text-align: justify;">18<p></p></pre>
<pre style="text-align: justify;">11<p></p></pre>
<pre style="text-align: justify;">13<p></p></pre>
<pre style="text-align: justify;">19<p></p></pre>
<pre style="text-align: justify;">11<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Six cows; bookshelf height 40. Cow heights fall in the range 6..19.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer representing the size of the smallest set of cows that can reach the bookshelf.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file shelf.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">One way to reach 40 with 3 cows is 18+11+13; many others exist<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Note
that if it is possible to reach the bookshelf with a certain set of C
cows,
then it must be possible with the C tallest cows. Thus, in order to
determine
if it is possible to reach the bookshelf with C cows, we must check
only the C
tallest cows. So we can loop over each C in increasing order, and find
the
first C that satisfies the conditions.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>To
do this, we must sort the numbers in non-increasing order beforehand in
O(N log
N) time, which can be done by either coding the sort yourself (using an
efficient sort such as quicksort or mergesort) or by using the provided
libraries. Afterward, loop over all k from 1 to N, until we find the
first k
that produces a large enough sum. We must be careful to accumulate the
sum with
our loop efficiently to avoid having an O(N<sup>2</sup>) runtime.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>With
a properly-coded solution, the overall runtime will be O(N<sub>log</sub>N),
as
the majority of the runtime comes from the initial sort. The following
is a
sample solution:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;algorithm&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fout =
fopen (<span style="color: maroon;">"shelf.out"</span>, <span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fin = fopen
(<span style="color: maroon;">"shelf.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAXN = 20005;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> N, B;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> heights
[MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> solve () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> sum =
0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sum += heights [i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (sum
&gt;= B)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>
i + 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>
-1;<span style=""> </span><span style="color: green;">//
should
not happen<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;N, &amp;B);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d"</span>,
heights + i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sort (heights, heights + N);<span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>reverse (heights, heights + N);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
solve ());<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248240">Bookshelf 2 [Neal Wu, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John recently bought another bookshelf for the cow library, but the shelf is getting filled up quite quickly, and now the only available space is at the top.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">FJ has N cows (1 &lt;= N &lt;= 20) each with some height of H<sub>i</sub> (1 &lt;= H<sub>i</sub> &lt;= 1,000,000 - these are very tall cows). The bookshelf has a height of B (1 &lt;= B &lt;= S, where S is the sum of the heights of all cows).<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">To reach the top of the bookshelf, one or more of the cows can stand on top of each other in a stack, so that their total height is the sum of each of their individual heights. This total height must be no less than the height of the bookshelf in order for the cows to reach the top.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Since a taller stack of cows than necessary can be dangerous, your job is to find the set of cows that produces a stack of the smallest height possible such that the stack can reach the bookshelf. Your program should print the minimal 'excess' height between the optimal stack of cows and the bookshelf.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and B<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Line i+1 contains a single integer: H<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file shelf2.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">5 16<p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;">1<p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;">5<p></p></pre>
<pre style="text-align: justify;">6<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer representing the (non-negative) difference between the total height of the optimal set of cows and the<span style=""> </span>height of the shelf.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file shelf2.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">1<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Here we use cows 1, 3, 4, and 5, for a total height of 3 + 3 + 5 + 6 = 17. It is not possible to obtain a total height of 16, so the answer is 1.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>To solve
this problem, we simply need to look at the sums of all 2<sup>N</sup>
subsets
of the numbers. (This is possible since N &lt;= 20, and so there are at
most around
one million such subsets.) There are several methods of doing this, but
two
fairly simple methods are the following:<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The first
method is to iterate over all binary numbers from 0 to 2<sup>N</sup> -
1,
inclusive. In each binary number, we can imagine it as having exactly N
bits
(similar to base 10 'digits'). A '1' in bit number i means that we
should use
cow i, while a '0' means that we should not. Thus, each binary number
from 0 to
2<sup>N</sup> - 1 represents a subset of the N cows, and in fact they
represent
every subset. This approach gives us a runtime of O(N 2<sup>N</sup>).<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The second
method is to use recursion to generate every sum. For each cow, we have
two
possibilities: we either use the cow or we don't. This gives us a
fairly simple
solution that is O(2<sup>N</sup>) with a medium overhead of function
calls.<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Both the
bitmask and the recursive solutions are presented:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fout =
fopen (<span style="color: maroon;">"shelf2.out"</span>, <span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fin = fopen
(<span style="color: maroon;">"shelf2.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> INF = 1000000000;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAXN = 25;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> N, B;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> heights
[MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> sum, best
= INF;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;N, &amp;B);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d"</span>,
heights + i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// iterate over
every bitmask<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
mask = 0; mask &lt; (1 &lt;&lt; N); mask++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sum = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// calculate
the sum of the subset<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(mask &amp; (1 &lt;&lt; i))<span style="">
</span><span style="color: green;">// is bit number i set?<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>sum += heights [i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (sum
&gt;= B &amp;&amp; sum &lt; best)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>best = sum;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
best - B);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;cstdio&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>using</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">namespace</span> std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fout =
fopen (<span style="color: maroon;">"shelf2.out"</span>, <span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FILE *fin = fopen
(<span style="color: maroon;">"shelf2.in"</span>, <span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> INF = 1000000000;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>const</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: blue;">int</span> MAXN = 25;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> N, B;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> heights
[MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> best =
INF;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> solve (<span style="color: blue;">int</span> num, <span style="color: blue;">int</span>
sum) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// update our
best value<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (sum
&gt;= B &amp;&amp; sum &lt; best)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>best = sum;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// either we are
finished or our current sum is worse than the best so far<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span> (num ==
N || sum &gt;= best)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">return</span>;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">// two options -
use the next number or not<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>solve (num + 1, sum + heights [num]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>solve (num + 1, sum);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>void</span><span style='font-size: 10pt; font-family: "Courier New";'> main () <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d"</span>, &amp;N, &amp;B);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (<span style="color: blue;">int</span>
i = 0; i &lt; N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d"</span>,
heights + i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>solve (0, 0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
best - B);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248241">Card Stacking [Jeffrey Wang, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie is playing a card game with her N-1 (2 &lt;= N &lt;= 100) cow friends using a deck with K (N &lt;= K &lt;= 100,000; K is a multiple of N) cards.<span style=""> </span>The deck contains M = K/N "good" cards and K-M "bad" cards. Bessie is the dealer and, naturally, wants to deal herself all of the "good" cards. She loves winning.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Her friends suspect that she will cheat, though, so they devise a dealing system in an attempt to prevent Bessie from cheating. They tell her to deal as follows:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>1. Start by dealing the card on the top of the deck to the cow<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>to her right<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>2. Every time she deals a card, she must place the next P (1 &lt;=<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>P &lt;= 10) cards on the bottom of the deck; and<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>3. Continue dealing in this manner to each player sequentially<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>in a counterclockwise manner<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie, desperate to win, asks you to help her figure out where she should put the "good" cards so that she gets all of them. Notationally, the top card is card #1, next card is #2, and so on.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">PROBLEM NAME: cheat<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Three space-separated integers: N, K, and P<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file cheat.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3 9 2<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie is playing cards with two cow friends and a deck of 9 cards. She must place two cards on the bottom of the deck each time she deals one.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 1..M: Positions from top in ascending order in which Bessie<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>should place "good" cards, such that when dealt, Bessie will<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>obtain all good cards.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file cheat.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3<p></p></pre>
<pre style="text-align: justify;">7<p></p></pre>
<pre style="text-align: justify;">8<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie should put the "good" cards in positions 3, 7, and 8. The cards will be dealt as follows; the card numbers are "position in original deck":<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Card Deck<span style=""> </span>P1 <span style=""></span>P2<span style=""> </span>Bessie<p></p></pre>
<pre style="text-align: justify;"> Initial configuration<span style=""> </span>1 2 3 4 5 6 7 8 9<span style=""> </span>- - -<span style=""> </span>- - -<span style=""> </span>- - -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [1] to Player 1<span style=""> </span>2 3 4 5 6 7 8 9<span style=""> </span>1 - -<span style=""> </span>- - -<span style=""> </span>- - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>3 4 5 6 7 8 9 2<span style=""> </span>1 - -<span style=""> </span>- - -<span style=""> </span>- - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#2 of 2)<span style=""> </span>4 5 6 7 8 9 2 3<span style=""> </span>1 - -<span style=""> </span>- - -<span style=""> </span>- - -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [4] to Player 2<span style=""> </span>5 6 7 8 9 2 3<span style=""> </span>1 - -<span style=""> </span>4 - -<span style=""> </span>- - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>6 7 8 9 2 3 5<span style=""> </span>1 - -<span style=""> </span>4 - -<span style=""> </span>- - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#2 of 2)<span style=""> </span>7 8 9 2 3 5 6<span style=""> </span><span style=""></span>1 - -<span style=""> </span>4 - -<span style=""> </span>- - -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [7] to Bessie<span style=""> </span>8 9 2 3 5 6<span style=""> </span>1 - -<span style=""> </span>4 - -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>9 2 3 5 6 8<span style=""> </span>1 - -<span style=""> </span>4 - -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#2 of 2)<span style=""> </span>2 3 5 6 8 9<span style=""> </span>1 - -<span style=""> </span>4 - -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [2] to Player 1<span style=""> </span>3 5 6 8 9<span style=""> </span>1 2 -<span style=""> </span>4 - -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>5 6 8 9 3<span style=""> </span>1 2 -<span style=""> </span>4 - -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#2 of 2)<span style=""> </span>6 8 9 3 5<span style=""> </span>1 2 -<span style=""> </span>4 - -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [6] to Player 2<span style=""> </span>8 9 3 5<span style=""> </span><span style=""></span>1 2 -<span style=""> </span>4 6 -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>9 3 5 8<span style=""> </span>1 2 -<span style=""> </span>4 6 -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#2 of 2)<span style=""> </span>3 5 8 9<span style=""> </span>1 2 -<span style=""> </span>4 6 -<span style=""> </span>7 - -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [3] to Bessie<span style=""> </span>5 8 9<span style=""> </span>1 2 -<span style=""> </span>4 6 -<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>8 9 5<span style=""> </span>1 2 -<span style=""> </span>4 6 -<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#2 of 2)<span style=""> </span>9 5 8<span style=""> </span>1 2 -<span style=""> </span>4 6 -<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [9] to Player 1<span style=""> </span>5 8<span style=""> </span>1 2 9<span style=""> </span>4 6 -<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>8 5<span style=""> </span><span style=""></span>1 2 9<span style=""> </span>4 6 -<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#2 of 2)<span style=""> </span>5 8<span style=""> </span>1 2 9<span style=""> </span>4 6 -<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [5] to Player 2<span style=""> </span>8<span style=""> </span>1 2 9<span style=""> </span>4 6 5<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>8<span style=""> </span>1 2 9<span style=""> </span>4 6 5<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Top card to bottom (#1 of 2)<span style=""> </span>8<span style=""> </span>1 2 9<span style=""> </span>4 6 5<span style=""> </span>7 3 -<p></p></pre>
<pre style="text-align: justify;"> Deal top card [8] to Bessie<span style=""> </span>-<span style=""> </span>1 2 9<span style=""> </span>4 6 5<span style=""> </span>7 3 8<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie will end up with the "good cards" that have been placed in<p></p></pre>
<pre style="text-align: justify;">positions 3, 7, and 8 in the original deck.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This
problem is one of data structure manipulation. The explicit example in
the
directions shows everything one needs to solve the task: <p></p></span></p>
<ul type="disc">
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Read the
parameters <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Set up a 'dummy'
deck so you can see where the cards end up <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Deal out the
cards according to the procedure (making special note when Betsy's
cards go by) <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Sort Betsy's
positions <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Output Betsy's
positions <p></p></span></li>
</ul>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
simplest brute force approach is simple until it comes time to "put the
top card on the bottom". One can implement this in a few ways: <p></p></span></p>
<ul type="disc">
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>save the top
card, move all the cards 'up' one slot in an array, set the bottom card
to the saved top card <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>a linked list:
remove the head element and place it on the end <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>an oversized
array that is large enough to accommodate a large number of
cards-moved-to-bottom; keep an index of the 'decktop' and 'deckbottom'.
Moving a card to the bottom just increments decktop and deckbottom
while copying the first card to the bottom. <p></p></span></li>
</ul>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>My solution
(below) uses the third
method since it's pretty darn simple to implement: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>#include</span><span style='font-size: 10pt; font-family: "Courier New";'> <span style="color: maroon;">&lt;stdio.h&gt;<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: maroon;'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New"; color: blue;'>int</span><span style='font-size: 10pt; font-family: "Courier New";'> cmp (<span style="color: blue;">int</span> *a, <span style="color: blue;">int</span>
*b) { <span style="color: blue;">return</span> *a - *b; }<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>main () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fin = fopen (<span style="color: maroon;">"cheat.in"</span>,
<span style="color: maroon;">"r"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fout = fopen (<span style="color: maroon;">"cheat.out"</span>,
<span style="color: maroon;">"w"</span>);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> n, k,
p, i, j;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span>
deck[100000 * 11], decktop, deckbottom, betsy[100000], nbetsy;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">int</span> player;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, <span style="color: maroon;">"%d
%d %d"</span>, &amp;n, &amp;k, &amp;p);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; k; i++) deck[i] = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>player = decktop = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>deckbottom = k-1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; k; i++) {<span style="">
</span><span style="color: green;">/* k cards to be dealt */<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: green;">/*printf
("deal %d to player %d\n", deck[decktop]+1, player);*/<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">if</span>
(player == n-1) betsy[nbetsy++] = deck[decktop]+1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>player = (player + 1) % n;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>decktop++;<span style="">
</span><span style="color: green;">/* that
card is gone */<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (j
= 0; j &lt; p; j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>deck[++deckbottom] = deck[decktop++];<span style="">
</span><span style="color: green;">/* card to bottom
*/<p></p></span></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>qsort(betsy, k/n, <span style="color: blue;">sizeof</span>
(<span style="color: blue;">int</span>), cmp);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="color: blue;">for</span> (i = 0;
i &lt; k/n; i++) fprintf (fout, <span style="color: maroon;">"%d\n"</span>,
betsy[i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>exit (0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<h2 style="margin-left: 108pt; text-align: left; text-indent: 36pt;" align="left">
<span style=""> </span><span style=""></span><a name="_Toc188248242">SILVER
PROBLEMS</a><p></p>
</h2>
<pre style="text-align: justify;">*****************************************************************************<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248243">Charm Bracelet [Kolstad/Cox, 2006]</a><p></p>
</h3>
<h3><span style='font-family: "Courier New";'><p></p></span></h3>
<pre style="text-align: justify;">Bessie has gone to the mall's jewelry store and spies a charm bracelet. Of course, she'd like to fill it with the best charms possible from the N (1 &lt;= N &lt;= 3,402) available charms. Each charm i in the supplied list has a weight W<sub>i</sub> (1 &lt;= W<sub>i</sub> &lt;= 400), a 'desirability' factor D<sub>i</sub> (1 &lt;= D<sub>i</sub> &lt;= 100), and can be used at most once.<span style=""> </span>Bessie can only support a charm bracelet whose weight is no more than M (1 &lt;= M &lt;= 12,880).<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Given that weight limit as a constraint and a list of the charms with their weights and desirability rating, deduce the maximum possible sum of ratings.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and M<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2...N+1: Line i+1 describes charm i with two space-separated integers: W<sub>i</sub> and D<sub>i</sub><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file charm.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4 6<p></p></pre>
<pre style="text-align: justify;">1 4<p></p></pre>
<pre style="text-align: justify;">2 6<p></p></pre>
<pre style="text-align: justify;">3 12<p></p></pre>
<pre style="text-align: justify;">2 7<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Four potential charms; maximum weight 6<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer that is the greatest sum of charm <span style=""></span>desirabilities that can be achieved given the weight constraints<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file charm.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">23<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Without the second possible charm, the 4+12+7=23 is the highest value for weight 1+2+3 &lt;= 6<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This is
one of the classic "knapsack" problems: 'Items' with a 'value' and
'size' can be stuffed an integer number of times into a container of
some
limited size with the goal of maximizing the value of the items
inserted. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
classic solution pivots on a list of the best possible value that can
be
obtained for the set of items so far seen. The array's subscript is
'size';
it's value is "the best value that can be obtained for the items so far
processed. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Initially,
of course, the array's values are all zero. Adding the first element is
easy:
bestvalue[itemweight] = itemvalue. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Subsequent
items are processed one-by-one as follows. The item's weight and value
are
(experimentally) added to each of the *existing* weight/value pairs in
the
bestvalue array (including the 0/0 element). If the new weight/value
pair is
better, it replaces the old weight value. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>By way of
example, consider the four items from the problem description: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>1
4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
6<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
12<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
7<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The maximum
allowed weight is 6, so
6+1 elements are needed in the 'bestvalue' array: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>0<span style=""> </span>0<span style="">
</span>0<span style="">
</span>0<span style=""> </span>0<span style="">
</span>0<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The first element
(weight 1, value
4) is easy to insert: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>0<span style="">
</span>0<span style="">
</span>0<span style=""> </span>0<span style="">
</span>0<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The second
element (weight 2, value
6) requires two additions. For purposes of explanation, we will first
add it to
the 0/0 element: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>*6*<span style=""> </span>0<span style="">
</span>0<span style=""> </span>0<span style="">
</span>0<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>and then to the
weight=1 element,
which currently has value 4: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6 *10*<span style="">
</span>0<span style="">
</span>0<span style=""> </span>0<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><b><span style='font-size: 10pt; font-family: "Courier New";'>Important
point:</span></b><span style='font-size: 10pt; font-family: "Courier New";'>It is now clear
that we can run into
trouble if, for instance, our weight was 1. In that case, we'd be
modifying
sequential elements -- elements whose new value should be based on the
original
'best' matrix value and not the newly increased values. Thus, <b>we
must either
make a new (properly copied) best matrix so modifications are made
properly OR
we must modify the 'best' matrix from the larger elements to smaller</b>
<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The third
element (weight 3, value 12) requires <b>four</b> additions (to
weights 0, 1,
2, and 3). We will start at weight 3 and proceed 'backwards': <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-----------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>10<span style="">
</span>0<span style=""> </span>0 *22*<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-----------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>10<span style=""> </span>0
*12* 22<span style=""> </span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-----------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>10
*16* 12<span style="">
</span>22<span style=""> </span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>In the final
case, we will <b>overwrite</b>
a now inferior 'best value' element: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-----------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6 *12* 16<span style="">
</span>12<span style="">
</span>22<span style=""> </span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The fourth
and final element (weight 2, value 7) will require potential
augmentation of
all 7 of the best values since all slots are now occupied. Working
backwards: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>12<span style="">
</span>16<span style=""> </span>12<span style=""> </span>22<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>No modifications
since the aggregate
weight is too large. Likewise: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>12<span style="">
</span>16<span style=""> </span>12<span style=""> </span>22<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Regular
calculations and potential
modifications then commence. The 6th item is overwritten since 16+7
&gt; 22
(and so on): <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>12<span style="">
</span>16<span style=""> </span>12 *23*<span style=""> </span>&lt;--
best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>12<span style=""> </span>16
*19* 23<span style=""> </span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>For weight 2 + 2,
the new value
6+7=13 is less than the current best value of 16, so no modification
occurs: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>12<span style="">
</span>16<span style=""> </span>19<span style=""> </span>23<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Likewise for
weight 1 + 2 no
modificastion occurs since 4+7=11 &lt; 12: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>6<span style=""> </span>12<span style="">
</span>16<span style=""> </span>19<span style=""> </span>23<span style="">
</span>&lt;-- best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The final weight
0+2 has a new best
value: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>V-------V<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>4<span style=""> </span>*7* 12<span style=""> </span>16<span style="">
</span>19<span style=""> </span>23<span style=""> </span>&lt;--
best value<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0<span style="">
</span>1<span style=""> </span>2<span style="">
</span>3<span style="">
</span>4<span style=""> </span>5<span style="">
</span>6<span style="">
</span>&lt;-- for this weight (subscript)<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Having now
processed all the input, the 'best value' array is complete. In this
case
element bestvalue[6]=23 is the largest of all the values. One can well
imagine
this would not be the case if, e.g., an item with weight 5 and value
1,000
existed. That might make the largest value appear in some slot other
than the
final one (i.e., if the other weights were all &gt; 1). Thus we scan
the best
value array to find the largest element, which is the highest possible
value
that can be created within the size/weight constraints. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>I coded
this task using two arrays and inefficient copy operators: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;stdio.h&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#define
MAX 12880<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
best[MAX+1], newbest[MAX+1], nb;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>main
() {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fin = fopen ("charm.in",
"r");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fout = fopen ("charm.out",
"w");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int n, m, w, d, i, j, biggest;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, "%d %d", &amp;n,
&amp;m);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bzero (best, (m+1)*sizeof(int));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bzero (newbest, (m+1)*sizeof(int));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; n; i++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, "%d %d", &amp;w,
&amp;d);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (j = 0; j &lt;= m; j++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>if (j != 0 &amp;&amp; best[j] == 0 || j+w &gt; m) continue;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>nb = best[j] + d;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>if (nb &gt; newbest[j+w]) newbest[j+w] = nb;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>bcopy (newbest, best,
(m+1)*sizeof(int));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>/*for (j = 0; j &lt;= m; j++)
printf("%2d ", best[j]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>printf (" -- %d %d\n", w, d);<span style="">
</span>/* debug */<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>biggest = best[0];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (j = 1; j &lt;= m; j++) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (best[j] &gt; biggest) biggest =
best[j];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, "%d\n", biggest);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>exit (0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Richard Peng, who
has coded tasks
like this many times, has evolved a more sophisticated solution that
requires
but one array (processed in reverse order) and uses the cool '&gt;?='
operator
for replacing 'improved' elements. Note that his loops are generally
'correct
by construction' -- no need to check for out-of-bounds indices since
the loops
are properly constrained. Of course his solution is also just about as
fast as
we know how to solve a task like this: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;cstdio&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;cstring&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
bes[12880], n, m, a, b, i, j;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
main () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen ("charm.in",
"r", stdin);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen ("charm.out",
"w", stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf ("%d%d", &amp;n, &amp;m);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset (bes, 0, sizeof (bes));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i=0; i&lt;n; i++){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf ("%d%d", &amp;a,
&amp;b);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (j=m; j&gt;=a; j--)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>bes[j]&gt;?=bes[j-a]+b;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf ("%d\n", bes[m]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248244">Building Roads [Richard Ho, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John had just acquired several new farms! He wants to connect the farms with roads so that he can travel from any farm to any other farm via a sequence of roads; roads already connect some of the farms.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Each of the N (1 &lt;= N &lt;= 1,000) farms (conveniently numbered 1...N) is represented by a position (X_i, Y_i) on the plane (0 &lt;= X_i &lt;= 1,000,000; 0 &lt;= Y_i &lt;= 1,000,000).<span style=""> </span>Given the preexisting M roads (1 &lt;= M &lt;= 1,000) as pairs of connected farms, help Farmer John determine the smallest length of additional roads he must build to connect all his farms.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and M<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Two space-separated integers: X_i and Y_i<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines N+2..N+M+2: Two space-separated integers: i and j, indicating <span style=""></span>that there is already a road connecting the farm i and farm j.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file roads.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4 1<p></p></pre>
<pre style="text-align: justify;">1 1<p></p></pre>
<pre style="text-align: justify;">3 1<p></p></pre>
<pre style="text-align: justify;">2 3<p></p></pre>
<pre style="text-align: justify;">4 3<p></p></pre>
<pre style="text-align: justify;">1 4<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Four farms at locations (1,1), (3,1), (2,3), and (4,3). Farms 1 and 4 are connected by a road.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Smallest length of additional roads required to connect all <span style=""></span>farms, printed without rounding to two decimal places. Be sure to calculate distances as 64-bit floating point numbers. <p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file roads.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4.00<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Connect farms 1 and 2 with a road that is 2.00 units long, then connect farms 3 and 4 with a road that is 2.00 units long. This is the best we can do, and gives us a total of 4.00 unit lengths.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>We note
that since all edges have non-negative weights, there will not be a
cycle in
the final version of the graph. Thus, this problem is equivalent to
finding the
minimum spanning tree in a graph where the edge weights are the
Euclidean
distances (with the exception of a few whose distances are set to
zero). <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Several
minimum spanning tree algorithms can be use here. Since we're finding
the MST
of a dense graph, the best option is probably the O(n^2) version of the
Prim
algorithm: <p></p></span></p>
<ul type="disc">
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Start with the
tree being a single vertex <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Keep a list of
distances of every other vertex to the tree <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>At each iteration
    <p></p></span></li>
  <ul type="circle">
    <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Add the closest
vertex to the tree <p></p></span></li>
    <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Update the
distances accordingly. <p></p></span></li>
  </ul>
</ul>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This runs
in O(n^2) time, which suffices for this problem. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>By the
way: This problem can actually be done in O(nlogn+m) time. The idea is
basically the edges that could potentially be in the minimum spanning
tree must
belong to what's known as the Delaunay triangulation, which has O(n)
edges. We
can find the Delaunary triangulation in O(nlogn) time and apply a fast
version
of Kruskal's algorithm for sparse graphs to get the desired runtime. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Below is
Chinese sophomore ShiMen Xu's compact solution (which might or might
not match
the description above): <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;iostream&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;fstream&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;cmath&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>using
namespace std;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>ifstream
fin ("roads.in");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>struct
Tpoint {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>long long x, y;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>};<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Tpoint<span style=""> </span>p[1010];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>double<span style=""> </span>dis[1010];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int<span style="">
</span>N, M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int<span style="">
</span>us<span style="">
</span>[1010];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>double<span style=""> </span>ans;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void<span style="">
</span>init ();<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int<span style="">
</span>findRoot (int i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void<span style="">
</span>work ();<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
main () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE<span style="">
</span>*f = fopen ("roads.out", "w");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>init ();<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>work ();<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (f, "%0.2lf\n", ans);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
findRoot (int i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (us[i] == i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return us[i] = findRoot (us[i]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void
init () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fin &gt;&gt; N &gt;&gt; M;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (int i = 1; i &lt;= N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fin &gt;&gt; p[i].x &gt;&gt; p[i].y;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (int i = 0; i &lt;= N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>us[i] = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (int i = 0; i &lt; M; i++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int<span style=""> </span>a<span style=""> </span>, b, a1, b1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fin &gt;&gt; a &gt;&gt; b;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if ((a1 = findRoot (a)) != (b1 =
findRoot (b)))<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>us[a1] = b1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void
work () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int<span style=""> </span><span style=""> </span>root,
cnt[1010], id;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>root = findRoot (1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset (cnt, 0, sizeof (cnt));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (int i = 0; i &lt;= N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dis[i] = 10000000.0 * 1000000.0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (id = 1;; id++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (int i = 1; i &lt;= N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>if (cnt[i] == 0)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (root == findRoot (i))<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>cnt[i] = id;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>double<span style=""> </span>mindis
= dis[0];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int<span style=""> </span>minj
= 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (int i = 1; i &lt;= N; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>if (cnt[i] == id)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (int j = 2; j &lt;= N; j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>if (cnt[j] == 0) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>double<span style=""> </span>d1 = sqrt ((p[j].x - p[i].x)
* (p[j].x -
p[i].x) +<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>(p[j].y - p[i].y) * (p[j].y - p[i].y));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>dis[j] &lt;? = d1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (dis[j] &lt; mindis) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>mindis = dis[j];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>minj = j;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style=""> </span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (minj == 0)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><span style="">
</span>break;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int<span style=""> </span>j1
= findRoot (minj);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>ans += mindis;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>us[j1] = root;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248245">Mud Puddles [Jeffrey Wang, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John is leaving his house promptly at 6 AM for his daily milking of Bessie. However, the previous evening saw a heavy rain, and the fields are quite muddy. FJ starts at the point (0, 0) in the coordinate plane and heads toward Bessie who is located at (X, Y) (-500 &lt;= X &lt;= 500; -500 &lt;= Y &lt;= 500). He can see all N (1 &lt;= N &lt;= 10,000) puddles of mud, located at points (A_i, B_i) (-500 &lt;= A_i &lt;= 500; -500 &lt;= B_i &lt;= 500) on the field. Each puddle occupies only the point it is on.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Having just bought new boots, Farmer John absolutely does not want to dirty them by stepping in a puddle, but he also wants to get to Bessie as quickly as possible. He's already late because he had to count all the puddles. If Farmer John can only travel parallel to the axes and turn at points with integer coordinates, what is the shortest distance he must travel to reach Bessie and keep his boots clean? There will always be a path without mud that Farmer John can take to reach Bessie.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Three space-separate integers: X, Y, and N.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2...N+1: Line i+1 contains two space-separated integers: A_i <span style=""></span>and B_i<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file mud.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">1 2 7<p></p></pre>
<pre style="text-align: justify;">0 2<p></p></pre>
<pre style="text-align: justify;">-1 3<p></p></pre>
<pre style="text-align: justify;">3 1<p></p></pre>
<pre style="text-align: justify;">1 1<p></p></pre>
<pre style="text-align: justify;">4 2<p></p></pre>
<pre style="text-align: justify;">-1 1<p></p></pre>
<pre style="text-align: justify;">2 2<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie is at (1, 2). Farmer John sees 7 mud puddles, located at (0, 2); (-1, 3); (3, 1); (1, 1); (4, 2); (-1, 1) and (2, 2). Pictorially:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>4 . . . . . . . . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>3 . M . . . . . . <p></p></pre>
<pre style="text-align: justify;">Y<span style=""> </span>2 . . M B M . M . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>1 . M . M . M . . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>0 . . * . . . . . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>-1 . . . . . . . . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>-2-1 0 1 2 3 4 5 <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>X<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: The minimum distance that Farmer John has to travel to reach<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Bessie without stepping in mud.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file mud.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">11<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The best path for Farmer John is (0, 0); (-1, 0); (-2, 0); (-2, 1);<p></p></pre>
<pre style="text-align: justify;">(-2, 2); (-2, 3); (-2, 4); (-1, 4); (0, 4); (0, 3); (1, 3); and (1,<p></p></pre>
<pre style="text-align: justify;">2), finally reaching Bessie.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>4 ******* . . . . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>3 * M . * . . . . <p></p></pre>
<pre style="text-align: justify;">Y<span style=""> </span>2 * . M B M . M . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>1 * M . M . M . . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>0 ***** . . . . . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>-1 . . . . . . . . <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>-2-1 0 1 2 3 4 5 <p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>X<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This is a
classic 'Flood fill' algorithm. The idea is that one seeds a 'flood
fill' with
an initial point followed by massive recursion to find the points
around that
point. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Using a
small 5 x 5 matrix as an example: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>4
. . . . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>3
. . . . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>2
. . * . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>1
. . . . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>0
. . . . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0 1 2 3 4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>one can easily
imagine starting at
point 2,2 and then examining points around it after marking those
points with
the 'distance' from the initial point: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>4
. . . . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>3
. . 1 . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>2
. 1 * 1 .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>1
. . 1 . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>0
. . . . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0 1 2 3 4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>and then
examining points around
those 1's: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>4
. . 2 . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>3
. 2 1 2 .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>2
2 1 * 1 2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>1
. 2 1 2 .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>0
. . 2 . .<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0 1 2 3 4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>and so on until
all distances are
determined: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>4|4
3 2 3 4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>3|3
2 1 2 3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>2|2
1 * 1 2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>1|3
2 1 2 3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style=""></span>0|4
3 2 3 4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>+---------<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0 1 2 3 4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Adding in
obstacles just makes some
of the distances a bit different since certain cells can not be used in
the
recursive search. Here is the flooded version of the sample input data:
<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>4| 6<span style="">
</span>7<span style=""> </span>8<span style=""> </span>9
10 11 10<span style="">
</span>9<span style=""> </span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>3| 5<span style="">
</span>M<span style=""> </span>9 10 11 10<span style=""> </span>9<span style=""> </span>8 <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Y<span style="">
</span>2| 4 <span style=""></span>5<span style="">
</span>M<span style=""> </span>B<span style=""> </span>M
11<span style="">
</span>M<span style=""> </span>7 <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>1| 3<span style="">
</span>M<span style=""> </span>1<span style=""> </span>M<span style="">
</span>3<span style=""> </span>M<span style=""> </span>5<span style=""> </span>6 <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>0| 2<span style="">
</span>1<span style=""> </span>*<span style=""> </span>1<span style="">
</span>2<span style=""> </span>3<span style=""> </span>4<span style=""> </span>5 <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>-1| 3<span style="">
</span>2<span style=""> </span>1<span style=""> </span>2<span style="">
</span>3<span style=""> </span>4<span style=""> </span>5<span style=""> </span>6 <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>+-----------------------<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>-2 -1<span style="">
</span>0<span style=""> </span>1<span style=""> </span>2<span style="">
</span>3<span style=""> </span>4<span style=""> </span>5 <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>X<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The final '11'
has not been written
on to the 'B' square on which Bessie sits, but it's clear that 11 is
the
answer. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
obvious way to implement this algorithm is so simple (yet wrong): <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>check(x,y,dist)
{<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (dist &gt; matrix[x,y]) return;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>matrix[x,y] = dist;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (validsubscript (x+1, y<span style=""> </span>) check
(x+1, y<span style=""> </span>, dist+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (validsubscript (x-1, y<span style=""> </span>) check
(x-1, y<span style=""> </span>, dist+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (validsubscript (x<span style=""> </span>, y+1) check
(x<span style=""> </span>, y+1, dist+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (validsubscript (x<span style=""> </span>, y-1) check
(x<span style=""> </span>, y-1, dist+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The pleasing
intuitive brevity,
though, is nothing but a trap. Why? Because, as shown, the subprogram
will
quickly recurse to check(x+1, ...), check (x+2, ...) and so on down the
x axis
instead of the geometrically nice circular pattern exhibited a few
paragraphs
back. Will the algorithm still get the right answer? Yes! Is there a
way to
implement the algorithm that will take longer to get to the right
answer?
Probably not. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Instead,
one needs to implement a FIFO queue structure so that all four of the
'next
elements to search' are queued before any of them is examined. Bonus
performance for knowing if an element is already queued (and thus
avoiding
requeueing it). Note that one should requeue elements whose value has
changed
-- but it's hardly ever an advantage to have the same element on the
queue more
than once. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><i><span style='font-size: 10pt; font-family: "Courier New";'>Aside: queues
can be nicely implemented with linked lists. Such lists are slightly
tricky to
get 'right the first time' and sometimes are implemented to allocate a
tiny bit
of storage for each element added to the list. In contest programming,
one
might as well just make a big array and circle through it. If you need
more
space than the array allows, you would have needed more linked-list
space --
and failed very late in the program's execution. Better to expose the
potential
failure up front!</span></i><span style='font-size: 10pt; font-family: "Courier New";'> <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The final
challenge in this task was the coordinate scheme: it starts at some
large
negative number, so all subscripts need to be shifted into a valid
range. The
first program below does this with #define's; the second explicitly
codes the
shift into each subscript. <p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>My solution
is intended to be straightforward with the tiny trick of using a bit
more
storage to set up a 'border' around the edges of the matrix. This
avoids having
to validate every possible enqueueing to ensure the subscripts will not
go out
of bounds for the array: <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;stdio.h&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#define
RANGE 500<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#define
FIELD(i,j) field[(i)+RANGE+2][(j)+RANGE+2]<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#define
DONE(i,j) done[(i)+RANGE+2][(j)+RANGE+2]<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#define
QUEUED(i,j) queued[(i)+RANGE+2][(j)+RANGE+2]<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>short
field[2*RANGE+5][2*RANGE+5];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>char
done[2*RANGE+5][2*RANGE+5], queued[2*RANGE+5][2*RANGE+5];<span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>struct
q { int x, y; } queue[800000];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
nq = 0, head = 0; tail = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>tryenq
(x,y,thisdist) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (FIELD(x,y) != 0 &amp;&amp; thisdist
&gt;= FIELD(x,y)) return;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (QUEUED(x,y)) return;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>QUEUED(x,y) = 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FIELD(x,y) = thisdist;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (++nq &gt;= 790000) exit (9);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>queue[tail].x = x;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>queue[tail].y = y;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (++tail &gt;= 800000) tail = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>main
() {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fin = fopen ("mud.in",
"r");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FILE *fout = fopen ("mud.out",
"w");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int X, Y, N, i, j, A, B;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, "%d %d %d", &amp;X,
&amp;Y, &amp;N);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; N; i++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fscanf (fin, "%d %d", &amp;A,
&amp;B);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>DONE(A,B) = -1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>/* set up a border so we don't look
outside box: */<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = -RANGE; i &lt;= RANGE; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FIELD(-RANGE-1,i) = FIELD(RANGE+1,i) =
FIELD(i,RANGE+1) =<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>FIELD(i,-RANGE-1)
= -1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tryenq (0,0,0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>while (nq) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int x=queue[head].x; <span style="">
</span>/* dequeue */<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int y=queue[head].y;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>QUEUED(x,y) = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>nq--;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (++head &gt;= 800000) head = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>/* enqueue if needed: */<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (DONE(x,y)) continue;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>DONE(x,y) = 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tryenq(x+1, y<span style=""> </span>, FIELD(x,y)+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tryenq(x-1, y<span style=""> </span>, FIELD(x,y)+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tryenq(x<span style="">
</span>, y+1, FIELD(x,y)+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tryenq(x<span style="">
</span>, y-1, FIELD(x,y)+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>fprintf (fout, "%d\n",
FIELD(X,Y));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>exit (0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Richard
Peng's solution is a bit shorter (as usual). Among the techniques for
compaction: <p></p></span></p>
<ul type="disc">
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The 'dir' array
of the four pairs of integers that describe the four potential squares
to be newly examined <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Using array
subscripts rather than an structure for storing the queue (probably a
bit more obscure to understand if you look at the program six months
later) <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Omission of
tagging to prevent extra queueing/checking <p></p></span></li>
  <li class="MsoNormal" style="text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Inclusion of
negative elements in the 'vis' array to prevent extra processing
(probably a big win) <p></p></span></li>
</ul>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Richard's program
is over 1.5x
faster than the program above. <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;cstdio&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include
&lt;cstring&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>short
vis[1020][1020], r, c, shif, q[1100000][2];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
a, b, x, y, n, tai;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
dir[4][2]={-1, 0, 1, 0, 0, -1, 0, 1};<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void
add (int r1, int c1, int d) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if (r1&gt;=0 &amp;&amp; r1&lt;r &amp;&amp;
c1&gt;=0 &amp;&amp; c1&lt;c &amp;&amp; vis[r1][c1]==-1) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>vis[r1][c1]=d;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>q[tai][0]=r1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>q[tai][1]=c1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tai++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
main () {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int i, j;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen ("mud.in", "r",
stdin);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen ("mud.out",
"w", stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>r = 1010;<span style="">
</span>c = 1010;<span style=""> </span>shif = 505;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tai = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf ("%d%d%d", &amp;x, &amp;y,
&amp;n);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; r; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (j = 0; j &lt; c; j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>vis[i][j] = -1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; n; i++){<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf ("%d%d", &amp;a,
&amp;b);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>vis[a+shif][b+shif] = -2;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>tai = 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>add (shif, shif, 0);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; tai; i++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (j = 0; j &lt; 4; j++)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>add (q[i][0]+dir[j][0],
q[i][1]+dir[j][1], vis[q[i][0]][q[i][1]]+1);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf ("%d\n",
vis[x+shif][y+shif]);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h2 style="margin-left: 144pt; text-align: left; text-indent: 36pt;" align="left">
<span style=""></span><a name="_Toc188248246">GOLD
PROBLEMS</a><p></p>
</h2>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*****************************************************************************<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3>
<a name="_Toc188248247">Sightseeing Cows [Reid Barton, 2007]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Farmer
John has decided to reward his cows for their hard work by taking them
on a
tour of the big city! The cows must decide how best to spend their free
time.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Fortunately,
they have a detailed city map showing the L (2 &lt;= L &lt;= 1000)
major
landmarks (conveniently numbered 1.. L) and the P (2 &lt;= P &lt;=
5000)
unidirectional cow paths that join them. Farmer John will drive the
cows to a
starting landmark of their choice, from which they will walk along the
cow
paths to a series of other landmarks, ending back at their starting
landmark
where Farmer John will pick them up and take them back to the<span style=""> </span>farm. Because space in the city is at a
premium, the cow paths are very narrow and so travel along each cow
path is
only allowed in one fixed direction.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>While
the cows may spend as much time as they like in the city, they do tend
to get
bored easily. Visiting each new landmark is fun, but walking between
them takes
time. The cows know the exact fun values F_i (1 &lt;= F_i &lt;= 1000)
for each
landmark i.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
cows also know about the cowpaths. Cowpath i connects landmark L1_i to
L2_i (in
the direction L1_i -&gt; L2_i) and requires time T_i (1 &lt;= T_i &lt;=
1000)
to traverse.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>In
order to have the best possible day off, the cows want to maximize the
average
fun value per unit time of their trip.<span style="">
</span>Of course, the landmarks are only fun the first time they are
visited;
the cows may pass through the landmark more than once, but they do not
perceive
its fun value again. Furthermore, Farmer John is making the cows visit
at least
two landmarks, so that they get some exercise during their day off.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Help
the cows find the maximum fun value per unit time that they can achieve.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: Two space-separated integers: L and P<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..L+1: Line i+1 contains a single one integer: F_i<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines L+2..L+P+1: Line L+i+1 describes cow path i with three
space-separated
integers: L1_i, L2_i, and T_i<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file sightsee.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5
7<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>30<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>10<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>10<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>10<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>1
2 3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
3 2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
4 5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
5 2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4
5 5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5
1 3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5
2 2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: A single number given to two decimal places (do not perform <span style=""></span>explicit
rounding), the maximum
possible average fun per unit time, or 0 if the cows cannot plan any
trip at
all in accordance with the above rules.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file sightsee.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>6.00<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
trip 1 -&gt; 2 -&gt; 3 -&gt; 5 -&gt; 1 has a total fun value of 60 and
a length
of 10 units for an average fun per unit time of 6. The trip 2 -&gt; 3
-&gt; 5
-&gt; 2 only has an average fun per unit time of 30/6 = 5, and any trip
involving landmark 4 has an average fun per unit time of less than 4.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
problem involves a graph in which each edge e has an associated length
L(e) and
fun value F(e). Our goal is to find a directed cycle C minimizing L(C)
/ F(C),
where L(C) denotes the total length of all edges in C and F(C) denotes
the
total fun value of all edges in C (note: the actual problem asks us to
maximize
F(C) / L(C), but I've converted it to a minimization problem since this
is more
common when we discuss shortest path type problems). <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>To
solve this problem quickly, we employ a common trick: binary search on
the
answer. Let us make a guess that the answer is X. By running one
instance of
the Bellman-Ford shortest path algorithm (in O(LP) time), we will be
able to
tell if this guess is too high or too low, thereby homing in on the
correct
answer. The one feature of the Bellman-Ford algorithm we use here is
the fact
that it can detect whether or not a negative-length direct cycle exists
in a
graph (we won't go into how this is done here, since this is a common
algorithm). <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>How
can negative cycle detection tell us if our guess X is too high or too
low?
Well, we would like to check if the minimum value of L(C)/F(C) over all
cycles
C is less than X (i.e., if there exists a cycle C such that L(C)/F(C)
&lt;= X).
If so, then our guess is too high; otherwise it is too low. But asking
whether
there exists a cycle C such that L(C)/F(C) &lt;= X is the same as
asking
whether there exists a cycle C such that L(C) &lt;= X F(C), which is
the same
as asking whether there exists a cycle C such that L(C) - X F(C) &lt;=
0. So if
we define the cost of each edge e as Z(e) = L(e) - X F(e), then this
turns into
a negative cycle detection problem with respect to the Z(e)'s! <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Below
is Chinese Junior Danqi Chen's full-credit beautifully formatted PASCAL
solution (this is precisely as she submitted it) which might or might
not match
the description above. <p></p></span></p>
<pre style="text-align: justify;"><span style=""> </span>program sightsee;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>const<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>finp<span style=""> </span>=<span style=""> </span>'sightsee.in';<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""></span>fout<span style=""> </span>=<span style=""> </span>'sightsee.out';<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>maxn<span style=""> </span>=<span style=""> </span>1000 + 5;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>eps<span style=""> </span>=<span style=""> </span>1e-4;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>type<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>nodeptr<span style=""> </span>=<span style=""> </span>^node;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>node<span style=""> </span>=<span style=""> </span>record<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>p, len<span style=""> </span>:<span style=""> </span>longint;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>next<span style=""> </span>:<span style=""> </span>nodeptr;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>var<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>hash<span style=""> </span>:<span style=""> </span>array [1 .. maxn] of boolean;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>queue, edge :<span style=""> </span>array [1 .. maxn] of longint;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>dist<span style=""> </span>:<span style=""> </span>array [1 .. maxn] of extended;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>a<span style=""> </span>:<span style=""> </span>array [1 .. maxn] of nodeptr;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>cost<span style=""> </span>:<span style=""> </span>array [1 .. maxn] of longint;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>n, m<span style=""> </span><span style=""></span>:<span style=""> </span>longint;<span style=""> </span><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>procedure create(x, y, c<span style=""> </span>:<span style=""> </span>longint);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>var<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>tmp<span style=""> </span>:<span style=""> </span>nodeptr;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>new(tmp); tmp ^.p := y; tmp ^. len := c;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>tmp ^.next := a[x]; a[x] := tmp;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>procedure init;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>var<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""></span>i<span style=""> </span>:<span style=""> </span>longint;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>x, y, c<span style=""> </span>:<span style=""> </span>longint;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>read(n, m);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for i := 1 to n do read(cost[i]);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for i := 1 to n do a[i] := nil;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for i := 1 to m do <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>read(x, y, c);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""></span>create(x, y, c);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"> <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>function nxt(i<span style=""> </span>:<span style=""> </span>longint):<span style=""> </span>longint;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if i = maxn then nxt := 1 else nxt := i + 1;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>function check(limit<span style=""> </span>:<span style=""> </span>extended):<span style=""> </span>boolean;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>var<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>h, t, i :<span style=""> </span>longint;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>tmp<span style=""> </span>:<span style=""> </span>nodeptr;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>v<span style=""> </span>:<span style=""> </span>extended;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>check := true;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fillchar(hash, sizeof(hash), false);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>h := 0; t := 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for i := 1 to n do <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>inc(t); queue[t] := i; hash[i] := true;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>dist[i] := 0; edge[i] := 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while (h &lt;&gt; t) do<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>h := nxt(h);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>tmp := a[queue[h]];<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while (tmp &lt;&gt; nil) do<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>v := tmp ^. len * limit - cost[tmp^.p];<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (dist[queue[h]] + v &lt; dist[tmp^.p]) then<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>dist[tmp^.p] := dist[queue[h]] + v;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>edge[tmp^.p] := edge[queue[h]] + 1;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if edge[tmp ^. p] &gt; n then exit; <p></p></pre>
<pre style="text-align: justify;"><span style=""></span>if not hash[tmp^.p] then<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>t := nxt(t);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>queue[t] := tmp^. p;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>hash[tmp ^.p] := true;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""></span>end;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>tmp := tmp ^. next;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>hash[queue[h]] := false;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>check := false;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>procedure work;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>var<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>l, r, mid<span style=""> </span>:<span style=""> </span>extended;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>l := 0; r := 1000;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while (r - l &gt; eps) do<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>mid := (l + r) / 2;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if check(mid) then l := mid else r := mid;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>writeln(l : 0 : 2);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>begin<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>assign(input, finp); reset(input);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>assign(output, fout); rewrite(output);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>init;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>work;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>close(input); close(output);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>end.<p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3>
<a name="_Toc188248248">Gourmet Grazers [Alex Schwendner, 2007]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Like
so many others, the cows have developed very haughty tastes and will no
longer
graze on just any grass. Instead, Farmer John must purchase gourmet
organic
grass at the Green Grass Grocers store for each of his N (1 &lt;= N
&lt;=
100,000) cows.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Each
cow_i demands grass of price at least A_i (1 &lt;= A_i &lt;=
1,000,000,000) and
with a greenness score at least B_i (1 &lt;= B_i &lt;= 1,000,000,000).
The GGG
store has M (1 &lt;= M &lt;= 100,000) different types of grass
available, each
with a price C_i (1 &lt;= C_i &lt;= 1,000,000,000) and a greenness
score of D_i
(1 &lt;= D_i &lt;= 1,000,000,000). Of course, no cow would sacrifice
her
individuality, so no two cows can have the same kind of grass.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Help
Farmer John satisfy the cows' expensive gourmet tastes while spending
as little
money as is necessary.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: Two space-separated integers: N and M.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..N+1: Line i+1 contains two space-separated integers: A_i <span style=""></span>and B_i<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines N+2..N+M+1: Line i+N+1 contains two space-separated integers: <span style=""></span>C_i
and D_i<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file gourmet.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4
7<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>1
1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>1
4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4
2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4
3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5
2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5
4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
6<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4
4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: A single integer which is the minimum cost to satisfy all <span style=""></span>the
cows. If that is not possible,
output -1.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file gourmet.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>12<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Cow
1 eats grass 2 at cost 2, cow 2 eats grass 3 at cost 4, cow 3 eats
grass 6 at
cost 2, and cow 4 eats grass 7 at cost 4, for a total cost of 12.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
greedy solution works for this task. The first observation is if we
sort the
requests and grasses by decreasing order of green-ness, the set of
grass we
need to consider for each request is precisely the set of all grass
that hasn't
been used yet that has a higher greenness. So we can add grasses to the
set as
we 'sweep' by them and remove the grasses as we use them. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Let's
just consider the prices. The claim is that at each moment, we can pick
the
cheapest grass that will satisfy the cow. This is true since suppose we
pick a
more expensive grass and use the cheaper one later, we can swap the
choices
while keeping both cows satisfied without increasing the total cost. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Now
the problem becomes a data structure problem, we need to support the
following
operations: insertion, deletion, find the first element with key bigger
than a
given value and we want to do each operation in O(logn) time. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
can be done using STL set. It's also possible to do this without STL
using a
binary index tree by first assigning values from 1 to n to the prices,
then
construct a full binary tree with the prices at leafs and track on each
node
whether the subtree below has values. Both give O(nlogn) solutions. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Below
is an extraordinarily compact full-credit solution submitted by
Belarus's
Gennady Korotkevich: <p></p></span></p>
<pre style="text-align: justify;">#include &lt;iterator&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;fstream&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;vector&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;algorithm&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;set&gt;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">#define __int64 long long<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">using namespace std;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">vector &lt; pair &lt;int,int&gt; &gt; c,f;<p></p></pre>
<pre style="text-align: justify;">set &lt; pair &lt;int,int&gt; &gt; a;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int main () {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>FILE *in<span style=""> </span>= fopen ("gourmet.in","r");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>FILE *out = fopen ("gourmet.out","w");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int n, m, i, q, w;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (in, "%d%d", &amp;n, &amp;m);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i=0; i&lt;n; i++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (in, "%d%d", &amp;q, &amp;w);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>c.push_back (make_pair (w, q));<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i=0; i&lt;m; i++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (in, "%d%d", &amp;q, &amp;w);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>f.push_back (make_pair (w, q));<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>sort (c.begin (), c.end ());<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>sort (f.begin (), f.end ());<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int r = m - 1;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>__int64 ans = 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>a.clear ();<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for<span style=""> </span>(i=n-1;i&gt;=0;i--) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while (1) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (r &lt; 0) break;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (f[r].first &gt;= c[i].first) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>a.insert (make_pair (f[r].second, r));<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>r--;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>else break;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>set&lt; pair &lt;int,int&gt; &gt;::iterator d =<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>a.lower_bound (make_pair (c[i].second, -1));<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if<span style=""> </span>(d == a.end ()) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fprintf (out, "-1\n");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return 0;<p></p></pre>
<pre style="text-align: justify;"> <span style=""></span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>ans +=<span style=""> </span>(*d).first;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>a.erase (d);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fprintf (out, "%Ld\n", ans);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return 0;<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3><p></p></h3>
<h3>
<a name="_Toc188248249">Best Cow Line, Gold [Christos Tzamos, 2007]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FJ
is about to take his N (1 &lt;= N &lt;= 30,000) cows to the annual
"Farmer
of the Year" competition. In this contest every farmer arranges his
cows
in a line and herds them past the judges.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
contest organizers adopted a new registration scheme this year: simply
register
the initial letter of every cow in the order they will appear (e.g., If
FJ takes
Bessie, Sylvia, and Dora in that order, he just registers BSD). After
the
registration phase ends, every group is judged in increasing
lexicographic
order (i.e., alphabetical order) according to the string of the
initials of the
cows' names.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FJ
is very busy this year and has to hurry back to his farm, so he wants
to be
judged as early as possible. He decides to rearrange his cows, who have
already
lined up, before registering them.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FJ
marks a location for a new line of the competing cows. He then proceeds
to
marshal the cows from the old line to the new one by repeatedly sending
either
the first or last cow in the (remainder of the) original line to the
end of the
new line. When he's finished, FJ takes his cows for registration in
this new
order.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Given
the initial order of his cows, determine the least lexicographic string
of
initials he can make this way.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>PROBLEM
NAME: bclgold<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: A single integer: N<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..N+1: Line i+1 contains a single initial ('A'..'Z') of the <span style=""></span>cow in
the ith position in the original
line<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file bclgold.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>6<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>A<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>C<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>D<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>B<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>C<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>B<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>FJ
has 6 cows in this order: ACDBCB<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
least lexicographic string he can make. Every line (except perhaps the
last
one) contains the initials of 80 cows ('A'..'Z') in the new line.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file bclgold.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>ABCBCD<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>Step<span style="">
</span>Original<span style=""> </span>New<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>#1<span style="">
</span>ACDBCB<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>#2<span style="">
</span>CDBCB<span style=""> </span>A<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>#3<span style="">
</span>CDBC<span style=""> </span>AB<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>#4<span style="">
</span>CDB<span style=""> </span>ABC<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>#5<span style="">
</span>CD<span style=""> </span>ABCB<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>#6<span style="">
</span>D<span style=""> </span>ABCBC<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>#7<span style="">
</span>ABCBCD<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This problem can
be solved with
dynamic programming on the intervals of cows but there is also a simple
greedy
strategy. <br>
<br>
Between the two cows in the edges, you must always pick the cow with
the
smallest initial letter. If both cows have the same initial letter in
order to
decide you must look a little bit deeper and check the second cows in
the
line's edges or the third ones if those are equal and so on until you
find two
cows that are different. Then you pick the cow from the side of the
smallest
one. <br>
<br>
This process can be summarized as follows. <br>
<br>
At any given interval [a,b] with string S([a,b]) you choose: <br>
<br>
Cow a if S([a,b]) &lt; rev( S([a,b]) )<br>
Cow b otherwise <br>
where rev(S) is the reverse string e.g. rev("abc") = "cba" <br>
<br>
This can be implemented in O(N^2) but we can achieve O(NlogN) by using
suffix
arrays. <br>
<br>
Here are the two implementations:</span><span style='font-size: 12pt; font-family: "Courier New";'> <br>
<br>
</span><span style='font-size: 10pt; font-family: "Courier New";'>The
O(N^2)</span><span style='font-size: 12pt; font-family: "Courier New";'>
<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include&lt;cstdio&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>char
S[2010],ln=0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void
prnt(char a) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(ln==80)
{printf("\n");ln=0;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf("%c",a);ln++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
main() {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int i,j,N,pi,pj,val;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen("bcl.in"
,"r",stdin );<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen("bcl.out","w",stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf("%d",&amp;N);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for(i=0;i&lt;N;i++) scanf(" %c
",S+i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>i=0,j=N-1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>while(i&lt;=j) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(S[i]&lt;S[j])<span style="">
</span>{prnt(S[i]);i++;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else if(S[i]&gt;S[j])<span style=""> </span>{prnt(S[j]);j--;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>pi=i+1;pj=j-1;val=S[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>while( pj-pi&gt;1
&amp;&amp; S[pi]==S[pj]) {pi++,pj--;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(S[pi]&lt;S[pj])
prnt(S[i]),i++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else prnt(S[j]),j--;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf("\n");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 12pt; font-family: "Courier New";'><br>
</span><span style='font-size: 10pt; font-family: "Courier New";'>And
the O(NlogN) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include&lt;cstdio&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include&lt;cstring&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include&lt;cstdlib&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#define
MAXN 500050<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>char
S[2*MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
N,ln=0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
o[2][2*MAXN], t[2*MAXN][2];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
A[2*MAXN], B[2*MAXN], C[2*MAXN], D[2*MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void
prnt(char a) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(ln==80)
{printf("\n");ln=0;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf("%c",a);ln++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
main() {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int i, j, jj, x, k;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen("bcl.in"
,"r",stdin );<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen("bcl.out","w",stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf("%d",&amp;N);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for(i=0;i&lt;N;i++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf(" %c ",S+i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>S[N+i] = S[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(A, 0, sizeof(A));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; 2*N; ++i)
A[(int)(S[i]-'A')] = 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 1; i &lt; 26; ++i) A[i] += A[i-1];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; 2*N; ++i) o[0][i] =
A[(int)(S[i]-'A')];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>x=0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (j = 0, jj = 1, k = 0; jj &lt; N
&amp;&amp; k &lt; 2*N; ++j, jj &lt;&lt;= 1) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(A, 0, sizeof(A));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(B, 0, sizeof(B));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; N; ++i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>++A[ t[i][0] = o[x][i] ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>++B[ t[i][1] =
(i+jj&lt;N) ? o[x][i+jj] : 0 ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = N; i &lt; 2*N; ++i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>++A[ t[i][0] = o[x][i] ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>++B[ t[i][1] =
(i-jj&gt;=N) ? o[x][i-jj] : 0 ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 1; i &lt;= 2*N; ++i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>A[i] += A[i-1];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>B[i] += B[i-1];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 2*N-1; i &gt;= 0; --i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>C[--B[t[i][1]]] = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 2*N-1; i &gt;= 0; --i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>D[--A[t[C[i]][0]]] =
C[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>x ^= 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>o[x][D[0]] = k = 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 1; i &lt; 2*N; ++i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>o[x][D[i]] = (k +=
(t[D[i]][0] != t[D[i-1]][0] || t[D[i]][1] != t[D[i-1]][1]));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>i=0,j=N-1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>while(i&lt;=j) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(S[i]&lt;S[j])<span style="">
</span>{prnt(S[i]);i++;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else if(S[i]&gt;S[j])<span style=""> </span>{prnt(S[j]);j--;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else if(o[x][i]&lt;o[x][N+j])
{prnt(S[i]);i++;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else {prnt(S[j]);j--;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf("\n");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h1>
<a name="_Toc188248250">Elite 2007 November Competition contest</a><p></p>
</h1>
<h2>
<a name="_Toc188248251">BRONZE PROBLEMS</a><p></p>
</h2>
<pre style="text-align: justify;">**********************************************************************<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248252">Exploration [Jeffrey Wang, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie is traveling on a road teeming with interesting landmarks. The road is labeled just like a number line, and Bessie starts at the "origin" (x = 0). A total of N (1 &lt;= N &lt;= 50,000) landmarks are located at points x_1, x_2, ..., x_N<span style=""> </span>(-100,000 &lt;= x_i &lt;= 100,000). Bessie wants to visit as many landmarks as possible before sundown, which occurs in T (1 &lt;= T &lt;= 1,000,000,000) minutes. She travels 1 distance unit in 1 minute.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie will visit the landmarks in a particular order. Since the landmarks closer to the origin are more important to Farmer John, she always heads for the unvisited landmark closest to the origin. No two landmarks will be the same distance away from the origin.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Help Bessie determine the maximum number of landmarks she can visit before the day ends.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: T and N<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Line i+1 contains a single integer that is the <span style=""></span>location of the ith landmark: x_i<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file explore.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">25 5<p></p></pre>
<pre style="text-align: justify;">10<p></p></pre>
<pre style="text-align: justify;">-3<p></p></pre>
<pre style="text-align: justify;">8<p></p></pre>
<pre style="text-align: justify;">-7<p></p></pre>
<pre style="text-align: justify;">1<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie has 25 minutes before sundown, and there are 5 landmarks located at positions 10, -3, 8, -7, and 1.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: The maximum number of landmarks Bessie can visit.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file explore.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie sequentially visits the landmarks at locations 1, -3, -7, and 8, after which she has traveled a total of 24 minutes.<span style=""> </span>She cannot visit the next intended landmark at position 10, since this would extend her total travel time to 26 minutes.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
is another 'ad hoc' problem: no generic algorithm. It was intended to
be the
easy problem but ended ranked the most difficult. I expect many folks
read far
more into it than was required. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
is not an optimization problem (it is not one where you find an optimal
route).
The route procedure was explicit: visit the next unvisited node that is
closest
to the origin. We know that in one dimension, distance is the absolute
value
between two points so the distance to the origin for point Z is just
|Z|, the
absolute value of Z. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Thus,
the problem devolves into finding the route (sorting the absolute value
of the
input data) and then simulating the traversal (i.e., visit successive
landmarks
until the time runs out). The problem was unclear about whether the
time limit
was &lt; T or &lt;= T, but the test data did not exploit this. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
only 'tricky part' is that the data was chosen such that an O(N<sup>2</sup>)
sort would not succeed on the largest test cases. One needed to invoke
a system
sort (e.g., qsort) or include a 'good' sort in the submitted program. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Below
is my straightforward solution: <p></p></span></p>
<pre style="text-align: justify;">#include &lt;stdio.h&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;stdlib.h&gt;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">abs(i) { return i &lt; 0 ? -i:i; }<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int compare_abs(int *a, int *b) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return abs(*a) - abs(*b);<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int list[50000];<p></p></pre>
<pre style="text-align: justify;">main() {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>FILE *fin = fopen ("explore.in", "r");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>FILE *fout = fopen ("explore.out", "w");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int T, N, i, j, bessloc, nvisit, timevisit;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fin, "%d %d", &amp;T, &amp;N);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i = 0; i &lt; N; i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""></span>fscanf (fin, "%d", &amp;list[i]);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>qsort (list, N, sizeof(int), compare_abs);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>/* start visiting: */<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>bessloc = 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>nvisit = 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>timevisit = 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i = 0; i &lt; N; i++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>timevisit += abs(list[i] - bessloc);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (timevisit &gt; T) break;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>nvisit++;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>bessloc = list[i];<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fprintf (fout, "%d\n", nvisit);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>exit (0);<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3><p></p></h3>
<h3><p></p></h3>
<h3>
<a name="_Toc188248253">Speed Reading [Jeffrey Wang, 2007]</a><p></p>
</h3>
<h3><span style='font-family: "Courier New";'><p></p></span></h3>
<pre style="text-align: justify;">All K (1 &lt;= K &lt;= 1,000) of the cows are participating in Farmer John's annual reading contest. The competition consists of reading a single book with N (1 &lt;= N &lt;= 100,000) pages as fast as possible while understanding it.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Cow i has a reading speed S_i (1 &lt;= S_i &lt;= 100) pages per minute, a maximum consecutive reading time T_i (1 &lt;= T_i &lt;= 100) minutes, and a minimum rest time R_i (1 &lt;= R_i &lt;= 100) minutes.<span style=""> </span>The cow can read at a rate of S_i pages per minute, but only for T_i minutes at a time. After she stops reading to rest, she must rest for R_i minutes before commencing reading again.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Determine the number of minutes (rounded up to the nearest full minute) that it will take for each cow to read the book.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Two space-separated integers: N and K<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..K+1: Line i+1 contains three space-separated integers: S_i, <span style=""></span>T_i, and R_i<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file read.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">10 3<p></p></pre>
<pre style="text-align: justify;">2 4 1<p></p></pre>
<pre style="text-align: justify;">6 1 5<p></p></pre>
<pre style="text-align: justify;">3 3 3<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The book has 10 pages; 3 cows are competing. The first cow reads at a rate of 2 pages per minute, can read for at most 4 minutes at a time, and must rest for 1 minute after reading. The second reads at a rate of 6 pages per minute, can read for at most 1 minute at a time, and must rest 5 minutes after reading. The last reads at a rate of 3 pages per minute, can read for at most 3 minutes at a time, and must rest for 3 minutes after reading.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 1..K: Line i should indicate how many minutes (rounded up to <span style=""></span>the nearest full minute) are required for cow i to read the whole book.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file read.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">6<p></p></pre>
<pre style="text-align: justify;">7<p></p></pre>
<pre style="text-align: justify;">7<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The first cow can read 8 pages in 4 minutes, rest for 1 minute, and read the last 2 pages in a minute. The second reads 6 pages in a minute, rests for 5 minutes, and finishes in the next minute. The last reads 9 pages in 3 minutes, rests for 3 minutes, and finishes in the next minute.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
is an 'ad hoc' programming problem: just 'figure it out' and make it
work. No
commonly used algorithm or anything like that. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>I
personally read this as a sort of 'simulation' problem so I wrote the
simple
solution that would simulate what's going on in a step-by-step way. I
ran a
counter for the minutes and reduced the number of pages remaining by
the speed
for each minute that went by (and incremented the busy counter so I'd
know when
to rest). When it was time to rest, I incremented the minutes so that
resting
would take place and then reset my busy counter. I think the solution
is simple
-- and it surely runs quickly enough: <p></p></span></p>
<pre style="text-align: justify;">#include &lt;stdio.h&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;stdlib.h&gt;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">main() {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>FILE *fin = fopen ("read.in", "r");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>FILE *fout = fopen ("read.out", "w");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int N, K, speed, timex, rest, i, t, minutes, pages, busy;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf(fin, "%d %d", &amp;N, &amp;K);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i = 0; i &lt; K; i++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fin, "%d %d %d", &amp;speed, &amp;timex, &amp;rest);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>pages = N;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>busy = 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (minutes = 1; ; minutes++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>pages -= speed;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>busy++;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (pages &lt;= 0) break;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (busy == timex) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>minutes += rest;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>busy = 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fprintf (fout, "%d\n", minutes);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>exit (0);<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Richard
Peng (and a host of others), on the other hand, created tricky (in my
opinion)
formulae that would yield the answer at least somewhat directly (at
least
without looping). One of these solutions is below. Unfortunately,
another coach
who tried the same thing got wrong answers on some of the cases. Half
those who
submitted solutions to this problem missed the final test case; it
appears at
least some of them tried the trickier math procedures. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Here's
Richard's compact quick solution: <p></p></span></p>
<pre style="text-align: justify;">#include &lt;cstdio&gt;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int ans, n, r, s, t;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int main() {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int ct;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>freopen ("read.in", "r", stdin);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>freopen ("read.out", "w", stdout);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>scanf ("%d%d", &amp;n, &amp;ct);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while (ct--) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>scanf ("%d%d%d", &amp;r, &amp;s, &amp;t);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>ans = (s+t)*(n/(r*s));<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if( n%(r*s)==0 &amp;&amp; n!=0) ans -= t;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>ans += ((n%(r*s))+r-1)/r;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>printf("%d\n",ans);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return 0;<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248254">Avoid The Lakes [Jeffrey Wang, 2007]</a><p></p>
</h3>
<h3><span style='font-family: "Courier New";'><p></p></span></h3>
<pre style="text-align: justify;">Farmer John's farm was flooded in the most recent storm, a fact only aggravated by the information that his cows are deathly afraid of water. His insurance agency will only repay him, however, an amount depending on the size of the largest "lake" on his farm.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The farm is represented as a rectangular grid with N (1 &lt;= N &lt;= 100) rows and M (1 &lt;= M &lt;= 100) columns. Each cell in the grid is either dry or submerged, and exactly K (1 &lt;= K &lt;= N*M) of the cells are submerged. As one would expect, a lake has a central cell to which other cells connect by sharing a long edge (not a corner). Any cell that shares a long edge with the central cell or shares a long edge with any connected cell becomes a connected cell and is part of the lake.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Three space-separated integers: N, M, and K<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..K+1: Line i+1 describes one submerged location with two <span style=""></span>space separated integers that are its row and column: R and C<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file lake.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">3 4 5<p></p></pre>
<pre style="text-align: justify;">3 2<p></p></pre>
<pre style="text-align: justify;">2 2<p></p></pre>
<pre style="text-align: justify;">3 1<p></p></pre>
<pre style="text-align: justify;">2 3<p></p></pre>
<pre style="text-align: justify;">1 1<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The farm is a grid with three rows and four columns; five of the cells are submerged. They are located in the positions (row 3, column 2); (row 2, column 2); (row 3, column 1); (row 2, column 3); (row 1, column 1):<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span># . . .<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>. # # .<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span># # . .<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: The number of cells that the largest lake contains.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file lake.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The largest lake consists of the input's first four cells.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
is one of the incarnations of the absolute classic 'flood fill'
problems. The
goal is to figure out which squares are 4-connected (no diagonals) to a
given
square. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
solution relies on simple scanning of the 'lake' looking for water
spots. When
one is found, a count is commenced for that spot and, recursively, its
neighbors (see the four invocations of 'lsize' inside 'lsize' itself).
Each
spot that is scanned is marked so that scanning will not be attempted
for that
spot again. Thus, the algorithm is linear in the number of squares
scanned,
O(R*C). <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>One
can implement a queue for scanning (a sort of 'breadth-first' approach)
or use
simple recursion as the solution below indicates. Simple recursion
works
because the 'marking' occurs before any of the recursive calls, each of
which
is conditional on checking the 'marking'. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
solution here is clever in that it creates a buffer zone of 'marked'
(i.e.,
0-valued) squares around the input matrix. Thus no range- or
bounds-checking is
required to ensure that the test for 4-connectedness stays in the legal
range. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Here
is coach Dr. Brian Dean's solution: <p></p></span></p>
<pre style="text-align: justify;">#include &lt;stdio.h&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;stdlib.h&gt;<p></p></pre>
<pre style="text-align: justify;">#define MAX(a,b) ((a) &gt; (b) ? (a) : (b))<p></p></pre>
<pre style="text-align: justify;">#define MAX_N 100<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int N, M, K, map[MAX_N+2][MAX_N+2];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int lsize(int i, int j) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int a = 1;<span style=""> </span>/* this square gets single count */<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>map[i][j] = 0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (map[i][j-1]) a += lsize(i,j-1);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (map[i][j+1]) a += lsize(i,j+1);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (map[i-1][j]) a += lsize(i-1,j);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (map[i+1][j]) a += lsize(i+1,j);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return a;<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int main(void) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>FILE *fp;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int i, j, k, best=0;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fp = fopen ("lake.in", "r");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fp, "%d %d %d", &amp;N, &amp;M, &amp;K);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (k=0; k&lt;K; k++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fp, "%d %d", &amp;i, &amp;j);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>map[i][j] = 1;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fclose (fp);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i=1; i&lt;=N; i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (j=1; j&lt;=M; j++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (map[i][j])<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>best = MAX (best, lsize(i,j));<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fp = fopen ("lake.out", "w");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fprintf (fp, "%d\n", best);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fclose (fp);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return 0;<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h2>
<a name="_Toc188248255">SILVER PROBLEMS</a><p></p>
</h2>
<pre style="text-align: justify;">*****************************************************************************<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248256">Cow Hurdles [Neal Wu, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John wants the cows to prepare for the county jumping competition, so Bessie and the gang are practicing jumping over hurdles. They are getting tired, though, so they want to be able to use as little energy as possible to jump over the hurdles.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Obviously, it is not very difficult for a cow to jump over several very short hurdles, but one tall hurdle can be very stressful. Thus, the cows are only concerned about the height of the tallest hurdle they have to jump over.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The cows' practice room has N (1 &lt;= N &lt;= 300) stations, conveniently labeled 1..N. A set of M (1 &lt;= M &lt;= 25,000) one-way paths connects pairs of stations; the paths are also conveniently labeled 1..M. Path i travels from station S_i to station E_i and contains exactly one hurdle of height H_i (1 &lt;= H_i &lt;= 1,000,000). Cows must jump hurdles in any path they traverse.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The cows have T (1 &lt;= T &lt;= 40,000) tasks to complete. Task i comprises two distinct numbers, A_i and B_i (1 &lt;= A_i &lt;= N; 1 &lt;= B_i &lt;= N), which connote that a cow has to travel from station A_i to station B_i (by traversing over one or more paths over some route). The cows want to take a path the minimizes the height of the tallest hurdle they jump over when traveling from A_i to B_i. Your job is to write a program that determines the path whose tallest hurdle is smallest and report that height.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Three space-separated integers: N, M, and T<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..M+1: Line i+1 contains three space-separated integers: S_i, <span style=""></span>E_i, and H_i<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines M+2..M+T+1: Line i+M+1 contains two space-separated integers <span style=""></span>that describe task i: A_i and B_i<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file hurdles.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">5 6 3<p></p></pre>
<pre style="text-align: justify;">1 2 12<p></p></pre>
<pre style="text-align: justify;">3 2 8<p></p></pre>
<pre style="text-align: justify;">1 3 5<p></p></pre>
<pre style="text-align: justify;">2 5 3<p></p></pre>
<pre style="text-align: justify;">3 4 4<p></p></pre>
<pre style="text-align: justify;">2 4 8<p></p></pre>
<pre style="text-align: justify;">3 4<p></p></pre>
<pre style="text-align: justify;">1 2<p></p></pre>
<pre style="text-align: justify;">5 1<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 1..T: Line i contains the result for task i and tells the <span style=""></span><span style=""></span>smallest possible maximum height necessary to travel between the stations. Output -1 if it is impossible to travel between the two stations.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file hurdles.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">4<p></p></pre>
<pre style="text-align: justify;">8<p></p></pre>
<pre style="text-align: justify;">-1<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Query #1: The best way is to simply travel on the path from station 3 to<p></p></pre>
<pre style="text-align: justify;">station 4.<p></p></pre>
<pre style="text-align: justify;">Query #2: There is a path from station 1 to station 2, but a better way<p></p></pre>
<pre style="text-align: justify;">would be to travel from station 1 to station 3 and then to station 2.<p></p></pre>
<pre style="text-align: justify;">Query #3: There are no paths that start at station 5, so it is clear that<p></p></pre>
<pre style="text-align: justify;">there is no way to reach station 1 from station 5.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>First
of all, it is clear that this problem can be converted into a
(directed) graph,
and for each of the T queries, we wish to find the shortest path
between two
nodes A and B.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>One
possible solution is for every query, use either a single-source
shortest path
algorithm (such as Dijkstra) or do a depth-first search to find the
shortest
path. However, this can take up to O(N<sup>2</sup>) time for each
query, and
would then have a total running time of O(N<sup>2</sup> T), which is
too large
for this problem's constraints.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Thus
we instead want to find a way to precompute all of the shortest paths
beforehand. We do this by initializing all distances between two nodes
A and B
to the cost of the edge between A and B, or infinity if no such edge
exists.
Then we run the standard Floyd-Warshall algorithm (more info can be
found in
the Training pages or </span><a href="http://en.wikipedia.org/wiki/Floyd-Warshall_algorithm"><span style='font-size: 10pt; font-family: "Courier New";'>here</span></a><span style='font-size: 10pt; font-family: "Courier New";'>) to compute the
shortest
paths, with one difference: If cost (a, b, c,...) represents the cost
of
traveling from a to b and then from b to c, etc., then instead of<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>cost
(i, j, k) = cost (i, j) + cost (j, k)<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>we
now have<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>cost
(i, j, k) = max (cost (i, j), cost (j, k)).<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>(The
proof that this method does correctly find the shortest path is left to
the
reader.)<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Another
possibility is to compute the all-pairs shortest path beforehand with a
different method, such as doing Dijkstra from each node. However, this
is still
O(N<sup>3</sup>) and has a slightly higher constant factor.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>After
computing the all-pairs shortest paths, we then input each query and
output the
result (in constant time for each query). Note that if the distance
between A
and B is still infinity after running the shortest path algorithm, it
means
that no path exists from A to B, so we output -1.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Our
total running time is thus O(N<sup>3</sup> + T), since the
Floyd-Warshall takes
O(N<sup>3</sup>) time to compute the shortest paths, and each query
takes O(1)
time.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
following is a solution using this idea:<p></p></span></p>
<pre style="text-align: justify;">#include &lt;cstdio&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;cstring&gt;<p></p></pre>
<pre style="text-align: justify;">using namespace std;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">FILE *fout = fopen ("hurdles.out", "w");<p></p></pre>
<pre style="text-align: justify;">FILE *fin = fopen ("hurdles.in", "r");<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">const int INF = 1000000000;<p></p></pre>
<pre style="text-align: justify;">const int MAXN = 505;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int N, M, T;<p></p></pre>
<pre style="text-align: justify;">int dist [MAXN][MAXN];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">inline void minimize (int &amp;a, int b) { if (b &lt; a) a = b; }<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int main () {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""></span>// initialize to 'infinity'<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>memset (dist, 63, sizeof (dist));<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fin, "%d %d %d", &amp;N, &amp;M, &amp;T);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int a, b, c;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>// input data<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int i = 0; i &lt; M; i++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fin, "%d %d %d", &amp;a, &amp;b, &amp;c);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>a--, b--;<span style=""> </span>// use 0-based indexing<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>dist [a][b] &lt;?= c;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>// compute the shortest paths using Floyd-Warshall<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int k = 0; k &lt; N; k++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int i = 0; i &lt; N; i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""> </span>if (dist [i][k] &lt; INF)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int j = 0; j &lt; N; j++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""> </span>minimize (dist [i][j], dist [i][k] &gt;? dist [k][j]);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>// output results<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int i = 0; i &lt; T; i++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fin, "%d %d", &amp;a, &amp;b);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>a--, b--;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fprintf (fout, "%d\n", dist [a][b] &lt; INF ? dist [a][b] : -1);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return 0;<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248257">Milking Time [Jeffrey Wang, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie is such a hard-working cow. In fact, she is so focused on maximizing her productivity that she decides to schedule her next N (1 &lt;= N &lt;= 1,000,000) hours (conveniently labeled 0..N-1) so that she produces as much milk as possible.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Farmer John has a list of M (1 &lt;= M &lt;= 1,000) possibly overlapping intervals in which he is available for milking. Each interval i has a starting hour (0 &lt;= starting_hour_i &lt; N), an ending hour (starting_hour_i &lt; ending_hour_i &lt;= N), and a corresponding efficiency (1 &lt;= efficiency_i &lt;= 1,000,000) which indicates how many gallons of milk that he can get out of Bessie in that interval. Farmer John starts and stops milking at the beginning of the starting hour and ending hour, respectively. When being milked, Bessie must be milked through an entire interval.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Even Bessie has her limitations, though. After being milked during any interval, she must rest R (1 &lt;= R &lt;= N) hours before she can start milking again. Given Farmer Johns list of intervals, determine the maximum amount of milk that Bessie can produce in the N hours.</pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: Three space-separated integers: N, M, and R<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..M+1: Line i+1 describes FJ's ith milking interval with <span style=""></span>three space-separated integers: starting_hour_i, ending_hour_i, and efficiency_i<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file milkprod.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">12 4 2<p></p></pre>
<pre style="text-align: justify;">1 2 8<p></p></pre>
<pre style="text-align: justify;">10 12 19<p></p></pre>
<pre style="text-align: justify;">3 6 24<p></p></pre>
<pre style="text-align: justify;">7 10 31<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Bessie wants to schedule the next 12 hours; Farmer John has four intervals in which he can milk her; Bessie must rest 2 hours after every milking. The first interval lasts from hour 1 to hour 2, the second from hour 10 to hour 12, the third from hour 3 to hour 6, and the fourth from hour 7 to hour 10. Farmer John can get 8, 19, 24, and 31 gallons of milk, respectively, from Bessie in those intervals.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: The maximum number of gallons of milk that Bessie can<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>product in the N hours<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file milkprod.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">43<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">If Bessie uses the first interval, she cannot use the third because she needs 2 hours of rest. If she uses the second, she cannot use the fourth.<span style=""> </span>Lastly, if she uses the third, she cannot use the fourth. The best situation is choosing the second and third intervals, producing 43 gallons of milk.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
goal of this problem is to select a disjoint set of intervals having
maximum
total efficiency. The technical term for such a problem would be to
find a
maximum-efficiency "packing" of intervals. If the intervals all have
the same efficiency (i.e., if we simply want to select a maximum number
of disjoint
intervals), then this is a rather well-known problem with a simple
greedy
solution: repeatedly choose the interval ending earliest, remove all
the
intervals it overlaps from consideration, and repeat. Since our problem
is a
more complicated "weighted" version of this problem, however, we can
no longer use a simple greedy approach, and we need to use dynamic
programming
instead. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>We
begin by sorting the intervals according to their ending times. Let
E(j) denote
the maximum efficiency we can obtain by a disjoint collection of just
intervals
i...j. We will compute E(1), E(2), ..., E(n) in order. When it comes
time to
compute E(j), this will be easy since we will have already computed
E(1) ...
E(j-1). Here is the formula: <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>E(j)
= max(E(j-1), j.efficiency + max{E(i) : i<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>&lt;="j.start})"
i.end and&gt; What does this mean? Well, the optimal solution for
intervals
1...j either includes interval j or it doesn't. To cover both cases, we
take
the best of two solutions: the best solution for intervals 1...j that
_doesn't_
contain j, and the best solution for intervals 1...j that _does_
contain j. In
the first case, the optimal solution value is just E(j-1), since we
only get to
use intervals 1...j-1. In the second case, we get to count the
efficiency of
interval j towards our total value, and then we finish off our solution
by
adding in E(i) for the "best" preceding interval i (where we only
consider those intervals i ending before j starts). <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>A
straightforward application of the formula above to compute E(1), E(2),
..., E(n)
gives us an O(n^2) running time, which is fine for this problem. With a
bit of
extra cleverness, we can actually get the running time down to O(n log
n). <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>If
you would like to test whether or not you understand the principle
behind this
solution well, consider the following related problem: you are given n
intervals that collectively cover the range 0....1,000,000, where each
interval
has an associated cost. Your goal is to find a minimum-cost subset of
the
intervals that still covers the range 0....1,000,000. Target running
time:
O(n^2), or O(n log n) if you are extra clever. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Here
is an O(n^2) solution to the milking time problem by Brian Dean: <p></p></span></p>
<pre style="text-align: justify;">#include &lt;stdio.h&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;stdio.h&gt;<p></p></pre>
<pre style="text-align: justify;">#define MAX_M 1000<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">typedef struct {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int start;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int end;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int efficiency;<p></p></pre>
<pre style="text-align: justify;">} Interval;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Interval I[MAX_M];<p></p></pre>
<pre style="text-align: justify;">int N, M, K, Best[MAX_M];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">static int Icomp(const void *p1, const void *p2)<p></p></pre>
<pre style="text-align: justify;">{<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Interval *I1 = (Interval *)p1;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Interval *I2 = (Interval *)p2;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return I1-&gt;end - I2-&gt;end;<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int main(void)<p></p></pre>
<pre style="text-align: justify;">{<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int i, j, best=-1;<p></p></pre>
<pre style="text-align: justify;"> <span style=""></span>FILE *fp;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fp = fopen ("milkprod.in", "r");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fp, "%d %d %d", &amp;N, &amp;M, &amp;K);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i=0; i&lt;M; i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fp, "%d %d %d", &amp;I[i].start, &amp;I[i].end, &amp;I[i].efficiency);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fclose (fp);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><p></p></pre>
<pre style="text-align: justify;"><span style=""></span>qsort (I, M, sizeof(Interval), Icomp);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (j=0; j&lt;M; j++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Best[j] = I[j].efficiency;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i=0; i&lt;j; i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (I[i].end + K &lt;= I[j].start &amp;&amp; Best[i] + I[j].efficiency &gt; Best[j])<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Best[j] = Best[i] + I[j].efficiency;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (Best[j] &gt; best) best = Best[j];<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fp = fopen ("milkprod.out", "w");<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fprintf (fp ,"%d\n", best);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fclose (fp);<p></p></pre>
<pre style="text-align: justify;">} <p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<h3>
<a name="_Toc188248258">Best Cow Line [Christos Tzamos, 2007]</a><p></p>
</h3>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">FJ is about to take his N (1 &lt;= N &lt;= 2,000) cows to the annual "Farmer of the Year" competition. In this contest every farmer arranges his cows in a line and herds them past the judges.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The contest organizers adopted a new registration scheme this year: simply register the initial letter of every cow in the order they will appear (i.e., If FJ takes Bessie, Sylvia, and Dora in that order he just registers BSD). After the registration phase ends, every group is judged in increasing lexicographic order according to the string of the initials of the cows' names.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">FJ is very busy this year and has to hurry back to his farm, so he wants to be judged as early as possible. He decides to rearrange his cows, who have already lined up, before registering them.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">FJ marks a location for a new line of the competing cows. He then proceeds to marshal the cows from the old line to the new one by repeatedly sending either the first or last cow in the (remainder of the) original line to the end of the new line. When he's finished, FJ takes his cows for registration in this new order.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Given the initial order of his cows, determine the least lexicographic<span style=""> </span>string of initials he can make this way.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">PROBLEM NAME: bcl<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Line 1: A single integer: N<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">* Lines 2..N+1: Line i+1 contains a single initial ('A'..'Z') of the <span style=""></span>cow in the ith position in the original line<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE INPUT (file bcl.in):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">6<p></p></pre>
<pre style="text-align: justify;">A<p></p></pre>
<pre style="text-align: justify;">C<p></p></pre>
<pre style="text-align: justify;">D<p></p></pre>
<pre style="text-align: justify;">B<p></p></pre>
<pre style="text-align: justify;">C<p></p></pre>
<pre style="text-align: justify;">B<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">INPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">FJ has 6 cows in this order: ACDBCB<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT FORMAT:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">The least lexicographic string he can make. Every line (except perhaps the last one) contains the initials of 80 cows ('A'..'Z') in the new line.<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">SAMPLE OUTPUT (file bcl.out):<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">ABCBCD<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">OUTPUT DETAILS:<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>Step<span style=""> </span>Original<span style=""> </span>New<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>#1<span style=""> </span>ACDBCB<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>#2<span style=""> </span>CDBCB<span style=""> </span>A<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>#3<span style=""> </span>CDBC<span style=""> </span>AB<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>#4<span style=""> </span>CDB<span style=""> </span>ABC<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>#5<span style=""> </span>CD<span style=""> </span>ABCB<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>#6<span style=""> </span>D<span style=""> </span>ABCBC<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>#7<span style=""> </span>ABCBCD<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>This problem can
be solved with
dynamic programming on the intervals of cows but there is also a simple
greedy
strategy. <br>
<br>
Between the two cows in the edges, you must always pick the cow with
the
smallest initial letter. If both cows have the same initial letter in
order to
decide you must look a little bit deeper and check the second cows in
the
line's edges or the third ones if those are equal and so on until you
find two
cows that are different. Then you pick the cow from the side of the
smallest
one. <br>
<br>
This process can be summarized as follows. <br>
<br>
At any given interval [a,b] with string S([a,b]) you choose: <br>
<br>
Cow a if S([a,b]) &lt; rev( S([a,b]) )<br>
Cow b otherwise <br>
where rev(S) is the reverse string e.g. rev("abc") = "cba" <br>
<br>
This can be implemented in O(N^2) but we can achieve O(NlogN) by using
suffix
arrays. <br>
<br>
Here are the two implementations: <br>
<br>
The O(N^2) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include&lt;cstdio&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>char
S[2010],ln=0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void
prnt(char a) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(ln==80)
{printf("\n");ln=0;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf("%c",a);ln++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
main() {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int i,j,N,pi,pj,val;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen("bcl.in"
,"r",stdin );<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen("bcl.out","w",stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf("%d",&amp;N);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for(i=0;i&lt;N;i++) scanf(" %c
",S+i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>i=0,j=N-1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>while(i&lt;=j) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(S[i]&lt;S[j])<span style="">
</span>{prnt(S[i]);i++;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else if(S[i]&gt;S[j])<span style=""> </span>{prnt(S[j]);j--;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>pi=i+1;pj=j-1;val=S[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>while( pj-pi&gt;1
&amp;&amp; S[pi]==S[pj]) {pi++,pj--;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(S[pi]&lt;S[pj])
prnt(S[i]),i++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else prnt(S[j]),j--;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf("\n");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 12pt; font-family: "Courier New";'><br>
</span><span style='font-size: 10pt; font-family: "Courier New";'>And
the O(NlogN) <p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include&lt;cstdio&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include&lt;cstring&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#include&lt;cstdlib&gt;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>#define
MAXN 500050<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>char
S[2*MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
N,ln=0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
o[2][2*MAXN], t[2*MAXN][2];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
A[2*MAXN], B[2*MAXN], C[2*MAXN], D[2*MAXN];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>void
prnt(char a) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(ln==80)
{printf("\n");ln=0;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf("%c",a);ln++;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>int
main() {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>int i, j, jj, x, k;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen("bcl.in"
,"r",stdin );<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>freopen("bcl.out","w",stdout);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf("%d",&amp;N);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for(i=0;i&lt;N;i++) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>scanf(" %c ",S+i);<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>S[N+i] = S[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(A, 0, sizeof(A));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; 2*N; ++i)
A[(int)(S[i]-'A')] = 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 1; i &lt; 26; ++i) A[i] +=
A[i-1];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; 2*N; ++i) o[0][i] =
A[(int)(S[i]-'A')];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>x=0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (j = 0, jj = 1, k = 0; jj &lt; N
&amp;&amp; k &lt; 2*N; ++j, jj &lt;&lt;= 1) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(A, 0, sizeof(A));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>memset(B, 0, sizeof(B));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 0; i &lt; N; ++i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>++A[ t[i][0] = o[x][i] ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>++B[ t[i][1] =
(i+jj&lt;N) ? o[x][i+jj] : 0 ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = N; i &lt; 2*N; ++i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>++A[ t[i][0] = o[x][i] ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>++B[ t[i][1] =
(i-jj&gt;=N) ? o[x][i-jj] : 0 ];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 1; i &lt;= 2*N; ++i) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>A[i] += A[i-1];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>B[i] += B[i-1];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 2*N-1; i &gt;= 0; --i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>C[--B[t[i][1]]] = i;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 2*N-1; i &gt;= 0; --i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>D[--A[t[C[i]][0]]] =
C[i];<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>x ^= 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>o[x][D[0]] = k = 1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>for (i = 1; i &lt; 2*N; ++i)<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>o[x][D[i]] = (k +=
(t[D[i]][0] != t[D[i-1]][0] || t[D[i]][1] != t[D[i-1]][1]));<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>i=0,j=N-1;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>while(i&lt;=j) {<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>if(S[i]&lt;S[j])<span style="">
</span>{prnt(S[i]);i++;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else if(S[i]&gt;S[j])<span style=""> </span>{prnt(S[j]);j--;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else if(o[x][i]&lt;o[x][N+j])
{prnt(S[i]);i++;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>else {prnt(S[j]);j--;}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>}<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>printf("\n");<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><span style="">
</span>return 0;<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>}<p></p></span></p>
<pre style="text-align: justify;"><p></p></pre>
<h2><p></p></h2>
<h2><p></p></h2>
<h2>
<a name="_Toc188248259">GOLD PROBLEMS</a><p></p>
</h2>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*****************************************************************************<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3>
<a name="_Toc188248260">Telephone Wire [Jeffrey Wang, 2007]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Farmer
John's cows are getting restless about their poor telephone service;
they want
FJ to replace the old telephone wire with new, more efficient wire. The
new
wiring will utilize N (2 &lt;= N &lt;= 100,000) already-installed
telephone
poles, each with some height_i meters (1 &lt;= height_i &lt;= 100). The
new
wire will connect the tops of each pair of adjacent poles and will
incur a
penalty cost C * the two poles' height difference for each section of
wire
where the poles are of different heights (1 &lt;= C &lt;= 100). The
poles, of
course, are in a certain sequence and can not be moved.<span style="">
</span>Farmer John figures that if he makes some
poles taller he can reduce his penalties, though with some other
additional
cost. He can add an integer X number of meters to a pole at a cost of
X^2.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Help
Farmer John determine the cheapest combination of growing pole heights
and
connecting wire so that the cows can get their new and improved service.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: Two space-separated integers: N and C<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..N+1: Line i+1 contains a single integer: height_i<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file telewire.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5
2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>There
are 5 telephone poles, and the vertical distance penalty is $2/meter.
The poles
initially have heights of 2, 3, 5, 1, and 4, respectively.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: The minimum total amount of money that it will cost Farmer <span style=""></span>John
to attach the new telephone wire.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file telewire.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>15<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
best way is for Farmer John to raise the first pole by 1 unit and the
fourth
pole by 2 units, making the heights (in order) 3, 3, 5, 3, and 4. This
costs
$5. The remaining wiring will cost $2*(0+2+2+1) = $10, for a<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>total
of $15.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Let
H[i] be the original height of the i-th pole, and let f(n, h) be the
minimum
cost for n poles with the n-th pole having height h. Then: <p></p></span></p>
<pre style="text-align: justify;">f(n, h) = min { (H[i]-h)^2 + f(n-1, h') + C|h'-h| } for all h'<p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>With
a straightforward dynamic programming implementation, this runs in O(N*H<sup>2</sup>),
where H is the maximum height. However, by splitting up the recurrence
relation
into two cases, one where h' &gt;= h and one where h' &lt; h, we can
rewrite it
as: <p></p></span></p>
<pre style="text-align: justify;">f(n, h) = (H[i]-h)^2 + min { -C*h + min { f(n-1, h')+C*h' } (for h' &gt;= h),<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>C*h + min { f(n-1, h')-C*h' } (for h' &lt; h) }<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Define low(n, h)<span style=""> </span>:= min over h' &gt;= h { f(n, h')+C*h' }<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>and high(n, h) := min over h' &lt; h<span style=""> </span>{ f(n, h')-C*h' }<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">Then f(n, h) = (H[i]-h)^2 + min { -C*h+low(n-1, h), C*h+high(n-1, h) }<p></p></pre>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>low(n,
h) and high(n, h) for all n, h can be computed in O(N*H) time; thus
f(n, h) can
be computed in O(N*H) time as well. A final implementation detail: an
array of
size O(N*H) exceeds the the memory limit, but only two "rows" of the
DP table are needed at a time, so an array of size 2*H is sufficient. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Below
is Richard Peng's solution: <p></p></span></p>
<pre style="text-align: justify;">#include &lt;cstdio&gt;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">#define MAXN 110000<p></p></pre>
<pre style="text-align: justify;">#define MAXH 101<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int h[MAXN], bes[2][MAXH], ans, huge, bes1, c, n;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">inline int sqr (int x){return x*x; }<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int main (){<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int i, j, pre, cur;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>freopen ("telewire.in", "r", stdin);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>freopen ("telewire.out", "w", stdout);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>huge = 2100000000;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>scanf ("%d%d", &amp;n, &amp;c);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i = 0; i&lt;n; i++)<span style=""> </span>scanf ("%d\n", &amp;h[i]);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i = 0; i&lt;MAXH; i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>bes[0][i] = (i&gt; = h[0]) ? sqr(h[0]-i) : huge;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i = 1; i&lt;n; i++){<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>pre = (i+1)%2;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>cur = i%2;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (bes1 = huge, j = 0; j&lt;MAXH; j++){<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>bes1 &lt;?= bes[pre][j]-j*c;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>bes[cur][j] = bes1+j*c;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (bes1 = huge, j = MAXH-1; j&gt; = 0; j--){<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>bes1 &lt;?= bes[pre][j]+j*c;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>bes[cur][j] &lt;?= bes1-j*c;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (j = 0; j&lt;MAXH; j++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>bes[cur][j] = (j&gt; = h[i])? (bes[cur][j] + sqr(j-h[i])) : huge;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>ans = huge;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (i = 0; i&lt;MAXH; i++) ans&lt;? = bes[cur][i];<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>printf ("%d\n", ans);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return 0;<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3>
<a name="_Toc188248261">Cow Relays [Erik Bernhardsson, 2003]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>For
their physical fitness program, N (2 &lt;= N &lt;= 1,000,000) cows have
decided
to run a relay race using the T (2 &lt;= T &lt;= 100) cow trails
throughout the
pasture.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Each
trail connects two different intersections (1 &lt;= I1_i &lt;= 1,000; 1
&lt;=
I2_i &lt;= 1,000), each of which is the termination for at least two
trails.
The cows know the length_i of each trail (1 &lt;= length_i &lt;=
1,000), the
two intersections the trail connects, and they know that no two
intersections
are directly connected by two different trails. The trails form a
structure
known mathematically as a graph.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>To
run the relay, the N cows position themselves at various intersections
(some
intersections might have more than one cow). They must position
themselves
properly so that they can hand off the baton cow-by-cow and end up at
the
proper finishing place.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Write
a program to help position the cows. Find the shortest path that
connects the
starting intersection (S) and the ending intersection (E) and traverses
exactly
N cow trails.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: Four space-separated integers: N, T, S, and E<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..T+1: Line i+1 describes trail i with three space-separated <span style=""></span>integers:
length_i, I1_i, and I2_i<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file relays.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
6 6 4<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>11
4 6<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4
4 8<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>8
4 9<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>6
6 8<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
6 9<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
8 9<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: A single integer that is the shortest distance from <span style=""></span>intersection
S to intersection E that
traverses exactly N cow<span style=""> </span><span style=""></span>trails.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file relays.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>10<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>First,
note that there cannot be more than T distinct nodes in our graph,
because
there are exactly T edges in the graph, and each node is an endpoint
for at
least two edges.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>The
simplest solution that is reasonably fast is to let s[L][V] be the
shortest
path from node S to node V that has length L. We can compute the values
in this
array by iterating N times, each time trying to travel through one edge
from
each node. The memory for this can be reduced by using a sliding window
(since
computing the values for length L only uses the values for length L -
1), and
this solution uses O(N T<sup>2</sup>) time. To obtain a faster
solution, we do
the following.<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Assume
we have the shortest path, from S to E, of length N. Then we can break
up this
path into smaller paths whose lengths are powers of two. Thus, we can
compute,
for each power of two that is no greater than N, the shortest path
between
every pair of nodes that has a length of that power of two. This can be
done
using a method similar to Floyd-Warshall in O(T<sup>3</sup> log N)
time. (See
the code below for more details.)<p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>After
we compute the shortest paths mentioned above, we can compute shortest
paths,
of length N, from S to every other node. We do this by breaking N up
into its
binary representation, and for each power of two that occurs, we
compute
shortest paths after adding in paths of length equal to this power.
This can be
done in O(T<sup>2</sup> log N) time. (Again, see the code below for
more
details.) Thus, our overall runtime is O(T<sup>3</sup> log N).<p></p></span></p>
<pre style="text-align: justify;">#include &lt;cstdio&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;cstring&gt;<p></p></pre>
<pre style="text-align: justify;">using namespace std;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">FILE *fout = fopen ("relays.out", "w");<p></p></pre>
<pre style="text-align: justify;">FILE *fin = fopen ("relays.in", "r");<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">const int INF = 1000000000;<p></p></pre>
<pre style="text-align: justify;">const int MAXV = 105;<p></p></pre>
<pre style="text-align: justify;">const int MAXI = 1005;<p></p></pre>
<pre style="text-align: justify;">const int MAXL = 20;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int N, V, T, S, E;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">// compress nodes to smaller values<p></p></pre>
<pre style="text-align: justify;">int change [MAXI];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">// shortest path between two nodes with a length of a power of two<p></p></pre>
<pre style="text-align: justify;">int dist [MAXL][MAXV][MAXV];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">// best path from S to a node<p></p></pre>
<pre style="text-align: justify;">int best [MAXV], best2 [MAXV];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">// change a node to a 'compressed' value<p></p></pre>
<pre style="text-align: justify;">inline void check (int &amp;ind)<p></p></pre>
<pre style="text-align: justify;">{<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (change [ind] == -1)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>change [ind] = V++;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>ind = change [ind];<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"> <p></p></pre>
<pre style="text-align: justify;">int main () {<p></p></pre>
<pre style="text-align: justify;">// initialize arrays<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>memset (change, -1, sizeof (change));<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>memset (dist, 63, sizeof (dist));<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>memset (best, 63, sizeof (best));<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fin, "%d %d %d %d", &amp;N, &amp;T, &amp;S, &amp;E);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>check (S);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>check (E);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int i = 0; i &lt; T; i++) {<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int A, B, L;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fscanf (fin, "%d %d %d", &amp;L, &amp;A, &amp;B);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>check (A);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>check (B);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">// edges are paths of length 1<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>dist [0][A][B] &lt;?= L;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>dist [0][B][A] &lt;?= L;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">// compute shortest paths whose lengths are powers of two<p></p></pre>
<pre style="text-align: justify;">// a path of length 2^p can be made by two paths of length 2^(p - 1)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int p = 1; (1 &lt;&lt; p) &lt;= N; p++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int i = 0; i &lt; V; i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int j = 0; j &lt; V; j++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (dist [p - 1][i][j] &lt; INF)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""></span>for (int k = 0; k &lt; V; k++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (dist [p - 1][i][j] + dist [p - 1][j][k] &lt; dist [p][i][k])<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>dist [p][i][k] = dist [p - 1][i][j] + dist [p - 1][j][k];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">// combine results of each power of two in the binary representation of N<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>best [S] = 0;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int p = 0; (1 &lt;&lt; p) &lt;= N; p++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (N &amp; (1 &lt;&lt; p)) {<p></p></pre>
<pre style="text-align: justify;">// use a temporary array 'best2' to hold the new values, and copy them to the old array afterward<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>memset (best2, 63, sizeof (best2));<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int i = 0; i &lt; V; i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (best [i] &lt; INF)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for (int j = 0; j &lt; V; j++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>if (best [i] + dist [p][i][j] &lt; best2 [j])<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>best2 [j] = best [i] + dist [p][i][j];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>memcpy (best, best2, sizeof (best2));<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">// best [E] is now the shortest path from S to E using N edges<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>fprintf (fout, "%d\n", best [E]);<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return 0;<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<h3>
<a name="_Toc188248262">Sunscreen [Russ Cox, 2001]</a><p></p>
</h3>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>To
avoid unsightly burns while tanning, each of the C (1 &lt;= C &lt;=
2500) cows
must cover her hide with sunscreen when they're at the beach. Cow i has
a
minimum and maximum SPF rating (1 &lt;= minSPF_i &lt;= 1,000; minSPF_i
&lt;=
maxSPF_i &lt;= 1,000) that will work. If the SPF rating is too low, the
cow suffers
sunburn; if the SPF rating is too high, the cow doesn't tan at all.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>The
cows have a picnic basket with L (1 &lt;= L &lt;= 2500) bottles of
sunscreen
lotion, each bottle i with an SPF rating SPF_i (1 &lt;= SPF_i &lt;=
1,000).
Lotion bottle i can cover cover_i cows with lotion. A cow may lotion
from only
one bottle.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>What
is the maximum number of cows that can protect themselves while tanning
given
the available lotions?<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>PROBLEM
NAME: tanning<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Line 1: Two space-separated integers: C and L<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines 2..C+1: Line i describes cow i's lotion requires with two <span style=""></span>integers:
minSPF_i and maxSPF_i<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>*
Lines C+2..C+L+1: Line i+C+1 describes a sunscreen lotion bottle I <span style=""></span>with
space-separated integers: SPF_i
and cover_i<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
INPUT (file tanning.in):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
10<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2
5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>1
5<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>6
2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>4
1<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>INPUT
DETAILS:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>3
cows; 2 lotions.<span style=""> </span>Cows want SPF ratings
of 3..10, 2..5, and 1..5. Lotions<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>available:
6 (for two cows), 4 (for 1 cow).<span style=""> </span>Cow 1
can use the SPF 6 lotion.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>Either
cow 2 or cow 3 can use the SPF 4 lotion.<span style="">
</span>Only 2 cows can be covered.<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>OUTPUT
FORMAT:<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>A
single line with an integer that is the maximum number of cows that<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>can
be protected while tanning<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>SAMPLE
OUTPUT (file tanning.out):<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'>2<p></p></span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>This
problem is solvable by a simple greedy algorithm: consider the bottles
of
sunscreen in increasing order of SPF, and assign each one (if possible)
to the
cow having the lowest maxSPF rating. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Why
does this give an optimal solution? Let B denote a bottle of sunscreen
with the
lowest SPF rating. If no cow is compatible with B, then clearly B
cannot be
assigned in any solution, so we can ignore B. Otherwise, let C be the
cow
having lowest maxSPF rating that is compatible with B. We claim that
there is
always an optimal solution in which C is paired with B, so it is "safe"
to make this assignment as our algorithm progresses (i.e., it will
never make a
wrong decision and end up in a situation where an optimal solution is
no longer
reachable). To see this, suppose there is an optimal solution S where C
is
_not_ paired with B, and consider a few cases: <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>(i)
C and B are both unassigned in S. This case cannot happen, since we
could
assign C with B and obtain an even better solution, contradicting the
optimality of S. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>(ii)
C is assigned in S but B is not. Here, by reassigning C to B, we obtain
an
equally-good solution in which C and B are assigned. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>(iii)
B is assigned in S but C is not. Same as (ii), only we reassign B. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>(iv)
C and B are both assigned in S. Let B' be the bottle assigned to C, and
C' be
the cow assigned to B. Here, you can check that it is valid to reassign
C with
B and C' with B', giving us an equally good assignment in which C and B
are
assigned. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Hence,
an optimal solution always exists in which C and B are paired, so it is
safe to
match them together. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>An
alternate, symmetric, solution to this problem is the following:
process the
cows in increasing order of maxSPF, and for each cow C in sequence,
assign C to
the minimum SPF bottle compatible with C. The analysis of this approach
follows
essentially the same reasoning as above. <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>In
terms of running time, one can implement either of the two algorithms
above in
O(n log n) time. One way to do this is the following (in the case of
the first
algorithm above): We first sort the bottles by SPF rating and the cows
by
minSPF rating. We then scan the bottles in order and maintain a
min-heap on the
cows (keyed on maxSPF) with minSPF lower than the SPF of our current
bottle.
For each bottle B in order, we match it with the minimum cow from the
heap
(after first removing any cows from the heap having maxSPF less than
the SPF of
B). <p></p></span></p>
<p style="text-align: justify;"><span style='font-size: 10pt; font-family: "Courier New";'>Here
is a sample C++ solution written by Richard Peng: <p></p></span></p>
<pre style="text-align: justify;">#include &lt;cstdio&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;cstring&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;cstdlib&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;algorithm&gt;<p></p></pre>
<pre style="text-align: justify;">#include &lt;queue&gt;<p></p></pre>
<pre style="text-align: justify;">using namespace std;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">#define MAXN 20000<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int n,m,ans;<p></p></pre>
<pre style="text-align: justify;">pair&lt;int,int&gt; cow[MAXN],lotion[MAXN];<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">priority_queue&lt;int&gt; q;<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">void process(){<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int i,i1;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while(!q.empty()) q.pop();<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>sort(cow,cow+n);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>sort(lotion,lotion+m);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for(ans=i=i1=0;i&lt;m;i++){<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while((i1&lt;n)&amp;&amp;(cow[i1].first&lt;=lotion[i].first))<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>q.push(-cow[i1++].second);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while((!q.empty())&amp;&amp;(-(q.top())&lt;lotion[i].first))<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>q.pop();<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>while((!q.empty())&amp;&amp;(lotion[i].second--)){<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>ans++;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>q.pop();<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>}<p></p></pre>
<pre style="text-align: justify;">}<p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;"><p></p></pre>
<pre style="text-align: justify;">int main(){<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>int i,j;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>freopen("tanning.in","r",stdin);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>freopen("tanning.out","w",stdout);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>scanf("%d%d",&amp;n,&amp;m);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for(i=0;i&lt;n;i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span><span style=""></span>scanf("%d%d",&amp;cow[i].first,&amp;cow[i].second);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>for(i=0;i&lt;m;i++)<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>scanf("%d%d",&amp;lotion[i].first,&amp;lotion[i].second);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>ans=0;<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>process();<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>printf("%d\n",ans);<p></p></pre>
<pre style="text-align: justify;"><span style=""> </span>return 0;<p></p></pre>
<pre style="text-align: justify;">} <p></p></pre>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; text-align: justify; line-height: normal;"><span style='font-size: 10pt; font-family: "Courier New";'><p></p></span></p>
<p class="MsoNormal" style="text-align: justify;"><b><span style='font-size: 16pt; line-height: 115%; font-family: "Courier New";'><p></p></span></b></p>
</div>
</body>
</html>
