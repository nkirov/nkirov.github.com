<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta name="Author" content="Nikolay Kirov">
   <meta name="GENERATOR" content="Mozilla/4.75 [en] (Win98; U) [Netscape]">
   <title>l07</title>
</head>
<body>
<b>7. Разделяй и владей - бързо умножение на дълги числа [7.7] - <font color="#990000">18.11.2003</font></b><b><font color="#990000"></font></b>
<p><font color="#000000">* Класическият алгоритъм за умножение на цели
числа има сложност <i>O</i>(<i>n</i><sup>2</sup>).</font>
</p>
<p><font color="#000000">* Алгоритъм за умножение на две <i>n</i>-цифрени
числа <i>X</i> и <i>Y</i>, като <i>n</i> е степен на 2.</font>
</p>
<center>
<font color="#000000"><i>X = </i>2<sup><i>n</i>/2</sup> <i>A +
B</i>,    <i>Y = </i>2<sup><i>n</i>/2</sup> <i>C + D</i></font>
<br><font color="#000000"><i>XY = </i>2<i><sup>n</sup></i> <i>AC + </i>2<sup><i>n</i>/2</sup>
[(<i>A - B</i>)(<i>D - C</i>) <i>+ AC + BD</i>]<i> + BD</i></font>
</center>
Числата <i>A, B, C</i> и <i>D</i> са <i>n</i>/2 цифрени числа (разделяй)
- може да се използва рекурсия, като тривиалния случай е (директно) умножение
на едноцифрени числа.
<p>* Тази формула изисква 3 умножения, 6 събирания и 2 премествания вляво
(умножения на степени на 2). От рекурентната формула
</p>
<center>
<i>T</i>(1) = 1,  <i>T</i>(<i>n</i>) = 3<i>T</i>(<i>n</i>/2)
+ <i>cn</i>, <i>n &gt;</i> 0</center>
получаваме, че сложността на алгоритъма е <font color="#000000"><i>O</i>(<i>n<sup>r</sup></i>),
<i>r
= </i>log<sub>2</sub>3. Тъй като log<sub>2</sub>3 &lt; 2, то този алгоритъм
е по-добър от класическия.</font>
<p><font color="#000000">* Пример 1: 15 x 8 = 120,  <i>X</i> = 15
= 1111<sub>2</sub></font>, <i> Y</i> = 8 = 1000<sub><font color="#000000">2</font></sub>,
<i>n</i>
= 4 = 2<sup>2</sup>
<br><i> A = </i>11, <i>B =</i> 11, <i>C =</i> 10, <i>D =</i> 00
<br><font color="#000000"> <i>AC = </i>110, <i> </i>(<i>A - B</i>)(<i>D
- C</i>) = 0.10 = 0, <i>BD = </i>0</font>
<br><font color="#000000"><i> XY =</i> 110 &lt;&lt; 4 + 110 &lt;&lt;
2 = 1100000 + 11000 = 1111000<sub>2</sub> = 8+16+32+64 = 120<sub>10</sub></font>
</p>
<p>* Когато числата са с различен брой цифри и/или този брой не е степен
на 2, допълваме отляво с незначещи нули и използваме горния алгоритъм.
</p>
<p>* Пример 2. 50 x 25 = 1250, <font color="#000000"><i>X</i> = 50 = 110010<sub>2</sub></font>, <i>
Y</i> = 25 = 11001<sub><font color="#000000">2</font></sub>, <i>n</i> =
8 = 2<sup>4</sup> с допълване до най-близката степен на 2.
<br><i> A = </i>0011 (3), <i>B =</i> 0010 (2), <i>C =</i> 0001 (1),
<i>D
=</i> 1001 (9)
<br><font color="#000000"> <i>AC = </i>0011 (3), <i> </i>(<i>A
- B</i>)(<i>D - C</i>) = 0001.1000 = 1000 (8), <i>BD = </i>10010 (18)</font>
<br><font color="#000000"><i> XY =</i> 3.256 + (8 + 3 + 18).16 + 18
=</font>
<br><font color="#000000">         
11 &lt;&lt; 8 + 11101 &lt;&lt; 4 = 11 0000 0000 + 1 1101 0000 + 10010 =
10011100010<sub>2</sub> =</font>
<br><font color="#000000">         
2+32+64+128+1024 = 1250<sub>10</sub></font>
<br>* Подзадачи:
<br>  - представяне на дълги числа (низ или вътрешно);
<br>  - брой на битовете на цяло число;
<br>  - разделяне на десните от левите битове на числото;
<br>  - сума и разлика на две числа.
<br>Пример: <a href="sum_str.cpp">Сума на две числа, записани като C-низове.</a>
</p>
<p>
</p>
<hr width="100%">
</body>
</html>
