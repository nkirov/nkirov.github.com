<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;
      charset=windows-1251">
    <meta name="Author" content="Nikolay Kirov">
    <meta name="GENERATOR" content="Mozilla/4.75 [en] (Win98; U)
      [Netscape]">
    <title>l12</title>
  </head>
  <body>
    <center>
      <h3> <b>12. Предефиниране на оператори</b></h3>
    </center>
    <img alt="" src="../b5.gif" height="18" width="20">&nbsp;
    Предефиниране на операции. <br>
    &nbsp;&nbsp;&nbsp; Даване на ново значение на операция се нарича
    предефиниране (operator overloading). Операциите се предефинират за
    аргумети - обекти от даден клас, като типът на поне един от
    аргументите на бинарна операция трябва да е клас. <br>
    <b><tt><font color="#000099">// overload.cpp</font></tt></b> <br>
    <b><tt><font color="#000099">#include &lt;iostream&gt;</font></tt></b>
    <br>
    <b><tt><font color="#000099">using namespace std;</font></tt></b> <br>
    <b><tt><font color="#000099">#include "ccc_time.cpp"</font></tt></b>
    <p><b><tt><font color="#000099">/* Предефиниране на бинарна операция
            - с аргументи от клас Time и стойност от тип long */</font></tt></b>
      <br>
      <b><tt><font color="#000099">long operator-(Time a, Time b)</font></tt></b>
      <br>
      <b><tt><font color="#000099">/* ЦЕЛ: пресмята броя на секундите
            между два момента от време</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ПОЛУЧАВА: a, b - два
            момента от време</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ВРЪЩА: броя на секундите
            между a и b</font></tt></b> <br>
      <b><tt><font color="#000099">*/</font></tt></b> <br>
      <b><tt><font color="#000099">{&nbsp; return
            a.seconds_from(b);&nbsp;&nbsp; }</font></tt></b> </p>
    <p><b><tt><font color="#000099">/* Предефиниране на бинарна операция
            + с аргументи от клас Time и тип long и стойност от</font></tt></b>
      <br>
      <b><tt><font color="#000099">клас Time */</font></tt></b> <br>
      <b><tt><font color="#000099">Time operator+(Time a, long sec)</font></tt></b>
      <br>
      <b><tt><font color="#000099">/* ЦЕЛ: пресмята момент от време,
            отдалечен на зададен брой секунди</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ПОЛУЧАВА: a - момент от
            време</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ВРЪЩА: броя на секундите</font></tt></b>
      <br>
      <b><tt><font color="#000099">*/</font></tt></b> <br>
      <b><tt><font color="#000099">{&nbsp; Time r = a;</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; r.add_seconds(sec);</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; return r;&nbsp; }</font></tt></b>
    </p>
    <p><b><tt><font color="#000099">/* Предефиниране на бинарна операция
            == с аргументи от клас Time и стойност от тип bool */</font></tt></b>
    </p>
    <p><b><tt><font color="#000099">bool operator==(Time a, Time b)</font></tt></b>
      <br>
      <b><tt><font color="#000099">/* ЦЕЛ: сравнява два момента от време</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ПОЛУЧАВА: a, b - два
            момента от време</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ВРЪЩА: true - ако те са
            равни</font></tt></b> <br>
      <b><tt><font color="#000099">*/</font></tt></b> <br>
      <b><tt><font color="#000099">{&nbsp; return a.seconds_from(b) ==
            0;&nbsp; }</font></tt></b> </p>
    <p><b><tt><font color="#000099">/* Предефиниране на бинарна операция
            != с аргументи от клас Time и стойност от тип bool */</font></tt></b>
    </p>
    <p><b><tt><font color="#000099">bool operator!=(Time a, Time b)</font></tt></b>
      <br>
      <b><tt><font color="#000099">/* ЦЕЛ: сравнява два момента от време</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ПОЛУЧАВА: a, b - два
            момента от време</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ВРЪЩА: true - ако те не
            са равни</font></tt></b> <br>
      <b><tt><font color="#000099">*/</font></tt></b> <br>
      <b><tt><font color="#000099">{&nbsp; return a.seconds_from(b) !=
            0;&nbsp; }</font></tt></b> </p>
    <p><b><tt><font color="#000099">/* Предефиниране на бинарна операция
            &lt;&lt; с аргументи от клас ostream и клас Time и стойност</font></tt></b>
      <br>
      <b><tt><font color="#000099">от тип ostream */</font></tt></b> <br>
      <b><tt><font color="#000099">ostream &amp;operator&lt;&lt;(ostream
            &amp;out, const Time &amp;a)</font></tt></b> <br>
      <b><tt><font color="#000099">/* ЦЕЛ: отпечатва обект от тип Time</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ПОЛУЧАВА: out - изходен
            поток</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
a


            - момент от време</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ВРЪЩА: out</font></tt></b>
      <br>
      <b><tt><font color="#000099">*/</font></tt></b> <br>
      <b><tt><font color="#000099">{&nbsp; out &lt;&lt; a.get_hours()
            &lt;&lt; ":";</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; if (a.get_minutes() &lt;
            10) out &lt;&lt; "0";</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; out &lt;&lt;
            a.get_minutes() &lt;&lt; ":";</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; if (a.get_seconds() &lt;
            10) out &lt;&lt; "0";</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; out &lt;&lt;
            a.get_seconds();</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; return
            out;&nbsp;&nbsp;&nbsp; }</font></tt></b> </p>
    <p><b><tt><font color="#000099">/* Предефиниране на унарна операция
            - префиксна форма на ++ с аргумент от клас</font></tt></b> <br>
      <b><tt><font color="#000099">Time и стойност от клас Time */</font></tt></b>
      <br>
      <b><tt><font color="#000099">Time operator++(Time &amp;a)</font></tt></b>
      <br>
      <b><tt><font color="#000099">/* ЦЕЛ: добавя към момент от време 1
            секунда</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ПОЛУЧАВА: a - момент от
            време</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ВРЪЩА: новият момент от
            време и променя a</font></tt></b> <br>
      <b><tt><font color="#000099">*/</font></tt></b> <br>
      <b><tt><font color="#000099">{ a = a + 1; return a; }</font></tt></b>
    </p>
    <p><b><tt><font color="#000099">/* Предефиниране на унарна операция
            - постфиксна форма на ++ с аргумент от клас</font></tt></b>
      <br>
      <b><tt><font color="#000099">Time и стойност от клас Time */</font></tt></b>
      <br>
      <b><tt><font color="#000099">Time operator++(Time &amp;a, int
            dummy)</font></tt></b> <br>
      <b><tt><font color="#000099">/* ЦЕЛ: добавя към момент от време 1
            минута</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ПОЛУЧАВА: a - момент от
            време</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; ВРЪЩА: непромененият
            момент от време и променя a</font></tt></b> <br>
      <b><tt><font color="#000099">*/</font></tt></b> <br>
      <b><tt><font color="#000099">{ Time b = a;</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp; a = a + 60; return b;</font></tt></b>
      <br>
      <b><tt><font color="#000099">}</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;</font></tt></b> <br>
      <b><tt><font color="#000099">int main()</font></tt></b> <br>
      <b><tt><font color="#000099">{&nbsp; Time now;</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; "Now it is
            " &lt;&lt; now &lt;&lt; "\n";</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; Time later = now + 1000;</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; "A
            thousand seconds later it is " &lt;&lt; later &lt;&lt; "\n";</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; Time now2;</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; if (now == now2)</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cout
            &lt;&lt; "It still is " &lt;&lt; now2 &lt;&lt; "\n";</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; if (now != now2)</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cout
            &lt;&lt; "It is already " &lt;&lt; now2 &lt;&lt; "\n";</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; "Another "
            &lt;&lt; later - now2 &lt;&lt; " seconds until "</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;&lt;


            later &lt;&lt; "\n";</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; now = Time();</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; "Now it is
            " &lt;&lt; now &lt;&lt; "\n";</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; "One
            second later " &lt;&lt; (++now) &lt;&lt; "\n";</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; "The same
            time " &lt;&lt; (now++);</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; " and 60
            seconds later " &lt;&lt; now &lt;&lt; "\n";</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; return 0;</font></tt></b>
      <br>
      <b><tt><font color="#000099">}</font></tt></b> <br>
      &nbsp;
      <table border="" cellpadding="4" width="100%">
        <tbody>
          <tr>
            <td><b><tt><font color="#993300">Now it is 11:42:51</font></tt></b>
              <br>
              <b><tt><font color="#993300">A thousand seconds later it
                    is 11:59:31</font></tt></b> <br>
              <b><tt><font color="#993300">It still is 11:42:51</font></tt></b>
              <br>
              <b><tt><font color="#993300">Another 1000 seconds until
                    11:59:31</font></tt></b> <br>
              <b><tt><font color="#993300">Now it is 11:42:51</font></tt></b>
              <br>
              <b><tt><font color="#993300">One second later 11:42:52</font></tt></b>
              <br>
              <b><tt><font color="#993300">The same time 11:42:52 and 60
                    seconds later 11:43:52</font></tt></b></td>
          </tr>
        </tbody>
      </table>
    </p>
    <p>Предефиниране на операции като член-функции на клас. <br>
      <b><tt><font color="#006600">bool operator!=(Iterator a, Iterator
            b); /* </font><font color="#000000">външна за класа функция
            */</font></tt></b> <br>
      <b><tt><font color="#006600">bool Iterator::operator!=(Iterator
            b);&nbsp;&nbsp; /* </font><font color="#000000">член-функция

            */</font></tt></b> </p>
    <p><b><tt><font color="#006600">string Iterator::operator*() const</font></tt></b>
      <br>
      <b><tt><font color="#006600">{&nbsp; assert(position != NULL);</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; return
            position-&gt;data;&nbsp; }</font></tt></b> </p>
    <p><b><tt><font color="#006600">void Iterator::operator++(int dummy)</font></tt></b>
      <br>
      <b><tt><font color="#006600">{&nbsp; assert(position != NULL);</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; position =
            position-&gt;next; }</font></tt></b> </p>
    <p><b><tt><font color="#006600">void Iterator::operator--(int dummy)</font></tt></b>
      <br>
      <b><tt><font color="#006600">{&nbsp; if (position == NULL)&nbsp;
            position = last;</font></tt></b> <br>
      <b><tt><font color="#006600">&nbsp;&nbsp;
            else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
position


            = position-&gt;previous;</font></tt></b> <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; assert(position !=
            NULL);&nbsp;&nbsp; }</font></tt></b> </p>
    <p><b><tt><font color="#006600">bool Iterator::operator!=(Iterator
            b) const</font></tt></b> <br>
      <b><tt><font color="#006600">{&nbsp; return position !=
            b.position;&nbsp;&nbsp; }</font></tt></b> </p>
    <p><b><tt><font color="#006600">bool Iterator::operator==(Iterator
            b) const</font></tt></b> <br>
      <b><tt><font color="#006600">{&nbsp; return position ==
            b.position;&nbsp;&nbsp; }</font></tt></b> <br>
    </p>
    <hr width="100%">
  </body>
</html>
