<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="Author" content="Nikolay Kirov">
    <meta name="GENERATOR" content="Mozilla/4.75 [en] (Win98; U)
      [Netscape]">
    <title>lec04</title>
  </head>
  <body>
    <center>
      <h3>Потоци I</h3>
    </center>
    <img alt="" src="../b5.gif" height="18" width="20"><span
      style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: auto; text-align: start; text-indent: 0px;
      text-transform: none; white-space: normal; widows: auto;
      word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px; display: inline !important; float:
      none;">Пренасочване на входния и изходния потоци (<a
        href="../../CITB100/slides/ch07/lecture_7b.html">преговор</a>)<span
        class="Apple-converted-space"></span></span><br style="color:
      rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: medium;
      font-style: normal; font-variant: normal; font-weight: normal;
      letter-spacing: normal; line-height: normal; orphans: auto;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: auto; word-spacing: 0px;
      -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">
    <b style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      letter-spacing: normal; line-height: normal; orphans: auto;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: auto; word-spacing: 0px;
      -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><tt><font
          color="#006600">&nbsp;&nbsp;&nbsp; C:\my\&gt;myprog &lt;
          a_cin.txt</font></tt></b><span style="color: rgb(0, 0, 0);
      font-family: 'Times New Roman'; font-size: medium; font-style:
      normal; font-variant: normal; font-weight: normal; letter-spacing:
      normal; line-height: normal; orphans: auto; text-align: start;
      text-indent: 0px; text-transform: none; white-space: normal;
      widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px; display: inline !important; float:
      none;"><span class="Apple-converted-space">&nbsp;</span></span><br
      style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: auto; text-align: start; text-indent: 0px;
      text-transform: none; white-space: normal; widows: auto;
      word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px;">
    &nbsp; <span style="color: rgb(0, 0, 0); font-family: 'Times New
      Roman'; font-size: medium; font-style: normal; font-variant:
      normal; font-weight: normal; letter-spacing: normal; line-height:
      normal; orphans: auto; text-align: start; text-indent: 0px;
      text-transform: none; white-space: normal; widows: auto;
      word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px; display: inline !important; float:
      none;">Вместо от клавиатурата, операционната система пренасочва
      входа от текстов файл, в случая това е файла<span
        class="Apple-converted-space">&nbsp;</span></span><b
      style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      letter-spacing: normal; line-height: normal; orphans: auto;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: auto; word-spacing: 0px;
      -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><tt><font
          color="#000000">a_cin.txt.&nbsp;</font></tt></b><span
      style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: auto; text-align: start; text-indent: 0px;
      text-transform: none; white-space: normal; widows: auto;
      word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px; display: inline !important; float:
      none;"><span class="Apple-converted-space"> </span></span><br
      style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: auto; text-align: start; text-indent: 0px;
      text-transform: none; white-space: normal; widows: auto;
      word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px;">
    <b style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      letter-spacing: normal; line-height: normal; orphans: auto;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: auto; word-spacing: 0px;
      -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><tt><font
          color="#006600">&nbsp;&nbsp;&nbsp; C:\my\&gt;myprog &gt;
          a_cout.txt</font></tt></b><span style="color: rgb(0, 0, 0);
      font-family: 'Times New Roman'; font-size: medium; font-style:
      normal; font-variant: normal; font-weight: normal; letter-spacing:
      normal; line-height: normal; orphans: auto; text-align: start;
      text-indent: 0px; text-transform: none; white-space: normal;
      widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px; display: inline !important; float:
      none;"><span class="Apple-converted-space">&nbsp;</span></span><br
      style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: auto; text-align: start; text-indent: 0px;
      text-transform: none; white-space: normal; widows: auto;
      word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px;">
    &nbsp; <span style="color: rgb(0, 0, 0); font-family: 'Times New
      Roman'; font-size: medium; font-style: normal; font-variant:
      normal; font-weight: normal; letter-spacing: normal; line-height:
      normal; orphans: auto; text-align: start; text-indent: 0px;
      text-transform: none; white-space: normal; widows: auto;
      word-spacing: 0px; -webkit-text-size-adjust: auto;
      -webkit-text-stroke-width: 0px; display: inline !important; float:
      none;">Вместо на екрана, операционната система пренасочва изхода
      на текстов файл, в случая това е файла<span
        class="Apple-converted-space">&nbsp;</span></span><b
      style="color: rgb(0, 0, 0); font-family: 'Times New Roman';
      font-size: medium; font-style: normal; font-variant: normal;
      letter-spacing: normal; line-height: normal; orphans: auto;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: auto; word-spacing: 0px;
      -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><tt><font
          color="#009900">a_cout.txt.</font></tt></b><span style="color:
      rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: medium;
      font-style: normal; font-variant: normal; font-weight: normal;
      letter-spacing: normal; line-height: normal; orphans: auto;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: auto; word-spacing: 0px;
      -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;
      display: inline !important; float: none;"><span
        class="Apple-converted-space"> </span></span><br>
    <i>Пример:</i> Четене на думи.<br>
    <pre style="color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><tt><b><font color="#000080">// <a href="../../NETB101/sources/ch7/words.cpp">words.cpp</a><br>#include</font></b> <font color="#FF0000">&lt;iostream&gt;
</font><b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;string&gt;
</font><b><font color="#0000FF">using</font></b> <b><font color="#0000FF">namespace</font></b> std<font color="#990000">;

</font><font color="#009900">int</font> <b><font color="#000000">main</font></b><font color="#990000">()
</font><font color="#FF0000">{</font>&nbsp; <font color="#009900">int</font> count <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;
</font>&nbsp;&nbsp; string word<font color="#990000">;
</font>&nbsp;&nbsp; <b><font color="#0000FF">while</font></b> <font color="#990000">(</font>cin <font color="#990000">&gt;&gt;</font> word<font color="#990000">)</font> count<font color="#990000">++;

</font>&nbsp;&nbsp; cout <font color="#990000">&lt;&lt;</font> count <font color="#990000">&lt;&lt;</font> <font color="#FF0000">" words.\n"</font><font color="#990000">;
</font>&nbsp;&nbsp; <b><font color="#0000FF">return</font></b> <font color="#993399">0</font><font color="#990000">;<br>}</font></tt><br><span style="color:
      rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: medium;
      font-style: normal; font-variant: normal; font-weight: normal;
      letter-spacing: normal; line-height: normal; orphans: auto;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: auto; word-spacing: 0px;
      -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;
      display: inline !important; float: none;">С пренасочване на входа програмата <tt>words</tt> за намиране на броя на думите може намери броя на думите в текстов
      файл (едно по-смислено приложение на тази програма).<span class="Apple-converted-space"></span></span></pre>
    <i>Пример:</i> Четене на редове<font color="#990000">:<br>
      <pre><b>// <a href="../../NETB101/sources/ch7/lines.cpp">lines.cpp</a><br>#include &lt;iostream&gt;<br>#include &lt;string&gt;<br>using namespace std;<br><br>int main()<br>{  int count = 0;<br>   string lines;<br>   while (getline(cin, lines)) count++;<br>   cout &lt;&lt; count &lt;&lt; " lines.\n";<br>   return 0;<br>}</b></pre>
    </font><i>Пример:</i> Четене на символи (букви, цифри и специални
    символи)<font color="#990000">:<br>
    </font>
    <pre><font color="#990000"><b>// <a href="../../NETB101/sources/ch7/chars.cpp">chars.cpp</a><br>#include &lt;iostream&gt;<br>using namespace std;<br><br>int main()<br>{  int count = 0;<br>   char ch;<br>   while (cin.get(ch)) count++;<br>   cout &lt;&lt; count &lt;&lt; " chars.\n";<br>   return 0;<br>}<br></b></font></pre>
    <hr size="2" width="100%">
    <p><img alt="" src="../b5.gif" height="18" width="20"> Четене и
      запис в текстови файлове. <br>
      ** В заглавния файл <b><tt><font color="#000000">fstream</font></tt></b>
      са дефинирани обекти, функции и операции за работа с файлове. <br>
      А) Четене от файл. <br>
      * Дефиниране на файлова променлива за четене - обект от класа <b><tt><font
            color="#006600">ifstream:</font></tt></b> <br>
      <b><tt><font color="#006600">&nbsp;&nbsp;&nbsp; ifstream inp_data;</font></tt></b>
      <br>
      * Отваряне на файл от текущата директория с име <b><tt><font
            color="#006600">input.dat:</font></tt></b> <br>
      <b><tt><font color="#006600">&nbsp;&nbsp;&nbsp;
            inp_data.open("input.dat");</font></tt></b> <br>
      * Четене от файл на: <br>
      &nbsp;- цели числа и числа с плаваща точка <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; int n;</font></tt></b> <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; double x;</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; inp_data &gt;&gt; n
            &gt;&gt; x;</font></tt></b> <br>
      &nbsp;- низове <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; string s;</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; inp_data &gt;&gt;
            s;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // чете до
            разделител</font></tt></b> <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; getline(inp_data, s); //
            чете цял ред</font></tt></b> <br>
      &nbsp;- символи <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; char ch;</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp;
            inp_data.get(ch);&nbsp;&nbsp;&nbsp; // чете един символ</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp;
            inp_data.unget();&nbsp;&nbsp;&nbsp; // връща последния
            прочетен символ в буфера</font></tt></b> <br>
      * затваряне на файл <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; inp_data.close();</font></tt></b>
    </p>
    <p><i>Пример:</i> Четене и писане на различни типове данни.<br>
    </p>
    <p> <b><tt><font color="#000099">// <a
              href="../../../2014/NETB151/sources/ch12/readf.cpp">readf.cpp</a></font></tt></b>
      <br>
      <b><tt><font color="#000099">#include &lt;iostream&gt;</font></tt></b>
      <br>
      <b><tt><font color="#000099">#include
            &lt;fstream&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/*






















            включване на заглавен файл */</font></tt></b> <br>
      <b><tt><font color="#000099">#include &lt;string&gt;</font></tt></b>
      <br>
      <b><tt><font color="#000099">using namespace std;</font></tt></b>&nbsp;</p>
    <p> <b><tt><font color="#000099">int main()</font></tt></b> <br>
      <b><tt><font color="#000099">{&nbsp; ifstream in_data; /*
            дефиниране на файлова променлива за четене */</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp;
            in_data.open("readf.txt");&nbsp; /* отваряне на файла
            readf.txt */</font></tt></b> </p>
    <p><b><tt><font color="#000099">&nbsp;&nbsp; string s1, s2;</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; getline(in_data,
            s1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* четене на ред */</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; in_data &gt;&gt;
            s2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/*






















            четене на дума */</font></tt></b> </p>
    <p><b><tt><font color="#000099">&nbsp;&nbsp; int n;</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; double x;</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; in_data &gt;&gt; n
            &gt;&gt;
            x;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /*
            четене на числови данни */</font></tt></b> </p>
    <p><b><tt><font color="#000099">&nbsp;&nbsp; char ch;</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; while (!in_data.eof())</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            in_data.get(ch);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            /* четене на символ */</font></tt></b> </p>
    <p><b><tt><font color="#000099">&nbsp;&nbsp;
            in_data.close();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/*






















            затваряне на файла */</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; cout &lt;&lt; s1
            &lt;&lt; endl &lt;&lt; s2 &lt;&lt; " "</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;&lt;






















            n &lt;&lt; " " &lt;&lt; x &lt;&lt; " " &lt;&lt; ch &lt;&lt;
            endl;</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; return 0;</font></tt></b>
      <br>
      <b><tt><font color="#000099">}</font></tt></b> <br>
      <font color="#000000">Файл </font><b><tt><font color="#000099">readf.txt:</font></tt></b>
    </p>
    <table bgcolor="#CCCCCC" border="" cellpadding="4">
      <tbody>
        <tr>
          <td> <b><tt><font color="#000000">many happy words</font></tt></b>
            <br>
            <b><tt><font color="#000000">one_word&nbsp; 123&nbsp;
                  9.98&nbsp; N</font></tt></b> </td>
        </tr>
      </tbody>
    </table>
    <table border="" cellpadding="4" width="100%">
      <tbody>
        <tr>
          <td> <b><tt><font color="#993300">many happy words</font></tt></b>
            <br>
            <b><tt><font color="#993300">one_word&nbsp; 123&nbsp;
                  9.98&nbsp; N</font></tt></b> </td>
        </tr>
      </tbody>
    </table>
    <p><i>Пример:</i><i><tt> </tt></i>Четене на числа от файл, намиране
      и отпечатване на най-голямото число.</p>
    <p><tt> // <a href="../../../2014/NETB151/sources/ch12/maxval1.cpp">maxval1.cpp</a><br>
        #include &lt;string&gt;</tt><tt><br>
      </tt><tt>#include &lt;iostream&gt;</tt><tt><br>
      </tt><tt>#include &lt;fstream&gt;</tt><tt><br>
      </tt><tt>using namespace std;</tt><tt><br>
      </tt><tt><br>
      </tt><tt>/**</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; Reads numbers from a file and finds the
        maximum value</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; @param in the input stream to read from</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; @return the maximum value or 0 if the file
        has no numbers</tt><tt><br>
      </tt><tt>*/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;



      </tt><tt><br>
      </tt><tt>double read_data(ifstream&amp; in)</tt><tt><br>
      </tt><tt>{&nbsp; double highest;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; double next;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; if (in &gt;&gt; next) highest = next;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; else return 0;</tt><tt><br>
      </tt><tt><br>
      </tt><tt>&nbsp;&nbsp; while (in &gt;&gt; next)</tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp; if (next &gt; highest) highest =
        next;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; </tt><tt><br>
      </tt><tt>&nbsp;&nbsp; return highest;</tt><tt><br>
      </tt><tt>}</tt><tt><br>
      </tt><tt><br>
      </tt><tt>int main()</tt><tt><br>
      </tt><tt>{&nbsp; string filename;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; cout &lt;&lt; "Please enter the data file
        name: ";</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; cin &gt;&gt; filename;</tt><tt><br>
      </tt><tt><br>
      </tt><tt>&nbsp;&nbsp; ifstream infile;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; infile.open(filename.c_str());</tt><tt><br>
      </tt><tt><br>
      </tt><tt>&nbsp;&nbsp; if (infile.fail()) </tt><tt><br>
      </tt><tt>&nbsp;&nbsp; {&nbsp; cout &lt;&lt; "Error opening "
        &lt;&lt; filename &lt;&lt; "\n";</tt><tt><br>
      </tt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 1;</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; }</tt><tt><br>
      </tt><tt><br>
      </tt><tt>&nbsp;&nbsp; double max = read_data(infile);</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; cout &lt;&lt; "The maximum value is "
        &lt;&lt; max &lt;&lt; "\n";</tt><tt><br>
      </tt><tt><br>
      </tt><tt>&nbsp;&nbsp; infile.close();</tt><tt><br>
      </tt><tt>&nbsp;&nbsp; return 0;</tt><tt><br>
      </tt><tt>}</tt><br>
    </p>
    <i>Пример:</i> Отделяне на цифрови от текстови данни.
    <p><tt> //<b> </b><b><a
            href="../../../2014/NETB151/sources/ch12/readfile.cpp">readfile.cpp</a></b><b><br>
        </b><b>#include &lt;string&gt;</b></tt><b><tt><br>
        </tt></b><b><tt>#include &lt;iostream&gt;</tt></b><b><tt><br>
        </tt></b><b><tt>#include &lt;fstream&gt;</tt></b><b><tt><br>
        </tt></b><b><tt>using namespace std;</tt></b><b><tt><br>
        </tt></b><b><tt><br>
        </tt></b><b><tt>int main()</tt></b><b><tt><br>
        </tt></b><b><tt>{&nbsp; cout &lt;&lt; "Enter the file name: ";</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; string fname;</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; cin &gt;&gt; fname;</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; </tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; ifstream infile;</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; infile.open(fname.c_str());</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; if (infile.fail())</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; {&nbsp; cout &lt;&lt; "ERROR";</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
          1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; }</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; </tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; int sum = 0;</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; while (!infile.eof())</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; {&nbsp; char ch;</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; infile.get(ch);</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ('0' &lt;= ch
          &amp;&amp; ch &lt;= '9') /* it was a digit */</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;
          infile.unget(); /* oops - didn't want to read it */</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          int n;</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          infile &gt;&gt; n; /* read integer starting with ch */</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          sum += n;</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else cout
          &lt;&lt; ch; </tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; }</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; infile.close();</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; cout &lt;&lt; "The sum is "
          &lt;&lt; sum &lt;&lt; endl;</tt></b><b><tt><br>
        </tt></b><b><tt>&nbsp;&nbsp; return 0;</tt></b><b><tt><br>
        </tt></b><b><tt>}</tt></b><br>
      <br>
      Б) Писане във файл. <br>
      * дефиниране на файлова променлива за писане - обект от класа <b><tt><font
            color="#006600">ofstream:</font></tt></b> <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; ofstream out_data;</font></tt></b>
      <br>
      * отваряне на файл <br>
      <b><tt><font color="#006600">&nbsp;&nbsp;
            out_data.open("output.dat");</font></tt></b> <br>
      * писане във&nbsp; файл с: <br>
      &nbsp;- изходен поток <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; int n = 2;</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; double x = 1.5;</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; string s = " Hello";</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; out_data &lt;&lt; n
            &lt;&lt; "&nbsp; " &lt;&lt; x &lt;&lt; s;</font></tt></b> <br>
      &nbsp;- член-функция <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; char ch = 'A';</font></tt></b>
      <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; out_data.put(ch);</font></tt></b>
      <br>
      * затваряне на файл <br>
      <b><tt><font color="#006600">&nbsp;&nbsp; out_data.close();</font></tt></b>
    </p>
    <p><i>Пример:</i> Писане на различни типове данни.</p>
    <p> <b><tt><font color="#000099">// <a
              href="../../../2014/NETB151/sources/ch12/writef.cpp">writef.cpp</a></font></tt></b>
      <br>
      <b><tt><font color="#000099">#include &lt;iostream&gt;</font></tt></b>
      <br>
      <b><tt><font color="#000099">#include
            &lt;fstream&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/*






















            включване на заглавен файл */</font></tt></b> <br>
      <b><tt><font color="#000099">#include &lt;string&gt;</font></tt></b>
      <br>
      <b><tt><font color="#000099">using namespace std;</font></tt></b>
      <br>
      <b><tt><font color="#000099">int main()</font></tt></b> <br>
      <b><tt><font color="#000099">{&nbsp; ofstream out_data; /*
            дефиниране на файлова променлива за писане */</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp;
            out_data.open("writef.txt");&nbsp; /* отваряне на файла
            writef.txt */</font></tt></b> </p>
    <p><b><tt><font color="#000099">&nbsp;&nbsp; string s = "Hello";</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; out_data &lt;&lt; s
            &lt;&lt; endl; /* писане на низ */</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; int n = 5;</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; double x = 5.5;</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; out_data &lt;&lt; n
            &lt;&lt; " " &lt;&lt; x &lt;&lt; " "; /* писане на числови
            данни */</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; char ch = 'T';</font></tt></b>
      <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; out_data.put(ch); /*
            писане на символ */</font></tt></b> </p>
    <p><b><tt><font color="#000099">&nbsp;&nbsp;
            out_data.close();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/*






















            затваряне на файла */</font></tt></b> <br>
      <b><tt><font color="#000099">&nbsp;&nbsp; return 0;</font></tt></b>
      <br>
      <b><tt><font color="#000099">}</font></tt></b> <br>
      <font color="#000000">Файл </font><font color="#000000"><tt><b>writef.txt:</b></tt></font><tt>
      </tt> <tt> </tt><tt> </tt><tt> </tt> </p>
    <table bgcolor="#CCCCCC" border="" cellpadding="4">
      <tbody>
        <tr>
          <td> <b><font color="#000000">Hello</font></b><tt> </tt><br>
            <b><font color="#000000">5 5.5 T</font></b> </td>
        </tr>
      </tbody>
    </table>
    <br>
    <i>Пример:</i> Отделяне на цифрови от текстови данни и записване на
    числата във файл.<b><br>
    </b>
    <pre><b>// <a href="../../../2014/NETB151/sources/ch12/readwritefiles.cpp">readwritefiles.cpp</a><br>#include &lt;string&gt;
#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;

int main()
{  cout &lt;&lt; "Enter the input file name: ";
   string finame;
   cin &gt;&gt; finame;
   
   ifstream infile;
   infile.open(finame.c_str());
   if (infile.fail())
   {  cout &lt;&lt; "Error opening " &lt;&lt; finame &lt;&lt; endl;
      return 1;            
   }
   
   cout &lt;&lt; "Enter the output file name: ";
   string foname;
   cin &gt;&gt; foname;
   
   ofstream outfile;
   outfile.open(foname.c_str());
   if (outfile.fail())
   {  cout &lt;&lt; "Error opening " &lt;&lt; foname &lt;&lt; endl;;
      return 1;            
   }
   
   while (!infile.eof())
   {  char ch;
      infile.get(ch);
      if ('0' &lt;= ch &amp;&amp; ch &lt;= '9') /* it was a digit */
      {  infile.unget(); /* oops - didn't want to read it */
         int n;
         infile &gt;&gt; n; /* read integer starting with ch */
         outfile &lt;&lt; n &lt;&lt; endl;
      }
      else cout &lt;&lt; ch; 
   }
   infile.close();
   outfile.close();
   return 0;
}<br></b></pre>
    <hr size="2" width="100%">** Йерархия на потоковите класове<br>
    <p>* Потоковата библиотека на С++ се състои от няколко класове,
      свързани в следната йерархия:</p>
    <p><img alt=""
        src="../../../2014/NETB151/slides/ch12/images/stream_hierarchy.png"
        height="337" width="715"><br>
    </p>
    <p>* Обектите <font size="+1"><tt>cin</tt></font> и <font
        size="+1"><tt>cout </tt></font>са от класове, които са системно
      зависими и нямат стандартни имена, но са производни класове
      съответно на&nbsp; <font size="+1"><tt>istream</tt></font> и <font
        size="+1"><tt>ostream</tt></font>. Затова можем да дефинираме:<br>
    </p>
    <p><font size="+1"> </font></p>
    <pre><font size="+1">double read_data(istream&amp; in);</font></pre>
    <font size="+1"> </font>
    <p>и след това да извикаме функцията с параметри от различни
      производни на <font size="+1"><tt>istream</tt></font> класове: .<br>
    </p>
    <p><font size="+1"> </font></p>
    <pre><font size="+1">max = read_data(infile);<br>max = read_data(cin);</font></pre>
    <font size="+1"> </font>
    <p><i>Пример:</i> Четене на числа от файл или стандартен вход,
      намиране и отпечатване на най-голямото число. </p>
    <pre><b>// </b><b><a href="../../../2014/NETB151/sources/ch12/maxval2.cpp">maxval2.cpp</a></b><b><br></b><b>#include &lt;string&gt;
#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;

/**
   Reads numbers from a file and finds the maximum value
   @param in the input stream to read from
   @return the maximum value or 0 if the file has no numbers
*/            
double read_data(<font color="#993399">istream</font>&amp; in)
{  double highest;
   double next;
   if (in &gt;&gt; next) highest = next;
   else return 0;

   while (in &gt;&gt; next)
      if (next &gt; highest) highest = next;
   
   return highest;
}

int main()
{  double max;

   string input;
   cout &lt;&lt; "Do you want to read from a file? (y/n) ";
   cin &gt;&gt; input;

   if (input == "y")
   {  string filename;
      cout &lt;&lt; "Please enter the data file name: ";
      cin &gt;&gt; filename;

      ifstream infile;
      infile.open(filename.c_str());

      if (infile.fail()) 
      {  cout &lt;&lt; "Error opening " &lt;&lt; filename &lt;&lt; "\n";
         return 1;
      }

      max = read_data(<font color="#993399">infile</font>);
      infile.close();
   }
   else max = read_data(<font color="#993399">cin</font>);

   cout &lt;&lt; "The maximum value is " &lt;&lt; max &lt;&lt; "\n";
   return 0;
}</b></pre>
    <hr width="100%">
  </body>
</html>
