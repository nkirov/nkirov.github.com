<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>Chapter 9 bg</title>
  </head>
  <body>
    <h2> <b>Търсещи дървата - първа част</b><br>
    </h2>
    <big>Ще бъдат изучени няколко структури от данни, базирани на
      дървета за реализиране наредени речници. <br>
      Основните операции нареден речник АТД са:</big>
    <ul>
      <li> <big><span style="font-family: monospace;">find(<span
              style="font-style: italic;">k</span>)</span> - Връща
          позицията на елемент с ключ </big><big style="font-style:
          italic;"><span style="font-family: monospace;">k</span></big><big>
          или nullposition, ако няма такъв ключ. </big> </li>
      <li><big><span style="font-family: monospace;">findAll(<span
              style="font-style: italic;">k</span>)</span> - Връща
          позиционен итератор за всички обекти с ключ <span
            style="font-family: monospace; font-style: italic;">k</span>.
        </big></li>
      <li><big><span style="font-family: monospace;">insertItem(<span
              style="font-style: italic;">k</span>,<span
              style="font-style: italic;">e</span>)</span> - Вмъква
          обект (двойка) с елемент <span style="font-family: monospace;
            font-style: italic;">e</span> и ключ <span
            style="font-family: monospace; font-style: italic;">k</span>.</big></li>
      <li><big><span style="font-family: monospace;">removeElement(<span
              style="font-style: italic;">k</span>)</span> - Изтрива
          обект с ключ <span style="font-family: monospace; font-style:
            italic;">k</span>. Възниква грешка, ако няма такъв елемент.</big></li>
      <li><big><span style="font-family: monospace;">removeAllElements(<span
              style="font-style: italic;">k</span>)</span> - Изтрива
          всички обекти, чийто ключ е равен на <span
            style="font-family: monospace; font-style: italic;">k</span>.</big></li>
      <li><big><span style="font-family: monospace;">closestBefore(k)</span>-
          Връща позиция на обект с най-голям ключ, по-малък или равен на
          <span style="font-family: monospace;">k.</span></big></li>
      <li><big><span style="font-family: monospace;">closestAfter(k)</span>
          - Връща позиция на обект с най-малък ключ, по-голям или равен
          на <span style="font-family: monospace;">k.</span></big></li>
    </ul>
    <h3>Двоични дървета за търсене<br>
    </h3>
    <big> </big>
    <ul>
      <li><big>Двоично дърво за търсене е двоично дърво за съхранение на
          ключове (или двойки ключ-елемент) в своите вътрешни възли,
          които имат следното свойства:</big></li>
      <ul>
        <li><big>Нека <span style="font-style: italic;">u</span>, <span
              style="font-style: italic;">v</span> и <span
              style="font-style: italic;">w</span> са върхове на дървото
            такива, че&nbsp; <span style="font-style: italic;">u</span>
            е в лявото поддърво на <span style="font-style: italic;">v</span>
            и <span style="font-style: italic;">w</span> е в дясното
            поддърво на <span style="font-style: italic;">v</span>.<br>
            Тогава <span style="font-family: monospace;">key</span>(<span
              style="font-style: italic;">u</span>) ≤ <span
              style="font-family: monospace;">key</span>(<span
              style="font-style: italic;">v</span>) ≤ <span
              style="font-family: monospace;">key</span>(<span
              style="font-style: italic;">w</span>);</big></li>
        <li><big>Външните възли не съхраняват ключове.</big></li>
      </ul>
      <li><big>Inorder обхождане посещава ключовете на речника в
          ненамаляващ ред.</big></li>
    </ul>
    <img style="width: 373px; height: 176px;" alt="" src="pic1.jpg"><br>
    <big style="font-weight: bold;"><br>
      Търсене</big><big><br>
    </big>
    <ul>
      <li><big>За търсене на ключ <span style="font-style: italic;">k</span>,
          се върви по път надолу, тръгвайки от корена.<br>
        </big></li>
      <li><big>Следващ възел за посещение зависи от резултата от
          сравнението на <span style="font-style: italic;">k</span> с
          ключа в текущия възел.</big></li>
      <li><big>Ако се достигне листо, ключът не е намерен и се връща
          nullposition.</big></li>
    </ul>
    <table style="text-align: left; width: 334px; height: 201px;"
      border="1" cellpadding="2" cellspacing="0">
      <tbody>
        <tr>
          <td style="vertical-align: top;"><big><span
                style="font-weight: bold;">Algorithm</span> <span
                style="color: rgb(204, 0, 0);"><span style="font-style:
                  italic;">find </span>(<span style="font-style:
                  italic;">k</span>, <span style="font-style: italic;">v</span>)</span><br>
              &nbsp;&nbsp;&nbsp; if <span style="font-style: italic;
                color: rgb(0, 51, 51);">T.isExternal </span><span
                style="color: rgb(0, 51, 51);">(<span style="font-style:
                  italic;">v</span>)</span><br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span
                style="color: rgb(0, 51, 51);"><span style="font-style:
                  italic;">Position</span>(<span style="font-style:
                  italic;">null</span>)</span><br>
              &nbsp;&nbsp; if <span style="font-style: italic; color:
                rgb(0, 51, 51);">k</span><span style="color: rgb(0, 51,
                51);"> &lt; </span><span style="font-style: italic;
                color: rgb(0, 51, 51);">key</span><span style="color:
                rgb(0, 51, 51);">(</span><span style="font-style:
                italic; color: rgb(0, 51, 51);">v</span><span
                style="color: rgb(0, 51, 51);">)</span><br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span
                style="color: rgb(204, 0, 0);"><span style="font-style:
                  italic;">find</span>(<span style="font-style: italic;">k</span>,
                <span style="font-style: italic;">T.leftChild</span>(<span
                  style="font-style: italic;">v</span>))</span><br>
              &nbsp;&nbsp; else if <span style="color: rgb(0, 51, 51);"><span
                  style="font-style: italic;">k</span> = <span
                  style="font-style: italic;">key</span>(<span
                  style="font-style: italic;">v</span>)</span><br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span
                style="color: rgb(0, 51, 51);"><span style="font-style:
                  italic;">Position</span>(<span style="font-style:
                  italic;">v</span>)</span><br>
              &nbsp;&nbsp; else <span style="color: rgb(0, 51, 51);">{
                <span style="font-style: italic;">k</span> &gt; <span
                  style="font-style: italic;">key</span>(<span
                  style="font-style: italic;">v</span>) }</span><br>
              return <span style="color: rgb(0, 51, 51);"><span
                  style="font-style: italic; color: rgb(204, 0, 0);">find</span><span
                  style="color: rgb(204, 0, 0);">(</span><span
                  style="font-style: italic; color: rgb(204, 0, 0);">k</span><span
                  style="color: rgb(204, 0, 0);">, </span><span
                  style="font-style: italic; color: rgb(204, 0, 0);">T.rightChild</span><span
                  style="color: rgb(204, 0, 0);">(</span><span
                  style="font-style: italic; color: rgb(204, 0, 0);">v</span><span
                  style="color: rgb(204, 0, 0);">))</span></span><br>
            </big></td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li><big>Пример: <span style="font-family: monospace;">find(4)</span></big></li>
    </ul>
    <big> <img style="width: 390px; height: 185px;" alt=""
        src="pic2.jpg"><br>
      <br>
    </big>
    <ul>
      <li><big>Функцията<span style="font-family: monospace;"> find(k)</span>
          на речника <span style="font-style: italic;">D</span> се
          изпълнява за време <span style="font-style: italic;">O</span>(<span
            style="font-style: italic;">h</span>), където <span
            style="font-style: italic;">h</span> е височината на
          двоичното търсещо дърво <span style="font-style: italic;">T</span>,
          използвано за реализацията на <span style="font-style:
            italic;">D</span>.<span style="font-weight: bold;"></span></big></li>
    </ul>
    <ul>
    </ul>
    <h4><big> Операции за обновяване (актуализиране)<br>
      </big></h4>
    <big><span style="font-weight: bold;">Вмъкване</span><br>
    </big>
    <ul>
      <li><big>За да се изпълни операция <span style="font-family:
            monospace;">insertItem</span>(<span style="font-style:
            italic;">k</span>, <span style="font-style: italic;">e</span>),










          се търси с ключ <span style="font-style: italic;">k.</span></big></li>
      <li><big>Нека <span style="font-style: italic;">k</span> не е в
          дървото и нека <span style="font-style: italic;">w</span> е
          листото, достигнато при търсенето.</big></li>
      <li><big><font size="+1"><span style="font-style: italic;">k</span></font>
          се поставя във възел <span style="font-style: italic;">w</span>
          и <span style="font-style: italic;">w</span> се разширява до
          вътрешен възел (операция <a
            href="../ch06/6.30_LinkedBinaryTree.h-LinkedBinaryTree2.html"><font
              size="+1"><tt>expandExternal(w</tt></font>)</a> на двоично
          дърво АТД).</big></li>
    </ul>
    <big>Пример: insert 5</big>
    <table style="text-align: left; width: 100%;" border="0"
      cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top;"> <img style="width: 375px;
              height: 199px;" alt="" src="pic3.jpg"><br>
          </td>
          <td style="vertical-align: top;"> <img style="width: 396px;
              height: 227px;" alt="" src="pic4.jpg"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <big><br>
      <span style="font-weight: bold;">Изтриване</span><br>
    </big>
    <ul>
      <li><big><font size="+1">За да се изпълни операция</font> <span
            style="font-family: monospace;">removeElement</span>(<span
            style="font-style: italic;">k</span>), се търси с ключ <span
            style="font-style: italic;">k.</span></big></li>
      <li><big>Нека ключ <span style="font-style: italic;">k</span> е в
          дървото и нека <span style="font-style: italic;">v</span> е
          възелът, съхраняващ <span style="font-style: italic;">k.</span></big></li>
      <li><big>Ако възел <span style="font-style: italic;">v</span> има
          дете листо <span style="font-style: italic;">w</span>,
          изтриват се <span style="font-style: italic;">v</span> и <span
            style="font-style: italic;">w</span> от дървото&nbsp;
          (операция <a
            href="../ch06/6.30_LinkedBinaryTree.h-LinkedBinaryTree2.html"><span
              style="font-family: monospace;">removeAboveExternal</span>(<span
              style="font-style: italic;">w</span>)</a></big> <font
          size="+1">на двоично дърво АТД</font>).</li>
    </ul>
    <big>Пример: remove 4</big>
    <table style="text-align: left; width: 100%;" border="0"
      cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top;"> <img style="width: 394px;
              height: 227px;" alt="" src="pic5.jpg"><br>
          </td>
          <td style="vertical-align: top;"> <img style="width: 379px;
              height: 173px;" alt="" src="pic6.jpg"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <big>Нека ключът <span style="font-style: italic;">k</span> за
      изтриване се съхранява във възел <span style="font-style:
        italic;">v,</span> чийто деца са вътрешни възли.</big>
    <ul>
      <li><big>Намира се вътрешен възел <span style="font-style:
            italic;">w</span>, който следва <span style="font-style:
            italic;">v</span> в inorder обхождане на дървото.</big></li>
      <li><big>Копира се <span style="font-family: monospace;">key</span>(<span
            style="font-style: italic;">w</span>) във възела <span
            style="font-style: italic;">v.</span></big></li>
      <li><big>Изтрива се възел <span style="font-style: italic;">w</span>
          и неговото ляво дете<span style="font-style: italic;"> z</span>
          (което е листо) с операция <span style="font-family:
            monospace;">removeAboveExternal</span>(<span
            style="font-style: italic;">z</span>).</big></li>
    </ul>
    <big>Пример: remove 3<span style="font-weight: bold;"></span></big>
    <big><span style="font-weight: bold;"> </span></big>
    <table style="text-align: left; width: 100%;" border="0"
      cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top;"> <img style="width: 376px;
              height: 254px;" alt="" src="pic7.jpg"><br>
          </td>
          <td style="vertical-align: top;"> <img style="width: 380px;
              height: 189px;" alt="" src="pic8.jpg"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <big><span style="font-weight: bold;"><br>
        Най-добър и най-лош случай</span><br>
    </big>
    <ul>
      <li><big>Даден е речник с <span style="font-style: italic;">n</span>
          членове, реализиран като двоично търсещо дърво с височина <span
            style="font-style: italic;">h.</span></big></li>
      <ul>
        <li><big>Използваната памет е <span style="font-style: italic;">O</span>(<span
              style="font-style: italic;">n</span>).</big></li>
        <li><big>Методите <span style="font-family: monospace;">findElement()</span>,
            <span style="font-family: monospace;">insertItem()</span> и
            <span style="font-family: monospace;">removeElement()</span>
            отнемат време <span style="font-style: italic;">O</span>(<span
              style="font-style: italic;">h</span>).<br>
          </big></li>
      </ul>
      <li><big>Височината на дървото е <span style="font-style:
            italic;">O</span>(<span style="font-style: italic;">n</span>)
          в най-лошия случай и <span style="font-style: italic;">O</span>(log







          <span style="font-style: italic;">n</span>) в най-добрия
          случай.</big></li>
    </ul>
    <table style="text-align: left; width: 100%;" border="0"
      cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top;"> <img style="width: 339px;
              height: 238px;" alt="" src="add1.jpg"><br>
          </td>
          <td style="vertical-align: top;"> <img style="width: 426px;
              height: 189px;" alt="" src="add2.jpg"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <a href="https://www.youtube.com/watch?v=pYT9F8_LFTM"><big>Binary
        Search Tree</big></a><big> - лекция на английски</big><br>
    <p><a
href="http://video.mit.edu/watch/introduction-to-algorithms-lecture-5-binary-search-trees-bst-sort-14061/">Binary

        Search Trees, BST Sort </a>- лекция в MIT<br>
    </p>
    <h4><big>C++ реализация</big></h4>
    <big><span style="font-weight: bold;">A Binary Search Tree in C++<br>
      </span><a href="9.2_BinarySearchTree.h-Position.html">html-9.2</a>
      (Position)<br>
      <a href="9.3_BinarySearchTree.h-BST1.html">html-9.3</a> (BST1)<br>
      <a href="9.4_BinarySearchTree.h-BST2.html">html-9.4</a> (BST2)<br>
      <a href="9.5_BinarySearchTree.h-BST3.html">html-9.5</a> (BST3)<br>
      <a href="9.6_BinarySearchTree.h-BST4.html">html-9.6</a> (BST4)<br>
      <br>
      <a style="font-family: monospace;" href="except.h">except.h</a><span
        style="font-family: monospace;">&nbsp; - &nbsp; </span><a
        style="font-family: monospace;" href="LBTree.h">LBTree.h</a><span
        style="font-family: monospace;">&nbsp;&nbsp; - &nbsp; </span><a
        style="font-family: monospace;" href="BSTree.cpp">BSTree.cpp</a></big><br>
    <hr style="width: 100%; height: 2px;">
    <h3>AVL дървета</h3>
    <ul>
      <li> <big><span style="font-weight: bold;">Свойство височинен
            баланс (Height-Balance Property)</span>: За всеки вътрешен
          възел <span style="font-style: italic;">v</span> от <span
            style="font-style: italic;">T</span> </big><big>разликата
          във височините на децата му може да бъде най-много 1.</big> </li>
      <li> <big>AVL дърво е двоично търсещо дърво със свойството
          височинен баланс</big>.<br>
      </li>
      <li><big>Adel'son-Vel'skii and Landis (Адельсон-Вельский, Ландис -
          1968).</big></li>
      <li> <big>Един възел в <i>балансиран</i>, ако разликата във
          височините на децата му е най-много 1. </big><br>
      </li>
      <li><big><span style="font-style: italic;">Твърдение:</span>
          Височината на AVL дърво, съхраняващо <span style="font-style:
            italic;">n</span> ключове е <span style="font-style:
            italic;">O</span>(log <span style="font-style: italic;">n</span>).</big></li>
    </ul>
    <div style="text-align: center;"> <img style="width: 522px; height:
        391px;" alt="" src="avl01.jpg"><span style="font-style: italic;"></span><span
        style="font-style: italic;"></span><span style="font-style:
        italic;"></span><br>
    </div>
    <big><span style="font-weight: bold;">Вмъкване в AVL дърво<br>
      </span></big>
    <ul>
      <li><big><span style="font-family: monospace;">expandExternal</span>(<span
            style="font-style: italic;">w</span>)</big></li>
      <li><big>Нека <span style="font-style: italic;">z</span> е
          първият възел бъде първият небалансиран възел, който срещаме
          по пътя от <span style="font-style: italic;">w</span> към
          корена на <span style="font-style: italic;">T</span>.</big></li>
      <li><big>Нека <span style="font-style: italic;">y</span> означава
          детето на <span style="font-style: italic;">z</span> с
          по-голяма височина.</big></li>
      <li> <big>Нека <span style="font-style: italic;">x</span> е
          детето на <span style="font-style: italic;">y</span> с
          по-голяма височина</big><big>.</big> </li>
    </ul>
    <big><span style="font-weight: bold;">Тривъзелна реконструкция след
        вмъкване </span><br>
    </big>
    <ul>
      <li> <font size="+1"><tt>restructure(x)</tt></font><br>
      </li>
      <li><big>Нека (<span style="font-style: italic;">a, b, c</span>)
          са <span style="font-style: italic;">x, y, z</span> в
          редицата при inorder обхождане. Извършваме ротация такава, че
          <span style="font-style: italic;">b</span> да е най-горе в
          дървото.</big></li>
      <li><big><span style="font-style: italic;">Пример:</span><br>
        </big></li>
    </ul>
    <div style="text-align: center;"> <img style="width: 734px; height:
        465px;" alt="" src="avl02.jpg"><br>
    </div>
    <ul>
      <li><big>Има 4 възможни начина за изобразяване на&nbsp; (x, y, z)
          в (a, b, c).</big></li>
    </ul>
    <div style="text-align: center;"> <img style="width: 1070px;
        height: 479px;" alt="" src="avl03.jpg"><br>
    </div>
    <ul style="font-style: italic;">
      <li><big>Пример:</big></li>
    </ul>
    <div style="text-align: center;"> <img style="width: 897px; height:
        623px;" alt="" src="avl04.jpg"><br>
    </div>
    <br>
    <big style="font-weight: bold;">Премахване на възел от AVL дърво</big><br>
    <ul>
      <li><big><span style="font-family: monospace;">removeElement</span>(<span
            style="font-style: italic;">k</span>)</big></li>
      <li><big>Премахването започва в двоичното търсещо дърво, което
          означава, че премахнатия възел става (празен) външен възел.</big></li>
      <li><big>Неговият родител <span style="font-style: italic;">w</span>
          може да стане небалансиран възел.</big></li>
      <li style="font-style: italic;"><big>Пример:</big></li>
    </ul>
    <div style="text-align: center;"> <img style="width: 689px; height:
        411px;" alt="" src="av05.jpg"><br>
    </div>
    <br>
    <big><span style="font-weight: bold;">Ребалансиране след премахване</span><br>
    </big>
    <ul>
      <li><big>Нека <span style="font-style: italic;">z</span> е
          първият небалансиран възел <i>w</i> по пътя от <i>w</i> към
          корена на дървото. </big></li>
      <li><big>Нека <span style="font-style: italic;">y</span> е детето
          на <span style="font-style: italic;">z</span> с по-голяма
          височина. </big></li>
      <li><big>Нека <span style="font-style: italic;">x</span> е детето
          на <span style="font-style: italic;">y</span> с по-голяма
          височина.</big></li>
      <li><big>Изпълняваме операция <span style="font-family:
            monospace;">restructure</span>(<span style="font-style:
            italic;">x</span>) за да възстановим баланса на <span
            style="font-style: italic;">z</span>.</big></li>
      <li><big>Тъй като това преструктуриране може да нарушава баланса
          на друг възел по-високо в дървото, трябва да продължим
          проверката за баланс до достигане на корена на <span
            style="font-style: italic;">T</span>.<br>
        </big></li>
    </ul>
    <div style="text-align: center;"> <img style="width: 865px; height:
        365px;" alt="" src="avl06.jpg"><br>
    </div>
    <big><span style="font-weight: bold;"><br>
        Времена за изпълнение на операциите на речник АТД с реализация
        като AVL дърво</span><br>
    </big>
    <ul>
      <li><big>Една реконструкция отнема време <span style="font-style:
            italic;">O</span>(1).</big></li>
      <ul>
        <li><big>като използваме реализация на двоично дърво със
            свързана структура</big></li>
      </ul>
      <li><big>find е <span style="font-style: italic;">O</span>(log <span
            style="font-style: italic;">n</span>)</big></li>
      <ul>
        <li><big>височината на дървото е <span style="font-style:
              italic;">O</span>(log <span style="font-style: italic;">n</span>),







            няма реконструкции</big></li>
      </ul>
      <li><big>insert е <span style="font-style: italic;">O</span>(log
          <span style="font-style: italic;">n</span>)</big></li>
      <ul>
        <li><big>началното търсене е <span style="font-style: italic;">O</span>(log











            <span style="font-style: italic;">n</span>)</big></li>
        <li><big>преструктуриране нагоре по дървото - не повече от <span
              style="font-style: italic;">O</span>(log <span
              style="font-style: italic;">n</span>)</big></li>
      </ul>
      <li><big>remove е <span style="font-style: italic;">O</span>(log
          <span style="font-style: italic;">n</span>)</big></li>
      <ul>
        <li><big>началното търсене е <span style="font-style: italic;">O</span>(log











            <span style="font-style: italic;">n</span>)</big></li>
        <li><big>преструктуриране нагоре по дървото - не повече от <span
              style="font-style: italic;">O</span>(log <span
              style="font-style: italic;">n</span>)</big></li>
      </ul>
    </ul>
    <p><a
        href="https://www.cs.usfca.edu/%7Egalles/visualization/AVLtree.html">AVL

        tree</a> - визуализация<br>
    </p>
    <p><a href="https://www.youtube.com/watch?v=FNeL18KsWPc">AVL Trees,
        AVL Sort</a> - лекция в MIT<br>
    </p>
    <ul>
      <ul>
      </ul>
    </ul>
    <h4><big>C++ реализация</big></h4>
    <big><a href="9.8_AVLTree.h-AVLItem.html">html-9.8</a> (AVL Item)<br>
      <a href="9.9_AVLTree.h-AVLTree2.html">html-9.9</a> (AVL Tree 2)<br>
      <a href="9.10_AVLTree.h-AVLTree1.html">html-9.10</a> (AVL Tree 1)<br>
    </big>
    <hr style="width: 100%; height: 2px;">
  </body>
</html>
