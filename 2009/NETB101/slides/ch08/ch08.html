<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Testing and Debugging</title>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<h2>Chapter 8: Testing and Debugging</h2>
<h2>Chapter Goals</h2>
<ul>
  <li><font size="+1">To learn how to design test harnesses for testing
components of your programs in isolation</font></li>
  <li><font size="+1">To understand the principles of test case
selection and evaluation </font></li>
  <li><font size="+1">To be able to use assertions to document program
assumptions</font></li>
  <li><font size="+1">To become familiar with the debugger</font></li>
</ul>
<h2>Unit Tests</h2>
<ul>
  <li><font size="+1">In a unit test, a function or procedure is
compiled outside the program in which it will be used, together with a <i>test
harness</i> that feeds arguments to it.</font></li>
  <li><font size="+1">Once you have confidence that the function is
working correctly, you can plug it into your program.</font></li>
  <li><font size="+1">Test data can be</font></li>
  <ul>
    <li><font size="+1">entered manually (<a
 href="../../sources/ch8/sqrtest1.cpp"><tt>sqrtest1.cpp</tt></a>),</font></li>
    <li><font size="+1">in a loop (<a
 href="../../sources/ch8/sqrtest2.cpp"><tt>sqrtest2.cpp</tt></a>),
or</font></li>
    <li><font size="+1">using random number
generation (<a href="../../sources/ch8/sqrtest3.cpp"><tt>sqrtest3.cpp</tt></a>).</font></li>
  </ul>
</ul>
<h2>Unit Tests (<a href="../../sources/ch8/sqrtest1.cpp"><tt>sqrtest1.cpp</tt></a>)</h2>
<iframe src="code/sqrtest1.cpp.html" height="80%" width="80%">Your
browser does not support the
&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;lt;iframe&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;
tag.</iframe>
<br>
<ul>
  <li><font size="+1">You need to enter inputs and to force an end of
input when you are done, by typing a key such as <span
 style="font-family: monospace;">Ctrl+Z</span>
or <span style="font-family: monospace;">Ctrl+D</span>. </font></li>
  <li><font size="+1">For each test
case, the harness code calls the <span style="font-family: monospace;">squareroot</span>
function and prints the result. </font></li>
  <li><font size="+1">You can then manually check the computations. </font></li>
</ul>
<h2>Unit Tests (<a href="../../sources/ch8/sqrtest2.cpp"><tt>sqrtest2.cpp</tt></a>)</h2>
<iframe src="code/sqrtest2.cpp.html" height="80%" width="80%">Your
browser does not support the
&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;lt;iframe&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;
tag.</iframe>
<br>
<ul>
  <li><font size="+1">We generate test cases automatically and check
the results manually.</font></li>
</ul>
<h2>Unit Tests (<a href="../../sources/ch8/sqrtest3.cpp"><tt>sqrtest3.cpp</tt></a>)</h2>
<iframe src="code/sqrtest3.cpp.html" height="80%" width="80%">Your
browser does not support the
&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;lt;iframe&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;
tag.</iframe>
<br>
<ul>
  <li><font size="+1">Random generation of test cases is useful for
testing.</font></li>
</ul>
<hr style="width: 100%; height: 2px;">
<h2>Selecting Test Cases</h2>
<ul>
  <li><font size="+1">Test cases:</font></li>
  <ul>
    <li><font size="+1"><i>Positive tests</i> consist of legitimate
inputs that you expect the program handles correctly.<br>
For example: <span style="font-family: monospace;">4, 2, 1.5, 1e10,
1.111111111, ...</span> </font></li>
    <li><font size="+1"><i>Boundary cases</i> are also legitimate
inputs
that you expect the program to handle in a trivial way.<br>
For example: <span style="font-family: monospace;">0</span> </font></li>
    <li><font size="+1"><i>Other boundary cases</i> are also legitimate
inputs.<br>
For example: <span style="font-family: monospace;">1e200, 1e-200,
2.222222222222, ...</span> </font></li>
    <li><font size="+1"><i>Negative cases</i> are inputs that you
expect
the program to fail on.<br>
For example: </font><font size="+1"><span
 style="font-family: monospace;">-1</span> </font></li>
  </ul>
  <li><font size="+1">Keeping test data in a file is smart because you
can use it to review every version of the program.<br>
    <span style="font-family: monospace;">&gt;sqrtest1
&lt; test.in &gt; test.out</span> </font></li>
  <li><font size="+1">When you find a bug, you should record the data
that caused the bug, and retest your program with that data after you
have tried to fix the bug.</font></li>
  <li><font size="+1">The phenomenon of fixing a bug, only to have it
reappear after further program modifications is called <i>cycling</i>.
The process of testing against a set of past
failures is called <i>regression testing</i>.</font></li>
  <li><font size="+1">Testing the functionality of the program without
consideration of its internal structure is called <span
 style="font-style: italic;">black-box testing</span>.</font></li>
  <li><font size="+1">Testing strategies that look inside a program are
called <span style="font-style: italic;">white-box testing</span>.<br>
    </font></li>
</ul>
<hr style="width: 100%; height: 2px;">
<h2>Test Case Evaluations</h2>
<ul>
  <li><font size="+1">Once you have determined what <i>inputs</i> are
needed to test the program, you need to decide if the <i>outputs</i>
are correct.</font></li>
  <ul>
    <li><font size="+1">Sometimes you can verify output by calculating
the correct values by hand.</font></li>
    <li><font size="+1">Sometimes a computation does a lot of work, and
it is not practical to do the computation manually.</font></li>
  </ul>
  <li><font size="+1">We could write a test program that verifies that
the output values fulfill certain properties.</font></li>
  <li><font size="+1">Here we test the <tt>squareroot()</tt> function
by comparing the square of the returned number with the original input.<br>
    </font></li>
</ul>
<h2>Test Case Evaluations (<a href="../../sources/ch8/sqrtest4.cpp"><tt>sqrtest4.cpp</tt></a>)</h2>
<iframe src="code/sqrtest4.cpp.html" height="80%" width="80%">Your
browser does not support the
&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;lt;iframe&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;
tag.</iframe>
<ul>
  <li><font size="+1">Another method is to use a slower but reliable
procedure (called an <i>oracle</i>) to verify the results. In this
case, we will use <tt>pow()</tt> as an oracle. (See <tt>sqrtest5.cpp</tt>)</font></li>
</ul>
<h2>Test Case Evaluations (<a href="../../sources/ch8/sqrtest5.cpp"><tt>sqrtest5.cpp</tt></a>)</h2>
<iframe src="code/sqrtest5.cpp.html" height="80%" width="80%">Your
browser does not support the
&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;lt;iframe&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;
tag.</iframe>
<hr style="width: 100%; height: 2px;">
<h2>Assertions (reminder)</h2>
<ul>
  <li><font size="+1">Functions often contain implicit assumptions
(denominators should be nonzero, salaries should not be negative).</font></li>
  <li><font size="+1">Such illegal values can creep into a program due
to an input or processing error - with distressing regularity!</font></li>
  <li><font size="+1">Assertions provide a valuable sanity check.
    <blockquote>
      <pre>void raise_salary(Employee&amp; e, double by)<br>{  assert(e.get_salary() &gt;= 0 );<br>   assert(by &gt;= -100);<br>   double new_salary = e.get_salary() * (1 + by / 100);<br>   e.set_salary(new_salary);<br>}</pre>
    </blockquote>
    </font></li>
  <li><font size="+1">If an assertion is not satisfied, the program
terminates with a useful error message showing the line number and the
code of the failed assertion:
    <blockquote>
      <pre>assertion failed in file finclac.cpp line 61: by &gt;= -100</pre>
    </blockquote>
    </font></li>
  <li><font size="+1">That is a powerful signal that something went
wrong elsewhere and that the program needs further testing.</font></li>
  <li><big style="font-family: monospace;">[<a
 href="../../sources/ch5/futval0.cpp">futval0.cpp</a>]</big></li>
</ul>
<hr style="width: 100%; height: 2px;">
<h2>Program Traces</h2>
<ul>
  <li><font size="+1">To get a printout of the program flow, you can
insert trace messages into the beginning and end of every procedure.</font></li>
  <li><font size="+1">It is also useful to print the input parameters
when a procedure is entered and to print return values when a function
is exited.
    <blockquote>
      <pre>string int_name(int n)<br>{  cout &lt;&lt; "Entering digit_name. n = " &lt;&lt; n &lt;&lt; "\n";<br>   ...<br>   cout &lt;&lt; "Exiting digit name. Return value = "<br>        &lt;&lt; s &lt;&lt; "\n";<br>   return s;<br>}</pre>
    </blockquote>
    </font></li>
  <li><font size="+1"><a href="../../sources/ch8/trace.cpp"><span
 style="font-family: monospace;">trace.cpp</span></a></font> </li>
  <li><font size="+1">To get a proper trace, you must locate <i>each</i>
function exit point. </font></li>
  <li><font size="+1">Sample output for <tt>n</tt> = 12305.
    <blockquote>
      <pre>Inside int_name. Thousands.<br>Entering int_name. n = 12<br>Inside int_name. Teens.<br>Entering teen_name. n = 12<br>Exiting teen_name. Return value = twelve<br>Exiting digit_name. Return value = twelve<br>Inside int_name. Hundreds.<br>Entering digit_name. n = 3<br>Exiting digit_name. Return value = three<br>Inside int_name. Ones.<br>Entering digit_name. n = 5<br>Exiting digit_name. Return value = five<br>Exiting int_name. Return value = twelve thousand three hundred five</pre>
    </blockquote>
    </font></li>
</ul>
<h2>Program Traces (Problems with Trace Messages)</h2>
<ul>
  <li><font size="+1">Program traces can be time-consuming to find out
which trace message to insert.</font></li>
  <li><font size="+1">If you insert too many messages, you produce a
flurry of output that is hard to analyze.</font></li>
  <li><font size="+1">If you insert to few, you may not have enough
information to spot the cause of the error.</font></li>
  <li><font size="+1">When you are done with the program, you need to
remove all the trace messages.</font></li>
  <li><font size="+1">When you find a new error, you need to stick the
print statement back in.</font></li>
  <li><font size="+1">Many profession programmers use a <i>debugger</i>,
not trace messages, to locate errors in their code.</font></li>
</ul>
<hr style="width: 100%; height: 2px;">
<h2>The Debugger</h2>
<ul>
  <li><font size="+1">Modern development environments contain special
programs, called <i>debuggers</i>, that help you locate bugs by
letting you follow the execution of a program.</font></li>
  <li><font size="+1">You can stop and restart your program and see the
contents of variables whenever your program is temporarily stopped.</font></li>
  <li><font size="+1">Using a debugger is not cost free - it takes time
to set up and carry out an effective debugging session.</font></li>
  <li><font size="+1">Larger programs are harder to debug without using
a debugger, so learn how to use one is time well spent.</font></li>
</ul>
<ul>
  <li><font size="+1">Debuggers vary wildly from one system to another.</font></li>
  <li><font size="+1">If you use an integrated development environment,
which contains an editor, compiler, and a debugger, finding and
starting the debugger is usually very easy.</font></li>
  <li><font size="+1">On a UNIX system, you must manually build a debug
version of your program and invoke the debugger.</font></li>
  <li><font size="+1">You can go a long way with just three commands:</font>
    <ul>
      <li><font size="+1">Run until this line.</font></li>
      <li><font size="+1">Step to next line.</font></li>
      <li><font size="+1">Inspect variable.</font></li>
    </ul>
  </li>
  <li><font size="+1">The exact names for these commands will vary from
debugger to debugger, but all debuggers support them.</font></li>
  <li><font size="+1">[</font><font size="+1"><span
 style="font-family: monospace;">prime.cpp</span></font><font size="+1">]<br>
    </font></li>
</ul>
<hr style="width: 100%; height: 2px;">
</body>
</html>
