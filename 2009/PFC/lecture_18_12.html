<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
  <title></title>
</head>
<body>
<b>&nbsp; &#1057;&#1088;&#1072;&#1074;&#1085;&#1077;&#1085;&#1080;&#1077; &#1085;&#1072; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1085;&#1080; &#1085;&#1080;&#1079;&#1086;&#1074;&#1077;</b>
<br>
&nbsp;&nbsp;&nbsp; &#1044;&#1072;&#1076;&#1077;&#1085;&#1080; &#1089;&#1072; &#1076;&#1074;&#1072; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1085;&#1080; &#1085;&#1080;&#1079;&#1072; <i>s</i><sub>1</sub>
&#1080; <i>s</i><sub>2</sub>. &#1047;&#1072;&#1076;&#1072;&#1095;&#1072;&#1090;&#1072; &#1077; &#1086;&#1090; &#1087;&#1098;&#1088;&#1074;&#1080;&#1103; &#1085;&#1080;&#1079; <i>s</i><sub>1</sub>
&#1076;&#1072;
&#1089;&#1077; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080; &#1074;&#1090;&#1086;&#1088;&#1080;&#1103; &#1085;&#1080;&#1079; <i>s</i><sub>2</sub>, &#1082;&#1072;&#1090;&#1086; &#1089;&#1077; &#1080;&#1079;&#1087;&#1086;&#1083;&#1079;&#1074;&#1072;&#1090;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080;&#1090;&#1077;:
<br>
&nbsp;&nbsp;&nbsp; - <tt>replace(i, x)- </tt>&#1079;&#1072;&#1084;&#1077;&#1089;&#1090;&#1074;&#1072; <tt>i</tt>-&#1090;&#1080;&#1103;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083; &#1085;&#1072; <i>s</i><sub>1</sub> &#1089;&#1098;&#1089; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1072;<tt> x</tt>;
<br>
&nbsp;&nbsp;&nbsp; - <tt>insert(i, x) - </tt>&#1074;&#1084;&#1098;&#1082;&#1074;&#1072; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1072; <tt>x</tt>
&#1085;&#1072; &#1087;&#1086;&#1079;&#1080;&#1094;&#1080;&#1103;<tt> i</tt> &#1074; <i>s</i><sub>1</sub>;
<br>
&nbsp;&nbsp;&nbsp; - <tt>delete(i) - </tt>&#1080;&#1079;&#1090;&#1088;&#1080;&#1074;&#1072; <tt>i</tt>-&#1090;&#1080;&#1103;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;
&#1085;&#1072; <i>s</i><sub>1</sub>.
<br>
&#1047;&#1072; &#1074;&#1089;&#1103;&#1082;&#1072; &#1086;&#1090; &#1090;&#1088;&#1080;&#1090;&#1077; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080; &#1077; &#1079;&#1072;&#1076;&#1072;&#1076;&#1077;&#1085;&#1072; &#1094;&#1077;&#1085;&#1072;. &#1058;&#1098;&#1088;&#1089;&#1080;&#1084; &#1082;&#1088;&#1072;&#1081;&#1085;&#1072; &#1088;&#1077;&#1076;&#1080;&#1094;&#1072; &#1086;&#1090;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080; &#1079;&#1072; &#1088;&#1077;&#1096;&#1072;&#1074;&#1072;&#1085;&#1077; &#1085;&#1072; &#1079;&#1072;&#1076;&#1072;&#1095;&#1072;&#1090;&#1072;, &#1082;&#1086;&#1103;&#1090;&#1086; &#1077; &#1089; &#1084;&#1080;&#1085;&#1080;&#1084;&#1072;&#1083;&#1085;&#1072; &#1094;&#1077;&#1085;&#1072;.
<br>
&nbsp;&nbsp;&nbsp; &#1053;&#1077;&#1082;&#1072; <i>F</i>(<i>i, j</i>) &#1077; &#1084;&#1080;&#1085;&#1080;&#1084;&#1072;&#1083;&#1085;&#1072;&#1090;&#1072; &#1094;&#1077;&#1085;&#1072;&#1090;&#1072;
&#1079;&#1072; &#1091;&#1077;&#1076;&#1085;&#1072;&#1082;&#1074;&#1103;&#1074;&#1072;&#1085;&#1077; &#1085;&#1072; &#1085;&#1072;&#1095;&#1072;&#1083;&#1085;&#1080;&#1090;&#1077; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1085;&#1086;&#1089;&#1090;&#1080; (&#1087;&#1088;&#1077;&#1092;&#1080;&#1082;&#1089;&#1080;)
<center><i>s</i><sub>1</sub>[<tt>1</tt>], <i>s</i><sub>1</sub>[<tt>2</tt>],
..., <i>s</i><sub>1</sub>[<tt>i</tt>]&nbsp; &#1080; <i>s</i><sub>2</sub>[<tt>1</tt>],
<i>s</i><sub>2</sub>[<tt>2</tt>],
..., <i>s</i><sub>2</sub>[<tt>j</tt>].</center>
&#1048;&#1085;&#1076;&#1077;&#1082;&#1089;&#1080;&#1090;&#1077; &#1089;&#1072; &#1074;&#1079;&#1077;&#1090;&#1080; &#1087;&#1086; &#1085;&#1072;&#1095;&#1072;&#1083;&#1085;&#1080;&#1090;&#1077; &#1085;&#1080;&#1079;&#1086;&#1074;&#1077;. &#1053;&#1077;&#1082;&#1072; &#1077; <i>c<sub>r</sub></i>
&#1094;&#1077;&#1085;&#1072;&#1090;&#1072;
&#1079;&#1072; &#1079;&#1072;&#1084;&#1077;&#1089;&#1090;&#1074;&#1072;&#1085;&#1077; &#1085;&#1072; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083; &#1086;&#1090; <i>s</i><sub>1</sub> &#1089;&#1098;&#1089; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083; &#1086;&#1090; <i>s</i><sub>2</sub>;
<i>c<sub>i</sub></i> &#1077; &#1094;&#1077;&#1085;&#1072;&#1090;&#1072; &#1079;&#1072; &#1074;&#1084;&#1098;&#1082;&#1074;&#1072;&#1085;&#1077; &#1085;&#1072; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083; &#1074; <i>s</i><sub>1</sub>
&#1080; <i>c<sub>d</sub></i> &#1077; &#1094;&#1077;&#1085;&#1072;&#1090;&#1072; &#1079;&#1072; &#1080;&#1079;&#1090;&#1088;&#1080;&#1074;&#1072;&#1085;&#1077; &#1085;&#1072; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083; &#1086;&#1090; <i>s</i><sub>1</sub>.
<blockquote>&nbsp;&nbsp;&nbsp; &#1040;&#1082;&#1086; <i>s</i><sub>1</sub>[<tt>i</tt>] = <i>s</i><sub>2</sub>[<tt>j</tt>],
&#1090;&#1086;
  <center><i>F</i>(<i>i, j</i>) = <i>F</i>(<i>i - </i>1<i>, j - </i>1),</center>
</blockquote>
&#1074; &#1087;&#1088;&#1086;&#1090;&#1080;&#1074;&#1077;&#1085; &#1089;&#1083;&#1091;&#1095;&#1072;&#1081; &#1097;&#1077; &#1089;&#1077; &#1074;&#1079;&#1077;&#1084;&#1077; &#1084;&#1080;&#1085;&#1080;&#1084;&#1072;&#1083;&#1085;&#1086;&#1090;&#1086; &#1086;&#1090; &#1090;&#1088;&#1080;&#1090;&#1077; &#1095;&#1080;&#1089;&#1083;&#1072;:
<blockquote>
  <center><i>F</i>(<i>i - </i>1<i>, j - </i>1) + <i>c<sub>r</sub></i>
  <br>
  <i>F</i>(<i>i,&nbsp; j - </i>1) + <i>c<sub>i</sub></i>
  <br>
  <i>F</i>(<i>i - </i>1<i>,&nbsp; j</i>) + <i>c<sub>d</sub></i></center>
</blockquote>
&#1054;&#1089;&#1090;&#1072;&#1074;&#1072; &#1076;&#1072; &#1089;&#1077; &#1087;&#1088;&#1077;&#1089;&#1084;&#1077;&#1090;&#1085;&#1072;&#1090; &#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090;&#1080;&#1090;&#1077; &#1085;&#1072; <i>F</i>(<i>i, </i>0) &#1080; <i>F</i>(0<i>,
j</i>). <i>F</i>(<i>i, </i>0) &#1086;&#1079;&#1085;&#1072;&#1095;&#1072;&#1074;&#1072; &#1087;&#1088;&#1072;&#1079;&#1077;&#1085; &#1074;&#1090;&#1086;&#1088;&#1080; &#1085;&#1080;&#1079;, &#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1085;&#1086;
<i>F</i>(<i>i,
</i>0)
= <i>i</i> <i>c<sub>d</sub></i>. &#1040;&#1085;&#1072;&#1083;&#1086;&#1075;&#1080;&#1095;&#1085;&#1086; &#1087;&#1088;&#1080; &#1087;&#1088;&#1072;&#1079;&#1077;&#1085; &#1087;&#1098;&#1088;&#1074;&#1080; &#1085;&#1080;&#1079;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1074;&#1072;&#1084;&#1077;
<i>F</i>(0<i>, j</i>) = <i>j</i> <i>c<sub>i</sub></i>.
<p><b><tt><font color="#000099">// trans.c</font></tt></b>
<br>
<b><tt><font color="#000099">#include &lt;stdio.h&gt;</font></tt></b>
<br>
<b><tt><font color="#000099">#include &lt;string.h&gt;</font></tt></b>
<br>
<b><tt><font color="#000099">#define MAX 100</font></tt></b>
<br>
<b><tt><font color="#000099">#define min2(a,b) (((a)&lt;(b)) ? (a)
: (b))</font></tt></b>
<br>
<b><tt><font color="#000099">#define min3(a,b,c) (min2(min2(a,b),(c)))</font></tt></b>
</p>
<p><b><tt><font color="#000099">#define COST_DELETE 1</font></tt></b>
<br>
<b><tt><font color="#000099">#define COST_INSERT 2</font></tt></b>
<br>
<b><tt><font color="#000099">#define COST_REPLACE(i,j) ((s1[i] ==
s2[j])
? 0 : 3)</font></tt></b>
</p>
<p><b><tt><font color="#000099">unsigned F[MAX+1][MAX+1];</font></tt></b>
<br>
<b><tt><font color="#000099">unsigned n1, n2;</font></tt></b>
</p>
<p><b><tt><font color="#000099">const char *s1 = "_abracadabra";</font></tt></b>
<br>
<b><tt><font color="#000099">const char *s2 = "_mabragabra";</font></tt></b>
</p>
<p><b><tt><font color="#000099">unsigned editDistance(void)</font></tt></b>
<br>
<b><tt><font color="#000099">{ unsigned i,j;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; for (i=0; i&lt;=n1; i++) F[i][0]
= i*COST_DELETE;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; for (j=0; j&lt;=n2; j++) F[0][j]
= j*COST_INSERT;</font></tt></b>
</p>
<p><b><tt><font color="#000099">&nbsp; for (i=1; i&lt;=n1; i++)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp; for (j=1;
j&lt;=n2;
j++)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
F[i][j] = min3(F[i-1][j-1] + COST_REPLACE(i,j),</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
F[i&nbsp; ][j-1] + COST_INSERT,</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
F[i-1][j&nbsp; ] + COST_DELETE);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; return F[n1][n2];</font></tt></b>
<br>
<b><tt><font color="#000099">}</font></tt></b>
</p>
<p><b><tt><font color="#000099">void printEditOperations(unsigned i,
unsigned
j)</font></tt></b>
<br>
<b><tt><font color="#000099">{</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;if (j==0) for (j=1; j&lt;=i; j++)
printf("DELETE(%u) ",j);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;else if (i==0) for (i=1; i&lt;=j;
i++) printf("INSERT(%u, %c) ",i, s2[i]);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;else if (i&gt;0 &amp;&amp; j&gt;0)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;{ if ( F[i][j] == F[i-1][j-1] +
COST_REPLACE(i,j) )</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp; {
printEditOperations(i-1,j-1);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp; if
(COST_REPLACE(i,j)&gt;0)
printf("REPLACE(%u, %c) ", i, s2[j]);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp; }</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp; else if (F[i][j] == F[i][j-1]
+ COST_INSERT)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp; { printEditOperations(i,j-1);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;
printf("INSERT(%u,
%c) ", i, s2[j]);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp; }</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp; else if (F[i][j] == F[i-1][j]
+ COST_DELETE)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp; { printEditOperations(i-1,j);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;
printf("DELETE(%u)
", i);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp; }</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;}</font></tt></b>
<br>
<b><tt><font color="#000099">}</font></tt></b>
</p>
<p><b><tt><font color="#000099">int main()</font></tt></b>
<br>
<b><tt><font color="#000099">{ n1 = strlen(s1)-1; n2 = strlen(s2)-1;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; printf("Distance: %u\n",
editDistance());</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; printEditOperations(n1,n2);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; printf("\n");</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; return 0;</font></tt></b>
<br>
<b><tt><font color="#000099">}</font></tt></b>
<br>
&nbsp;
<table border="1" cellpadding="4" width="100%">
  <tbody>
    <tr>
      <td><b><tt><font color="#006600">Distance: 7</font></tt></b>
      <br>
      <b><tt><font color="#006600">INSERT(1, m) DELETE(4) DELETE(5)
REPLACE(7,
g)&nbsp;</font></tt></b></td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;
<table border="1" cellpadding="4" cellspacing="0">
  <tbody>
    <tr>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><b><tt><font color="#000099">_abracadabra</font></tt></b></td>
    </tr>
    <tr>
      <td><b><tt><font color="#006600">INSERT(1, m)</font></tt></b></td>
      <td>2</td>
      <td><b><tt><font color="#000099">0</font><font color="#ff0000">1</font><font
 color="#000099">2345678901</font></tt></b>
      <br>
      <b><tt><font color="#000099">_abracadabra</font></tt></b></td>
      <td>
      <br>
      <b><tt><font color="#000099">_</font><font color="#cc0000">m</font><font
 color="#000099">abracadabra</font></tt></b></td>
    </tr>
    <tr>
      <td><b><tt><font color="#006600">DELETE(4)</font></tt></b></td>
      <td>1</td>
      <td><b><tt><font color="#000099">0123</font><font color="#cc0000">4</font><font
 color="#000099">5678901</font></tt></b>
      <br>
      <b><tt><font color="#000099">_abr</font><font color="#cc0000">a</font><font
 color="#000099">cadabra</font></tt></b></td>
      <td>
      <br>
      <b><tt><font color="#000099">_</font><font color="#cc0000">m</font><font
 color="#000099">abrcadabra</font></tt></b></td>
    </tr>
    <tr>
      <td><b><tt><font color="#006600">DELETE(5)</font></tt></b></td>
      <td>1</td>
      <td><b><tt><font color="#000099">01234</font><font color="#cc0000">5</font><font
 color="#000099">678901</font></tt></b>
      <br>
      <b><tt><font color="#000099">_abra</font><font color="#cc0000">c</font><font
 color="#000099">adabra</font></tt></b></td>
      <td>
      <br>
      <b><tt><font color="#000099">_</font><font color="#cc0000">m</font><font
 color="#000099">abradabra</font></tt></b></td>
    </tr>
    <tr>
      <td><b><tt><font color="#006600">REPLACE(7, g)</font></tt></b></td>
      <td>3</td>
      <td><b><tt><font color="#000099">0123456</font><font
 color="#cc0000">7</font><font color="#000099">8901</font></tt></b>
      <br>
      <b><tt><font color="#000099">_abraca</font><font color="#cc0000">d</font><font
 color="#000099">abra</font></tt></b></td>
      <td>
      <br>
      <b><tt><font color="#000099">_</font><font color="#cc0000">m</font><font
 color="#000099">abra</font><font color="#cc0000">g</font><font
 color="#000099">abra</font></tt></b></td>
    </tr>
    <tr>
      <td><br>
      </td>
      <td><b>7</b></td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p></p>
<hr width="100%">
<p>Southeastern European Regional Programming Contest
<br>
Bucharest, Romania, October 18, 2003
</p>
<p>Problem F
<br>
<b>Common Subsequence</b>
</p>
<p>Input File: F.IN
<br>
Program Source File: F.PAS or F.C or F.CPP or F.JAVA
</p>
<p>A subsequence of a given sequence is the given sequence with some
elements
(possible none) left out. Given a sequence <i>X</i> = <i>&lt;x</i><sub>1</sub>,<i>
x</i><sub>2</sub>, ...,<i> x<sub>m</sub></i>&gt; another sequence <i>Z</i>
= &lt;<i>z</i><sub>1</sub>, <i>z</i><sub>2</sub>, ..., <i>z<sub>k</sub></i>&gt;
is a subsequence of <i>X</i> if there exists a strictly increasing
sequence
&lt;<i>i</i><sub>1</sub>, <i>i</i><sub>2</sub>, ..., <i>i<sub>k</sub></i>&gt;
of indices of <i>X</i> such that for all <i>j</i> = 1,2,...,<i>k</i>,<i>
x<sub>ij</sub></i> = <i>z<sub>j</sub></i>. For example, <i>Z</i> =
&lt;<i>a,
b, f, c</i>&gt; is a subsequence of <i>X</i> = &lt;<i>a, b, c, f, b, c</i>&gt;
with index sequence &lt;1, 2, 4, 6&gt;. Given two sequences <i>X</i>
and <i>Y</i>
the problem is to find the length of the maximum-length common
subsequence
of <i>X</i> and <i>Y</i>.
</p>
<p>The program input is from a text file. Each data set in the file
contains
two strings representing the given sequences. The sequences are
separated
by any number of white spaces. The input data are correct. For each set
of data the program prints on the standard output the length of the
maximum-length
common subsequence from the beginning of a separate line.
</p>
<p>Input
<br>
<b><tt>abcfbc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; abfcab</tt></b>
<br>
<b><tt>programming&nbsp;&nbsp;&nbsp; contest</tt></b>
<br>
<b><tt>abcd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mnp</tt></b>
</p>
<p>Output
<br>
4
<br>
2
<br>
0
<br>
</p>
</body>
</html>
