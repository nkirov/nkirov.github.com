<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd">
<?xml version="1.0" encoding="utf-8"?><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>BST4</title>
</head>
<body vlink="purple" text="black" bgcolor="#FFFABB" link="blue">
<h2><font face="Helvetica">Code Fragment: BST4</font></h2>
<br><dl><dd><pre>

<font color="#A000A0">public</font>:
  <font color="#A000A0">void</font> <font color="#000000">removeElement</font>(<font color="#A000A0">const</font> Key&amp; k)			<font color="#0000FF">// remove using key</font>
      <font color="#00A000">throw</font>(NonexistentElementException) {
    BTPosition p = <font color="#000000">finder</font>(k, T.<font color="#000000">root</font>());			<font color="#0000FF">// find the node</font>
    <font color="#00A000">if</font> (p.<font color="#000000">isNull</font>())					<font color="#0000FF">// not found?</font>
      <font color="#00A000">throw</font> <font color="#000000">NonexistentElementException</font>(<font color="#0000FF">"Remove nonexistent element"</font>);
    <font color="#000000">remover</font>(p);						<font color="#0000FF">// remove it</font>
  }
<font color="#A000A0">protected</font>:
  BTPosition <font color="#000000">remover</font>(<font color="#A000A0">const</font> BTPosition&amp; r) {		<font color="#0000FF">// remove utility</font>
    BTPosition p;
    <font color="#00A000">if</font> (T.<font color="#000000">isExternal</font>(T.<font color="#000000">leftChild</font>(r)))			<font color="#0000FF">// left is external?</font>
      p = T.<font color="#000000">leftChild</font>(r);				<font color="#0000FF">// remove from left</font>
    <font color="#00A000">else</font> <font color="#00A000">if</font> (T.<font color="#000000">isExternal</font>(T.<font color="#000000">rightChild</font>(r)))		<font color="#0000FF">// right is external?</font>
      p = T.<font color="#000000">rightChild</font>(r);				<font color="#0000FF">// remove from right</font>
    <font color="#00A000">else</font> {						<font color="#0000FF">// both internal?</font>
      p = T.<font color="#000000">rightChild</font>(r);				<font color="#0000FF">// p = replacement</font>
      <font color="#00A000">do</font> 						<font color="#0000FF">// find leftmost in</font>
        p = T.<font color="#000000">leftChild</font>(p);				<font color="#0000FF">// ...right subtree</font>
      <font color="#00A000">while</font> (T.<font color="#000000">isInternal</font>(p));
      <font color="#000000">setItem</font>(r, T.<font color="#000000">parent</font>(p).<font color="#000000">element</font>());		<font color="#0000FF">// copy parent(p) to r</font>
    }
    <font color="#00A000">return</font> T.<font color="#000000">removeAboveExternal</font>(p);			<font color="#0000FF">// remove p and parent</font>
  }
</pre></dd></dl>
</body>
</html>
