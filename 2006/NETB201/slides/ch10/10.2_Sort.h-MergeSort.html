<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
	"http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><title>MergeSort</title>
</head><body vlink="purple" text="black" bgcolor="#FFFABB" link="blue">
<h2><font face="Helvetica">Code Fragment: MergeSort</font></h2>
</center><br><dl><dd><pre>

<font color=#A000A0>template</font> &lt;<font color=#A000A0>typename</font> Object, <font color=#A000A0>typename</font> Sequence&gt;
<font color=#A000A0>class</font> MergeSort {
<font color=#A000A0>protected</font>:   						<font color=#0000FF>// utility functions</font>
  <font color=#A000A0>void</font> <font color=#000000>merge</font>(Sequence& S1, Sequence& S2, Sequence& S);	<font color=#0000FF>// merge utility</font>
  <font color=#A000A0>void</font> <font color=#000000>appendFirst</font>(Sequence& src, Sequence& dst) {	<font color=#0000FF>// append utility</font>
    Object obj = src.<font color=#000000>first</font>().<font color=#000000>element</font>();			<font color=#0000FF>// first of source</font>
    src.<font color=#000000>remove</font>(src.<font color=#000000>first</font>());				<font color=#0000FF>// remove it</font>
    dst.<font color=#000000>insertLast</font>(obj);				<font color=#0000FF>// append to dest</font>
  }
<font color=#A000A0>public</font>:
  <font color=#A000A0>void</font> <font color=#000000>mergeSort</font>(Sequence& S);				<font color=#0000FF>// merge sort S</font>
};
<font color=#A000A0>template</font> &lt;<font color=#A000A0>typename</font> Object, <font color=#A000A0>typename</font> Sequence&gt;
<font color=#A000A0>void</font> MergeSort&lt;Object, Sequence&gt;::
<font color=#000000>merge</font>(Sequence& S1, Sequence& S2, Sequence& S) {	<font color=#0000FF>// merge S1 and S2 to S</font>
  <font color=#00A000>while</font>(!S1.<font color=#000000>isEmpty</font>() && !S2.<font color=#000000>isEmpty</font>())			<font color=#0000FF>// until either is empty</font>
    <font color=#00A000>if</font>(S1.<font color=#000000>first</font>().<font color=#000000>element</font>() &lt;= S2.<font color=#000000>first</font>().<font color=#000000>element</font>())	<font color=#0000FF>// copy smaller element</font>
      <font color=#000000>appendFirst</font>(S1, S);
    <font color=#00A000>else</font>
      <font color=#000000>appendFirst</font>(S2, S);
  <font color=#00A000>while</font>(!S1.<font color=#000000>isEmpty</font>())					<font color=#0000FF>// copy remainder of S1</font>
    <font color=#000000>appendFirst</font>(S1, S);
  <font color=#00A000>while</font>(!S2.<font color=#000000>isEmpty</font>())					<font color=#0000FF>// copy remainder of S2</font>
    <font color=#000000>appendFirst</font>(S2, S);
}
<font color=#A000A0>template</font> &lt;<font color=#A000A0>typename</font> Object, <font color=#A000A0>typename</font> Sequence&gt;
<font color=#A000A0>void</font> MergeSort&lt;Object, Sequence&gt;::
<font color=#000000>mergeSort</font>(Sequence& S) {				<font color=#0000FF>// sort S</font>
  Sequence S1, S2;
  <font color=#A000A0>int</font> i;
  <font color=#A000A0>int</font> n = S.<font color=#000000>size</font>();
  <font color=#00A000>if</font> (n &lt;= 1) <font color=#00A000>return</font>;					<font color=#0000FF>// 0 or 1 elements</font>
  <font color=#00A000>for</font> (i = n  ; i &gt; n/2  ; i--) <font color=#000000>appendFirst</font>(S, S1);	<font color=#0000FF>// put half in S1</font>
  <font color=#00A000>for</font> (       ; i &gt; 0    ; i--) <font color=#000000>appendFirst</font>(S, S2);	<font color=#0000FF>// put remainder in S2</font>
  <font color=#000000>mergeSort</font>(S1);					<font color=#0000FF>// sort S1</font>
  <font color=#000000>mergeSort</font>(S2);					<font color=#0000FF>// sort S2</font>
  <font color=#000000>merge</font>(S1, S2, S);					<font color=#0000FF>// merge S1 and S2 into S</font>
}
</dl>
</body></html>
