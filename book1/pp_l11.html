<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta name="Author" content="Nikolay Kirov">
   <meta name="GENERATOR" content="Mozilla/4.75 [en] (Win98; U) [Netscape]">
   <title>pp_l11</title>
</head>
<body>

<hr width="100%">
<center>
<p><b><font size="+1">11. Класове</font></b></p>
</center>

<div align="right">
<b><i><font size="-1"> </font></i></b>
<br><b><i><font size="-1">"Изпървом бил Еру, Единствения, когото в Арда наричат
Илуватар;</font></i></b>
<br><b><i><font size="-1">и той сътворил Свещените Айнури, що били рожби
на неговата</font></i></b>
<br><b><i><font size="-1">мисъл и съществували заедно с него още когато нямало</font></i></b>
<br><b><i><font size="-1">нищо друго."</font></i></b>
<br><b><i><font size="-1">                                                      
Дж. Р. Р. Толкин, СИЛМАРИЛИОНЪТ</font></i></b>
<br><b><i><font size="-1"> </font></i></b>
</div>
    В лекциите до тук за класовете са разгледани:
<br>- конструиране на обект: <b><tt><font color="#009900">Employee harry("Hacher,
Harry", 350);</font></tt></b>
<br><font color="#000000">- модифициране на обект: </font><b><tt><font color="#009900">harry.set_salary(380);</font></tt></b>
<br><font color="#000000">- извеждане на информация за обект:</font><b><tt><font color="#009900">
cout &lt;&lt; harry.get_name();</font></tt></b>
<br>Въведени са и основните понятия конструктор, член-функция и операция
точка.
<br>
<hr width="100%">
<br><img src="bullet.gif" align="CENTER">  Обособяване на класове.
<br>    Ще разгледаме задача, която се решава без използване
на клас и след това с дефиниране и използване на подходящ клас.
<br>    Чете се информация за компютри, съдържаща:
<table cols="2" width="100%">
<tr>
<td valign="TOP">
<table border cellspacing="0" cellpadding="4">
<tr>
<td>име на модел</td>

<td><b><tt><font color="#006600">name</font></tt></b></td>

<td><b><tt>OmniBook XE</tt></b></td>
</tr>

<tr>
<td>цена</td>

<td><b><tt><font color="#006600">price</font></tt></b></td>

<td><b><tt>5660</tt></b></td>
</tr>

<tr>
<td>оценка</td>

<td><b><tt><font color="#006600">score</font></tt></b></td>

<td><b><tt>76</tt></b></td>
</tr>
</table>
</td>

<td>
<b><tt>OmniBook XE</tt></b>
<br><b><tt>5660</tt></b>
<br><b><tt>76</tt></b>
<br><b><tt>ACMA P300</tt></b>
<br><b><tt>1095</tt></b>
<br><b><tt>75</tt></b>
<br><b><tt>AMAX Poewrstation</tt></b>
<br><b><tt>1999</tt></b>
<br><b><tt>78</tt></b>
</td>
</tr>
</table>
Търси се продукта с най-голямо отношение оценка/цена.
<br>** Първото програмно решение е без използване на класове.
<br><b><tt><font color="#000099">// bangbuck.cpp</font></tt></b>
<br><b><tt><font color="#000099">#include &lt;iostream&gt;</font></tt></b>
<br><b><tt><font color="#000099">#include &lt;string&gt;</font></tt></b>
<br><b><tt><font color="#000099">using namespace std;</font></tt></b>
<p><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{  string best_name = "";</font></tt></b>
<br><b><tt><font color="#000099">   double best_price = 0;</font></tt></b>
<br><b><tt><font color="#000099">   int best_score = 0;</font></tt></b>
<br><b><tt><font color="#000099">   bool more = true;</font></tt></b>
<br><b><tt><font color="#000099">   while (more)</font></tt></b>
<br><b><tt><font color="#000099">   {  string next_name;</font></tt></b>
<br><b><tt><font color="#000099">      double
next_price;</font></tt></b>
<br><b><tt><font color="#000099">      int next_score;</font></tt></b>
<br><b><tt><font color="#000099">      cout &lt;&lt;
"Please enter the model name: ";</font></tt></b>
<br><b><tt><font color="#000099">      getline(cin,
next_name);</font></tt></b>
<br><b><tt><font color="#000099">      cout &lt;&lt;
"Please enter the price: ";</font></tt></b>
<br><b><tt><font color="#000099">      cin &gt;&gt;
next_price;</font></tt></b>
<br><b><tt><font color="#000099">      cout &lt;&lt;
"Please enter the score: ";</font></tt></b>
<br><b><tt><font color="#000099">      cin &gt;&gt;
next_score;</font></tt></b>
<br><b><tt><font color="#000099">      string
remainder; /* read remainder of line */</font></tt></b>
<br><b><tt><font color="#000099">      getline(cin,
remainder);</font></tt></b>
<br><b><tt><font color="#000099">      if (next_price
!= 0)</font></tt></b>
<br><b><tt><font color="#000099">      { 
if (best_price == 0 or</font></tt></b>
<br><b><tt><font color="#000099">           
next_score/next_price &gt; best_score/best_price)</font></tt></b>
<br><b><tt><font color="#000099">        
{  best_name = next_name;</font></tt></b>
<br><b><tt><font color="#000099">           
best_score = next_score;</font></tt></b>
<br><b><tt><font color="#000099">           
best_price = next_price;</font></tt></b>
<br><b><tt><font color="#000099">        
}</font></tt></b>
<br><b><tt><font color="#000099">      }</font></tt></b>
<br><b><tt><font color="#000099">      cout &lt;&lt;
"More data? (y/n) ";</font></tt></b>
<br><b><tt><font color="#000099">      string
answer;</font></tt></b>
<br><b><tt><font color="#000099">      getline(cin,
answer);</font></tt></b>
<br><b><tt><font color="#000099">      if (answer
!= "y") more = false;</font></tt></b>
<br><b><tt><font color="#000099">   }</font></tt></b>
<br><b><tt><font color="#000099">   cout &lt;&lt; "The best bang
for the buck is " &lt;&lt; best_name</font></tt></b>
<br><b><tt><font color="#000099">      &lt;&lt;
" (Score: " &lt;&lt; best_score</font></tt></b>
<br><b><tt><font color="#000099">      &lt;&lt;
" Price: " &lt;&lt; best_price &lt;&lt; ")\n";</font></tt></b>
<br><b><tt><font color="#000099">   return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
</p>
<table border cellpadding="4" width="100%">
<tr>
<td>
<b><tt><font color="#660000">Please enter the model name: OmnoBook
XE</font></tt></b>
<br><b><tt><font color="#660000">Please enter the price: 5660</font></tt></b>
<br><b><tt><font color="#660000">Please enter the score: 76</font></tt></b>
<br><b><tt><font color="#660000">More data? (y/n) y</font></tt></b>
<br><b><tt><font color="#660000">Please enter the model name: Junk PC</font></tt></b>
<br><b><tt><font color="#660000">Please enter the price: 1230</font></tt></b>
<br><b><tt><font color="#660000">Please enter the score: 51</font></tt></b>
<br><b><tt><font color="#660000">More data? (y/n) n</font></tt></b>
<br><b><tt><font color="#660000">The best bang for the buck is Junk PC
(Score: 51 Price: 1230)</font></tt></b>
</td>
</tr>
</table>

<p><img src="bullet.gif" height="18" width="20"> Интерфейс и капсулиране, членове-функции.
<br>** Второ програмно решение на задачата с използване на класове.
<br><b><tt><font color="#000099">// product2.cpp</font></tt></b>
<br><b><tt><font color="#000099">#include &lt;iostream&gt;</font></tt></b>
<br><b><tt><font color="#000099">#include &lt;string&gt;</font></tt></b>
<br><b><tt><font color="#000099">using namespace std;</font></tt></b>
</p>
<p><b><tt><font color="#3333FF">/* ДЕФИНИЦИЯ НА КЛАСА */</font></tt></b>
<br><b><tt><font color="#000099">class Product  {</font></tt></b>
<br><b><tt><font color="#000099">public:                
</font><font color="#3333FF">/* интерфейс, открита част */</font></tt></b>
<br><b><tt><font color="#3333FF">/* декларации на член-функциите на класа
*/</font></tt></b>
<br><b><tt><font color="#000099">   Product();                        
</font><font color="#3333FF">/* създава нов продукт */</font></tt></b>
<br><b><tt><font color="#000099">   void read();                      
</font><font color="#3333FF">/* чете продукт       
*/</font></tt></b>
<br><b><tt><font color="#000099">   bool is_better_than(Product
b) const;</font><font color="#3333FF">/* сравнява продукти */</font></tt></b>
<br><b><tt><font color="#000099">   void print() const;               
</font><font color="#3333FF">/* отпечатва продукт   */</font></tt></b>
<br><b><tt><font color="#000099">private:              
</font><font color="#3333FF">/* капсулиране, скрита част */</font></tt></b>
<br><b><tt><font color="#000099">   string name;                      
</font><font color="#3333FF">/* скрити данни */</font></tt></b>
<br><b><tt><font color="#000099">   double price;                     
</font><font color="#3333FF">/* скрити данни */</font></tt></b>
<br><b><tt><font color="#000099">   int score;                        
</font><font color="#3333FF">/* скрити данни */</font></tt></b>
<br><b><tt><font color="#000099">};</font></tt></b>
<br><b><tt><font color="#3333FF">/* ИЗПОЛЗВАНЕ НА КЛАСА */</font></tt></b>
<br><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{  Product best;      
</font><font color="#3333FF">/* дефиниране на обект от класа */</font></tt></b>
<br><b><tt><font color="#000099">   bool more = true;</font></tt></b>
<br><b><tt><font color="#000099">   while (more)</font></tt></b>
<br><b><tt><font color="#000099">   {  Product next;</font></tt></b>
<br><b><tt><font color="#000099">      next.read();   
</font><font color="#3333FF">/* извикване на член-функция на класа */</font></tt></b>
<br><b><tt><font color="#000099">      if (next.is_better_than(best))
best = next;</font></tt></b>
<br><b><tt><font color="#000099">      cout &lt;&lt;
"More data? (y/n) ";</font></tt></b>
<br><b><tt><font color="#000099">      string
answer;</font></tt></b>
<br><b><tt><font color="#000099">      getline(cin,
answer);</font></tt></b>
<br><b><tt><font color="#000099">      if (answer
!= "y") more = false;</font></tt></b>
<br><b><tt><font color="#000099">   }</font></tt></b>
<br><b><tt><font color="#000099">   cout &lt;&lt; "The best bang
for the buck is ";</font></tt></b>
<br><b><tt><font color="#000099">   best.print();       </font><font color="#3333FF">
/* извикване на член-функция на класа */</font></tt></b>
<br><b><tt><font color="#000099">   return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#3333FF">/* РЕАЛИЗАЦИЯ НА КЛАСА */</font></tt></b>
<br><b><tt><font color="#3333FF">/* дефиниция на конструктор */</font></tt></b>
<br><b><tt><font color="#000099">Product::Product()</font></tt></b>
<br><b><tt><font color="#000099">{ price = 10000;</font></tt></b>
<br><b><tt><font color="#000099">  score = 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#3333FF">/* дефиниция на член-функция мутатор (set-функция)
*/</font></tt></b>
<br><b><tt><font color="#000099">void Product::read()</font></tt></b>
<br><b><tt><font color="#000099">{  cout &lt;&lt; "Please enter the
model name: ";</font></tt></b>
<br><b><tt><font color="#000099">   getline(cin, name);</font></tt></b>
<br><b><tt><font color="#000099">   cout &lt;&lt; "Please enter
the price: ";</font></tt></b>
<br><b><tt><font color="#000099">   cin &gt;&gt; price;</font></tt></b>
<br><b><tt><font color="#000099">   cout &lt;&lt; "Please enter
the score: ";</font></tt></b>
<br><b><tt><font color="#000099">   cin &gt;&gt; score;</font></tt></b>
<br><b><tt><font color="#000099">   string remainder;</font></tt></b>
<br><b><tt><font color="#000099">   getline(cin, remainder);</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#3333FF">/* дефиниция на член-функции за достъп
(get-функция) */</font></tt></b>
<br><b><tt><font color="#000099">bool Product::is_better_than(Product b)
const</font></tt></b>
<br><b><tt><font color="#000099">{  if (price == 0) return false;</font></tt></b>
<br><b><tt><font color="#000099">    if (b.price == 0) return
true;</font></tt></b>
<br><b><tt><font color="#000099">    if (score/price &gt; b.score/b.price)
return true;</font></tt></b>
<br><b><tt><font color="#000099">    return false;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#3333FF">/* дефиниция на член-функции за достъп
(get-функция) */</font></tt></b>
<br><b><tt><font color="#000099">void Product::print() const</font></tt></b>
<br><b><tt><font color="#000099">{ cout &lt;&lt; name</font></tt></b>
<br><b><tt><font color="#000099">       &lt;&lt;
" Price: " &lt;&lt; price</font></tt></b>
<br><b><tt><font color="#000099">       &lt;&lt;
" Score: " &lt;&lt; score &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br><b><tt><font color="#3333FF">/* КРАЙ на файла, съдържащ текста на програмата
*/</font></tt></b>
<br><font color="#000000">** Неявен параметър на член-функция:</font>
<br>- set-функции (мутатори) - променят (стойността на) неявния си параметър;
<br><b><tt><font color="#000099">    void read();</font></tt></b>
<br>- get-функции (функции за достъп) - не променят (стойността на) неявния
си параметър, могат да се обявят като константни функции.
<br><b><tt><font color="#000099">    void print() const;  </font></tt></b>
<br>
</p>
<hr width="100%">
<br><img src="bullet.gif" align="CENTER"> Конструктори по подразбиране и
с параметри.
<br>** Конструкторът инициализира (задава начални стойности на) данните
на класа. Няма тип и не връща стойност.
<br>** Предефиниране на функции - две функции в една програма на С++ могат
да имат еднакви имена. За да бъдат различими, те трябва да имат различен
брой параметри или/и параметрите им да са от различен тип.
<br><b><tt><font color="#006600">class Employee {</font></tt></b>
<br><b><tt><font color="#006600">public:</font></tt></b>
<br><b><tt><font color="#006600">/* конструктор без параметри */</font></tt></b>
<br><b><tt><font color="#006600">   Employee();</font></tt></b>
<br><b><tt><font color="#006600">/* конструктор с параметри */</font></tt></b>
<br><b><tt><font color="#006600">   Employee(string emp_name,
double init_salary);</font></tt></b>
<br><b><tt><font color="#006600">   void set_salary(double new_salary);</font></tt></b>
<br><b><tt><font color="#006600">   string get_name() const;</font></tt></b>
<br><b><tt><font color="#006600">   double get_salary() const;</font></tt></b>
<br><b><tt><font color="#006600">   void print() const;</font></tt></b>
<br><b><tt><font color="#006600">private:</font></tt></b>
<br><b><tt><font color="#006600">   string name;</font></tt></b>
<br><b><tt><font color="#006600">   double salary;</font></tt></b>
<br><b><tt><font color="#006600">};</font></tt></b>
<br><b><tt><font color="#006600">/* дефиниция на канструктора с параметри
*/</font></tt></b>
<br><b><tt><font color="#006600">Employee::Employee(string emp_name, double
init_salary)</font></tt></b>
<br><b><tt><font color="#006600">{ name = emp_name;</font></tt></b>
<br><b><tt><font color="#006600">  salary = init_salary;  }</font></tt></b><font color="#000000"></font>
<p><font color="#000000">* Полета с данни - обекти от други класове.</font>
<br><b><tt><font color="#006600">class Employee {</font></tt></b>
<br><b><tt><font color="#006600">public:</font></tt></b>
<br><b><tt><font color="#006600">   Employee(string n, double
sal, int arr, int leav);</font></tt></b>
<br><b><tt><font color="#006600">   ...</font></tt></b>
<br><b><tt><font color="#006600">private:</font></tt></b>
<br><b><tt><font color="#006600">   string name;</font></tt></b>
<br><b><tt><font color="#006600">   double salary;</font></tt></b>
<br><b><tt><font color="#006600">   Time arrive;</font></tt></b>
<br><b><tt><font color="#006600">   Time leave;</font></tt></b>
<br><b><tt><font color="#006600">};</font></tt></b><font color="#006600"></font>
</p>
<p><b><tt><font color="#006600">Employee::Employee(string n, double sal,
int arr, int leav)</font></tt></b>
<br><b><tt><font color="#006600">{ name = n;</font></tt></b>
<br><b><tt><font color="#006600">  salary = sal;</font></tt></b>
<br><b><tt><font color="#006600">  arrive = Time(arr, 0, 0);</font></tt></b>
<br><b><tt><font color="#006600">  leave = Time(leav, 0, 0);</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><font color="#000000">Класът<b> <tt>Employee </tt></b></font>съдържа 
членове-данни, които са обекти от клас <b><tt><font color="#000000">Time.</font></tt></b>
<br>
</p>
<hr width="100%">
<p><img src="bullet.gif" align="CENTER"> Достъп до полетата с данни.
<br>** Само членовете-функции имат достъп до скритите полета с данни.
<br><b><tt><font color="#009900"> </font><font color="#006600">  
string Employee::get_name() const</font></tt></b>
<br><b><tt><font color="#006600">    { return name;</font></tt></b>
<br><b><tt><font color="#006600">    }</font></tt></b>
<br><b><tt><font color="#006600">    void Employee::set_salary(double
new_salary)</font></tt></b>
<br><b><tt><font color="#006600">    { salary = new_salary;</font></tt></b>
<br><b><tt><font color="#006600">    }</font></tt></b>
<br><font color="#000000">** Явни и неявни параметри на функции.</font>
<br><font color="#000000">    Отпечатване на името и заплатата
на служител, реализирано с три различни функции:</font>
<br><font color="#000000">-- член-функция с използване на достъп до скритите
данни:</font>
<br><b><tt><font color="#006600">   void Employee::print() const</font></tt></b>
<br><b><tt><font color="#006600">   { cout &lt;&lt; "Name: "
&lt;&lt; name &lt;&lt; "    "</font></tt></b>
<br><b><tt><font color="#006600">         
&lt;&lt; "Salary: " &lt;&lt; salary &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#006600">   }</font></tt></b>
<br><font color="#000000">-- член-функция с използване на член-функции
от същия клас:</font>
<br><b><tt><font color="#006600">   void Employee::print() const</font></tt></b>
<br><b><tt><font color="#006600">   { cout &lt;&lt; "Name: "
&lt;&lt; get_name() &lt;&lt; "    "</font></tt></b>
<br><b><tt><font color="#006600">         
&lt;&lt; "Salary: " &lt;&lt; get_salary() &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#006600">   }</font></tt></b>
<br><font color="#000000">-- външна за класа функция:</font>
<br><b><tt><font color="#009900"> </font><font color="#006600"> 
void print(Employee const &amp;emp)</font></tt></b>
<br><b><tt><font color="#006600">   { cout &lt;&lt; "Name: "
&lt;&lt; emp.get_name() &lt;&lt; "    "</font></tt></b>
<br><b><tt><font color="#006600">         
&lt;&lt; "Salary: " &lt;&lt; emp.get_salary() &lt;&lt; "\n";</font></tt></b>
<br><b><tt><font color="#006600">   }</font></tt></b>
<br>
</p>
<hr width="100%">
<br><img src="bullet.gif" align="CENTER"> Обектно-ориентирано проектиране.
<br>    Процесът от описание на задачата до реализацията
на С++, използвайки обектно-ориентиран подход:
<br>1. Обособяване на обекти и класове.
<br>2. Дефиниране на интерфейс за всеки от тези класове.
<br>3. Реализиране на интерфейса.
<br>4. Комбиниране на обектите, за да се реши задачата.
<br>    Ще илюстрираме този процес с пример: Игра, която
обучава децата да познават часовника.
<br>    Играта се състои в следното. Генерира се случайно
време, рисува се циферблат с това време и се пита играчът колко е часът.
Играчът има право на два опита, преди играта да покаже правилното време.
Когато той познае правилния отговар, точките му се увеличават с 1. Има
4 нива на трудност. Ниво 1 учи на кръглите часове, ниво 2 - на 15-минутни
интервали, ниво 3 - на 5 минутни интервали и ниво 4 - с точност до минута.
Когато играчът постигне 5 точки на едно ниво, играта преминава на следващото
ниво. В началото играта пита за името на играча и желано начално ниво.
След всеки кръг тя пита играча желае ли да играе още. Играта свършва, когато
той отговори отрицателно.
<br>** Обособяване на класовете.
<br>    Търсят се съществителните във формулировката на
задачата - те са кандидатите за класове: играч (<b><tt>Player</tt></b>),
часовник (<b><tt>Clock</tt></b>), време (<b><tt>Time</tt></b>), игра (<b><tt>Game</tt></b>),
кръг (<b><tt>Round</tt></b>), ниво (<b><tt>Level</tt></b>).
<br>** Определяне на интерфейс.
<br>    Определя се какви действия трябва да бъдат извършвани
с обекти от възможните класове.
<table cellpadding="4" cols="2" width="100%">
<tr>
<td valign="TOP">Часовникът трябва да се нарисува и да му се зададе време.</td>

<td valign="TOP">
<table border cellspacing="0" width="100%">
<tr align="CENTER" valign="CENTER">
<td><b><tt><font color="#009900">Clock</font></tt></b></td>
</tr>

<tr>
<td> <b><tt><font color="#009900">draw</font></tt></b>
</td>
</tr>

<tr>
<td> <b><tt><font color="#009900">set_time</font></tt></b>
</td>
</tr>
</table>
</td>
</tr>
</table>

<table cellpadding="4" cols="2" width="100%">
<tr>
<td valign="TOP">Времето трябва да може да се задава с точност до минута;
да се отчитат часовете и минутите и да се сравняват показаното на часовника
и отговора на играча.</td>

<td valign="TOP">
<table border cellspacing="0" width="100%">
<tr align="CENTER" valign="CENTER">
<td><b><tt><font color="#009900">Time</font></tt></b></td>
</tr>

<tr>
<td nowrap>  <b><tt><font color="#009900">Time(hours, minutes)</font></tt></b>
</td>
</tr>

<tr>
<td><b><tt><font color="#009900"> get_hours</font></tt></b></td>
</tr>

<tr>
<td><b><tt><font color="#009900"> get_minutes</font></tt></b></td>
</tr>

<tr>
<td>  <b><tt><font color="#009900">is_same_as(Time)</font></tt></b>
</td>
</tr>
</table>
</td>
</tr>
</table>

<table cellpadding="4" cols="2" width="100%">
<tr>
<td>Играчът има име, ниво и точки. Името и нивото му се задават в началото
на играта. Точките му се увеличават по време на играта и след набиране
на 5 точки се увеличава и нивото му. Ще трябва да се знае и текущото ниво
на играча.</td>

<td valign="TOP">
<table border cellspacing="0" width="100%">
<tr align="CENTER" valign="CENTER">
<td><b><tt><font color="#009900">Player</font></tt></b></td>
</tr>

<tr>
<td nowrap>  <b><tt><font color="#009900">Player(name, initial_level)</font></tt></b>
</td>
</tr>

<tr>
<td><b><tt><font color="#009900"> increment_score</font></tt></b></td>
</tr>

<tr>
<td><b><tt><font color="#009900"> get_level</font></tt></b></td>
</tr>
</table>
</td>
</tr>
</table>

<table cellpadding="4" cols="2" width="100%">
<tr>
<td>Игра: 
<br>получаване на информация за играча 
<br><b><tt>do</tt></b>
<br><b><tt>{ </tt></b>изиграване на кръг 
<br>   питане за продължаване на играта 
<br><b><tt>}</tt></b>
<br><b><tt>while</tt></b> (играчът иска да продължи)</td>

<td valign="TOP">
<table border cellspacing="0" width="100%">
<tr align="CENTER" valign="CENTER">
<td><b><tt><font color="#009900">Game</font></tt></b></td>
</tr>

<tr>
<td>  <b><tt><font color="#009900">play</font></tt></b>
</td>
</tr>

<tr>
<td nowrap><b><tt><font color="#009900"> read_player_information</font></tt></b></td>
</tr>

<tr>
<td><b><tt><font color="#009900"> play_round</font></tt></b></td>
</tr>
</table>
</td>
</tr>
</table>

<p>** Реализиране на интерфейс.
<br>* К<font color="#000000">лас <b><tt>Clock</tt></b>:</font>
<br><b><tt><font color="#006600">class Clock  {</font></tt></b>
<br><b><tt><font color="#006600">public:</font></tt></b>
<br><b><tt><font color="#006600">   Clock();</font></tt></b>
<br><b><tt><font color="#006600">   Clock(Point c, double r);</font></tt></b>
<br><b><tt><font color="#006600">   void set_time(Time t);</font></tt></b>
<br><b><tt><font color="#006600">   void draw() const;</font></tt></b>
<br><b><tt><font color="#006600">private:</font></tt></b>
<br><b><tt><font color="#006600">   Time current_time;</font></tt></b>
<br><b><tt><font color="#006600">   Point center;</font></tt></b>
<br><b><tt><font color="#006600">   double radius;</font></tt></b>
<br><b><tt><font color="#006600">};</font></tt></b>
<br><b><tt><font color="#006600">void Clock::set_time(Time t)</font></tt></b>
<br><b><tt><font color="#006600">{  current_time = t;</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><font color="#000000">    Рисуване на часовник:</font>
<br><font color="#000000">- рисуване на кръг;</font>
<br><font color="#000000">- рисуване на часовите деления;</font>
<br><font color="#000000">- рисуване на минутните деления;</font>
<br><font color="#000000">- рисуване на часовата стрелка;</font>
<br><font color="#000000">- рисуване на минутната стрелка.</font>
<br><font color="#000000">    Рисува часово или минутно
деление:</font>
<br><b><tt><font color="#006600">void Clock::draw_tick(double angle, double
length) const</font></tt></b>
<br><b><tt><font color="#006600">{  double alpha = PI/2 - 6*angle*PI/180;</font></tt></b>
<br><b><tt><font color="#006600">   Point from(center.get_x()
+ cos(alpha)*radius*(1-length),</font></tt></b>
<br><b><tt><font color="#006600">             
center.get_y() + sin(alpha)*radius*(1-length));</font></tt></b>
<br><b><tt><font color="#006600">   Point to(center.get_x() +
cos(alpha)*radius,</font></tt></b>
<br><b><tt><font color="#006600">           
center.get_y() + sin(alpha)*radius);</font></tt></b>
<br><b><tt><font color="#006600">   cwin &lt;&lt; Line(from,
to);</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><font color="#000000">    Рисува стрелка:</font>
<br><b><tt><font color="#006600">void Clock::draw_hand(double angle, double
length) const</font></tt></b>
<br><b><tt><font color="#006600">{  double alpha = PI/2 - 6*angle*PI/180;</font></tt></b>
<br><b><tt><font color="#006600">   Point from = center;</font></tt></b>
<br><b><tt><font color="#006600">   Point to(center.get_x() +
cos(alpha)*radius*length,</font></tt></b>
<br><b><tt><font color="#006600">           
center.get_y() + sin(alpha)*radius*length);</font></tt></b>
<br><b><tt><font color="#006600">   cwin &lt;&lt; Line(from,
to);</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><font color="#000000">Рисува циферблат:</font>
<br><b><tt><font color="#006600">void Clock::draw() const</font></tt></b>
<br><b><tt><font color="#006600">{  cwin &lt;&lt; Circle(center, radius);</font></tt></b>
<br><b><tt><font color="#006600">   int i;</font></tt></b>
<br><b><tt><font color="#006600">   const double HOUR_TICK_LENGTH
= 0.2;</font></tt></b>
<br><b><tt><font color="#006600">   const double MINUTE_TICK_LENGTH
= 0.1;</font></tt></b>
<br><b><tt><font color="#006600">   const double HOUR_HAND_LENGTH
= 0.6;</font></tt></b>
<br><b><tt><font color="#006600">   const double MINUTE_HAND_LENGTH
= 0.75;</font></tt></b>
<br><b><tt><font color="#006600">   for (i = 0; i &lt; 12; i++)</font></tt></b>
<br><b><tt><font color="#006600">   {  draw_tick(i * 5,
HOUR_TICK_LENGTH);</font></tt></b>
<br><b><tt><font color="#006600">      int j;</font></tt></b>
<br><b><tt><font color="#006600">      for (j
= 1; j &lt;= 4; j++)</font></tt></b>
<br><b><tt><font color="#006600">        
draw_tick(i * 5 + j, MINUTE_TICK_LENGTH);</font></tt></b>
<br><b><tt><font color="#006600">   }</font></tt></b>
<br><b><tt><font color="#006600">   draw_hand(current_time.get_minutes(),
MINUTE_HAND_LENGTH);</font></tt></b>
<br><b><tt><font color="#006600">   draw_hand((current_time.get_hours()
+</font></tt></b>
<br><b><tt><font color="#006600">      current_time.get_minutes()
/ 60.0) * 5, HOUR_HAND_LENGTH);</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><font color="#000000">* За времето ще използваме готовия клас <b><tt>Time</tt></b>.</font>
<br>* Кла<font color="#000000">с <b><tt>Player</tt></b>:</font>
<br><b><tt><font color="#006600">class Player  {</font></tt></b>
<br><b><tt><font color="#006600">public:</font></tt></b>
<br><b><tt><font color="#006600">   Player();</font></tt></b>
<br><b><tt><font color="#006600">   Player(string player_name,
int initial_level);</font></tt></b>
<br><b><tt><font color="#006600">   void increment_score();</font></tt></b>
<br><b><tt><font color="#006600">   int get_level() const;</font></tt></b>
<br><b><tt><font color="#006600">   string get_name() const;</font></tt></b>
<br><b><tt><font color="#006600">private:</font></tt></b>
<br><b><tt><font color="#006600">   string name;</font></tt></b>
<br><b><tt><font color="#006600">   int score;</font></tt></b>
<br><b><tt><font color="#006600">   int level;</font></tt></b>
<br><b><tt><font color="#006600">};</font></tt></b>
<br><b><tt><font color="#006600">Player::Player(string player_name, int
initial_level)</font></tt></b>
<br><b><tt><font color="#006600">{  name = player_name;</font></tt></b>
<br><b><tt><font color="#006600">   level = initial_level;</font></tt></b>
<br><b><tt><font color="#006600">   score = 0;</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><b><tt><font color="#006600">int Player::get_level() const</font></tt></b>
<br><b><tt><font color="#006600">{ return level;</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><b><tt><font color="#006600">string Player::get_name() const</font></tt></b>
<br><b><tt><font color="#006600">{ return name;</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><b><tt><font color="#006600">void Player::increment_score()</font></tt></b>
<br><b><tt><font color="#006600">{  score++;</font></tt></b>
<br><b><tt><font color="#006600">   if (score % 5 == 0 and level
&lt; 4) level++;</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br>* Кл<font color="#000000">ас <b><tt>Game</tt></b>:</font>
<br><b><tt><font color="#006600">class Game {</font></tt></b>
<br><b><tt><font color="#006600">public:</font></tt></b>
<br><b><tt><font color="#006600">   Game();</font></tt></b>
<br><b><tt><font color="#006600">   void play();</font></tt></b>
<br><b><tt><font color="#006600">   void read_player_information();</font></tt></b>
<br><b><tt><font color="#006600">   void play_round();</font></tt></b>
<br><b><tt><font color="#006600">private:</font></tt></b>
<br><b><tt><font color="#006600">   Player player;</font></tt></b>
<br><b><tt><font color="#006600">};</font></tt></b>
<br><b><tt><font color="#006600">Game::Game()</font></tt></b>
<br><b><tt><font color="#006600">{ rand_seed();</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><b><tt><font color="#006600">void Game::play()</font></tt></b>
<br><b><tt><font color="#006600">{ read_player_information();</font></tt></b>
<br><b><tt><font color="#006600">  string response;</font></tt></b>
<br><b><tt><font color="#006600">  do</font></tt></b>
<br><b><tt><font color="#006600">  { play_round();</font></tt></b>
<br><b><tt><font color="#006600">    response =</font></tt></b>
<br><b><tt><font color="#006600">    cwin.get_string("Do
you want to play again? (y/n)");</font></tt></b>
<br><b><tt><font color="#006600">  } while (response == "y");</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br><b><tt><font color="#006600">void Game::read_player_information()</font></tt></b>
<br><b><tt><font color="#006600">{  string name = cwin.get_string("What
is your name?");</font></tt></b>
<br><b><tt><font color="#006600">   int initial_level;</font></tt></b>
<br><b><tt><font color="#006600">   do</font></tt></b>
<br><b><tt><font color="#006600">   { initial_level =</font></tt></b>
<br><b><tt><font color="#006600">     cwin.get_int("At
what level do you want to start?(1-4)");</font></tt></b>
<br><b><tt><font color="#006600">   } while (initial_level &lt;
1 or initial_level &gt; 4);</font></tt></b>
<br><b><tt><font color="#006600">   player = Player(name, initial_level);</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br>    Изиграване на кръг:
<br>- генериране на случайно време
<br>- показване на времето
<br>- получаване на отговор
<br>- ако отговорът не е правилен, отново получаване на отговор
<br>- ако отговорът е правилен - поздравления и увеличаване на точките
<br>    Генериране на случайно време:
<br><b><tt><font color="#006600">Time Game::random_time()</font></tt></b>
<br><b><tt><font color="#006600">{  int level = player.get_level();</font></tt></b>
<br><b><tt><font color="#006600">   int minutes;</font></tt></b>
<br><b><tt><font color="#006600">   if (level == 1) minutes =
0;</font></tt></b>
<br><b><tt><font color="#006600">   else if (level == 2) minutes
= 15 * rand_int(0, 3);</font></tt></b>
<br><b><tt><font color="#006600">   else if (level == 3) minutes
= 5 * rand_int(0, 11);</font></tt></b>
<br><b><tt><font color="#006600">   else minutes = rand_int(0,
59);</font></tt></b>
<br><b><tt><font color="#006600">   int hours = rand_int(1, 12);</font></tt></b>
<br><b><tt><font color="#006600">   return Time(hours, minutes,
0);</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br>    Получаване на отговор:
<br><b><tt><font color="#006600">Time Game::get_guess()</font></tt></b>
<br><b><tt><font color="#006600">{  int hours;</font></tt></b>
<br><b><tt><font color="#006600">   do</font></tt></b>
<br><b><tt><font color="#006600">   {  hours = cwin.get_int("Please
enter hours: (1-12)");</font></tt></b>
<br><b><tt><font color="#006600">   } while (hours &lt; 1 or
hours &gt; 12);</font></tt></b>
<br><b><tt><font color="#006600">   int minutes;</font></tt></b>
<br><b><tt><font color="#006600">   do</font></tt></b>
<br><b><tt><font color="#006600">   {  minutes = cwin.get_int("Please
enter minutes: (0-59)");</font></tt></b>
<br><b><tt><font color="#006600">   } while (minutes &lt; 0 or
minutes &gt; 59);</font></tt></b>
</p>
<p><b><tt><font color="#006600">   return Time(hours, minutes,
0);</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br>    Изиграване на кръг:
<br><b><tt><font color="#006600">void Game::play_round()</font></tt></b>
<br><b><tt><font color="#006600">{  cwin.clear();</font></tt></b>
<br><b><tt><font color="#006600">   Time t = random_time();</font></tt></b>
<br><b><tt><font color="#006600">   const double CLOCK_RADIUS
= 5;</font></tt></b>
<br><b><tt><font color="#006600">   Clock clock(Point(0, 0),
CLOCK_RADIUS);</font></tt></b>
<br><b><tt><font color="#006600">   clock.set_time(t);</font></tt></b>
<br><b><tt><font color="#006600">   clock.draw();</font></tt></b>
<br><b><tt><font color="#006600">   Time guess = get_guess();</font></tt></b>
<br><b><tt><font color="#006600">   if (t.seconds_from(guess)
!= 0) guess = get_guess();</font></tt></b>
<br><b><tt><font color="#006600">   string text;</font></tt></b>
<br><b><tt><font color="#006600">   if (t.seconds_from(guess)
== 0)</font></tt></b>
<br><b><tt><font color="#006600">   {  text = "Congratulations,
" + player.get_name()</font></tt></b>
<br><b><tt><font color="#006600">        
+ "! That is correct.";</font></tt></b>
<br><b><tt><font color="#006600">      player.increment_score();</font></tt></b>
<br><b><tt><font color="#006600">   }</font></tt></b>
<br><b><tt><font color="#006600">   else</font></tt></b>
<br><b><tt><font color="#006600">      text =
"Sorry, " + player.get_name()</font></tt></b>
<br><b><tt><font color="#006600">        
+ "! That is not correct.";</font></tt></b>
<br><b><tt><font color="#006600">   cwin &lt;&lt; Message(Point(-CLOCK_RADIUS,
CLOCK_RADIUS + 1),text);</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br>* Главна програма:
<br><b><tt><font color="#006600">int main()</font></tt></b>
<br><b><tt><font color="#006600">{  Game clock_game;</font></tt></b>
<br><b><tt><font color="#006600">   clock_game.play();</font></tt></b>
<br><b><tt><font color="#006600">   return 0;</font></tt></b>
<br><b><tt><font color="#006600">}</font></tt></b>
<br>    Цялата програма е записавна във файла <b><tt>clock.cpp.</tt></b>
<br>
</p>
<hr width="100%">
</body>
</html>
