<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta name="Author" content="Nikolay Kirov">
   <meta name="GENERATOR" content="Mozilla/4.8 [en] (Win95; U) [Netscape]">
   <title>l22</title>
</head>
<body>

<center>
<h3>
<b>22. Наследяване</b>
</h3>
</center>

<div align="right">
<b><i><font size="-1">Ето родословието на Терах:</font></i></b>
<br><b><i><font size="-1">Терах стана баща на Аврам, Нахор и Аран,</font></i></b>
<br><b><i><font size="-1">а Аран стана баща на Лот.</font></i></b>
<br><b><i><font size="-1">Битие 11:27</font></i></b>
</div>
<img src="bullet.gif" height="18" width="20"> Производни класове.
<br>    Наследяването е механизъм за разширяване на вече
съществуващи класове. Новият клас наследява съществуващия, като в него
се добавят нови членове-функции и полета с данни.
<br>    Базов клас:
<br><b><tt><font color="#006600">class Employee {</font></tt></b>
<br><b><tt><font color="#006600">public:</font></tt></b>
<br><b><tt><font color="#006600">   Employee(string emp_name,
double init_salary);</font></tt></b>
<br><b><tt><font color="#006600">   void set_salary(double new_salary);</font></tt></b>
<br><b><tt><font color="#006600">   string get_name() const;</font></tt></b>
<br><b><tt><font color="#006600">   double get_salary() const;</font></tt></b>
<br><b><tt><font color="#006600">   void print() const;</font></tt></b>
<br><b><tt><font color="#006600">private:</font></tt></b>
<br><b><tt><font color="#006600">   string name;</font></tt></b>
<br><b><tt><font color="#006600">   double salary;</font></tt></b>
<br><b><tt><font color="#006600">};</font></tt></b>
<br><font color="#000000">    Производен клас:</font>
<br><b><tt><font color="#006600">class Manager : public Employee {</font></tt></b>
<br><b><tt><font color="#006600">public:</font></tt></b>
<br><b><tt><font color="#006600">   Manager(string n, double
sal, string dept);</font></tt></b>
<br><b><tt><font color="#006600">   string get_department() const;</font></tt></b>
<br><b><tt><font color="#006600">   void print() const;</font></tt></b>
<br><b><tt><font color="#006600">private:</font></tt></b>
<br><b><tt><font color="#006600">   string department;</font></tt></b>
<br><b><tt><font color="#006600">};</font></tt></b>
<br><font color="#000000">    Конструиране на обект от производния
клас:</font>
<br><b><tt><font color="#009900">Manager man("Nino", 670, "Computer Science");</font></tt></b>
<br><font color="#000000">    Извикване на член-функция
от производния клас:</font>
<br><b><tt><font color="#009900">man.set_salary(1200);</font></tt></b>
<br><font color="#000000">    Извикване на член-функция
от базовия клас:</font>
<br><b><tt><font color="#009900">cout &lt;&lt; man.get_department();</font></tt></b>
<br>    Данните в <font color="#000000">производния клас:</font>
<table cols="2" width="100%">
<tr>
<td>
<center><b><tt><font color="#009900">Manager</font></tt></b></center>

<center><table border cellspacing="0">
<tr>
<td>
<center><b><tt>Employee</tt></b></center>

<center><table border cellspacing="0" cellpadding="4">
<tr>
<td>
<b><tt>string name;</tt></b>
<br><b><tt>double salary;</tt></b>
</td>
</tr>
</table></center>

<p><b><tt><font color="#3333FF">string department;</font></tt></b></p>
</td>
</tr>
</table></center>
</td>

<td>
<center><b><tt><font color="#009900">man</font></tt></b></center>

<center><table border cellspacing="0">
<tr>
<td>
<center><b><tt>Employee</tt></b></center>

<center><table border cellspacing="0" cellpadding="4">
<tr>
<td>
<b><tt><font color="#009900">"Nino"</font></tt></b>
<br><b><tt><font color="#009900">670</font></tt></b>
</td>
</tr>
</table></center>

<p><b><tt><font color="#009900">"Computer Science"</font></tt></b></p>
</td>
</tr>
</table></center>
</td>
</tr>
</table>

<p><b><tt><font color="#006600">Employee</font></tt></b> - базов клас,
<tt><font color="#006600"><b>Mana</b>ge</font>r
</tt>-
производен клас
<br>- членовете на базовият клас са членове и на производния клас;
<br>- функциите на производният клас нямат достъп  до частните членове
на базовия клас
<br>
</p>
<hr width="100%">
<p><img src="bullet.gif" height="18" width="20"> Дефиниции на функции от производния
клас.
<br>    Конструкторът на производния клас има две задачи:
<br>- да инициализира полетата с данни;
<br>- да инициализира обекта от базовия клас, който се  съдържа в
производния клас..
<br><b><tt><font color="#009900">  Manager::Manager(string n, double
sal, string dept)</font></tt></b>
<br><b><tt><font color="#009900">         
: Employee(n, sal)</font></tt></b>
<br><b><tt><font color="#009900">  { department = dept;  }</font></tt></b>
</p>
<p>    Ако в базовия и в производния класове има функции
с едно и също име, то викането на член-функция на базовия клас от функция
на производния клас става с помощта на операция "принадлежност към клас"
-<b><tt> ::</tt></b>
<br><b><tt><font color="#009900">  void  Manager::print()</font></tt></b>
<br><b><tt><font color="#009900">  { Employee::print();</font></tt></b>
<br><b><tt><font color="#009900">    cout &lt;&lt; department;
}</font></tt></b>
<br>
</p>
<hr width="100%">
<br>Пример.  Да се изобразят няколко часовника, които показват часа
в различни градове по света. Ще използваме класа <b><tt><font color="#000099">Clock
</font></tt></b>от
11. Класове. Производният клас <b><tt><font color="#000099"> WorldClock</font></tt></b>
включва допълнителна низова данна за името на съответния град.
<p><b><tt><font color="#000099">// clocks.cpp</font></tt></b>
<br><b><tt><font color="#000099">#include "ccc_win.cpp"</font></tt></b>
<br><b><tt><font color="#000099">#include "ccc_time.cpp"</font></tt></b>
<br><b><tt><font color="#000099">const double PI = 3.141592653589793;</font></tt></b>
</p>
<p><b><tt><font color="#000099">class Clock {</font></tt></b>
<br><b><tt><font color="#000099">public:</font></tt></b>
<br><b><tt><font color="#000099">   Clock() {}</font></tt></b>
<br><b><tt><font color="#000099">   Clock(Point c, double r){
center = c; radius = r; }</font></tt></b>
<br><b><tt><font color="#000099">   void set_time(Time t){ current_time
= t; }</font></tt></b>
<br><b><tt><font color="#000099">   void draw() const;</font></tt></b>
<br><b><tt><font color="#000099">private:</font></tt></b>
<br><b><tt><font color="#000099">   void draw_tick(double angle,
double length) const;</font></tt></b>
<br><b><tt><font color="#000099">   void draw_hand(double angle,
double length) const;</font></tt></b>
<br><b><tt><font color="#000099">   Time current_time;</font></tt></b>
<br><b><tt><font color="#000099">   Point center;</font></tt></b>
<br><b><tt><font color="#000099">   double radius;</font></tt></b>
<br><b><tt><font color="#000099">};</font></tt></b>
</p>
<p><b><tt><font color="#000099">void Clock::draw_tick(double angle, double
length) const</font></tt></b>
<br><b><tt><font color="#000099">{ double alpha = PI/2 - 6*angle*PI/180;</font></tt></b>
<br><b><tt><font color="#000099">  Point from(center.get_x() + cos(alpha)*radius*(1-length),</font></tt></b>
<br><b><tt><font color="#000099">            
center.get_y() + sin(alpha)*radius*(1-length));</font></tt></b>
<br><b><tt><font color="#000099">  Point to(center.get_x() + cos(alpha)*radius,</font></tt></b>
<br><b><tt><font color="#000099">          
center.get_y() + sin(alpha)*radius);</font></tt></b>
<br><b><tt><font color="#000099">  cwin &lt;&lt; Line(from, to);</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
</p>
<p><b><tt><font color="#000099">void Clock::draw_hand(double angle, double
length) const</font></tt></b>
<br><b><tt><font color="#000099">{ double alpha = PI/2 - 6*angle*PI/180;</font></tt></b>
<br><b><tt><font color="#000099">  Point from = center;</font></tt></b>
<br><b><tt><font color="#000099">  Point to(center.get_x() + cos(alpha)*radius*length,</font></tt></b>
<br><b><tt><font color="#000099">          
center.get_y() + sin(alpha)*radius*length);</font></tt></b>
<br><b><tt><font color="#000099">  cwin &lt;&lt; Line(from, to);</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
</p>
<p><b><tt><font color="#000099">void Clock::draw() const</font></tt></b>
<br><b><tt><font color="#000099">{ cwin &lt;&lt; Circle(center, radius);</font></tt></b>
<br><b><tt><font color="#000099">  const double HOUR_TICK = 0.2;</font></tt></b>
<br><b><tt><font color="#000099">  const double MINUTE_TICK = 0.1;</font></tt></b>
<br><b><tt><font color="#000099">  const double HOUR_HAND = 0.6;</font></tt></b>
<br><b><tt><font color="#000099">  const double MINUTE_HAND = 0.75;</font></tt></b>
<br><b><tt><font color="#000099">  for (int i = 0; i &lt; 12; i++)</font></tt></b>
<br><b><tt><font color="#000099">  { draw_tick(i * 5, HOUR_TICK);</font></tt></b>
<br><b><tt><font color="#000099">    for (int j = 1; j &lt;=
4; j++) draw_tick(i*5 + j, MINUTE_TICK);</font></tt></b>
<br><b><tt><font color="#000099">  }</font></tt></b>
<br><b><tt><font color="#000099">  draw_hand(current_time.get_minutes(),
MINUTE_HAND);</font></tt></b>
<br><b><tt><font color="#000099">  draw_hand((current_time.get_hours()
+</font></tt></b>
<br><b><tt><font color="#000099">  current_time.get_minutes()/60.0)*5,
HOUR_HAND);</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
</p>
<p><b><tt><font color="#000099">class WorldClock : public Clock {</font></tt></b>
<br><b><tt><font color="#000099">public:</font></tt></b>
<br><b><tt><font color="#000099">   WorldClock() {}</font></tt></b>
<br><b><tt><font color="#000099">   WorldClock(string city_name,
double hour_diff, Point center, double radius);</font></tt></b>
<br><b><tt><font color="#000099">   void draw() const { Clock::draw();
cwin &lt;&lt; city; }</font></tt></b>
<br><b><tt><font color="#000099">private:</font></tt></b>
<br><b><tt><font color="#000099">   Message city;</font></tt></b>
<br><b><tt><font color="#000099">};</font></tt></b>
</p>
<p><b><tt><font color="#000099">WorldClock::WorldClock(string city_name,
double hour_diff, Point center, double radius) : Clock(center, radius)</font></tt></b>
<br><b><tt><font color="#000099">{ Point p = center;</font></tt></b>
<br><b><tt><font color="#000099">  p.move(0, -radius);</font></tt></b>
<br><b><tt><font color="#000099">  city = Message(p, city_name);</font></tt></b>
<br><b><tt><font color="#000099">  Time now;</font></tt></b>
<br><b><tt><font color="#000099">  const double SECONDS_PER_HOUR =
60 * 60;</font></tt></b>
<br><b><tt><font color="#000099">  now.add_seconds(hour_diff * SECONDS_PER_HOUR);</font></tt></b>
<br><b><tt><font color="#000099">  set_time(now);</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
</p>
<p><b><tt><font color="#000099">int main()</font></tt></b>
<br><b><tt><font color="#000099">{ vector&lt;WorldClock&gt; clocks(6);</font></tt></b><b><tt><font color="#000099"></font></tt></b>
</p>
<p><b><tt><font color="#000099">  clocks[0] = WorldClock("San Jose",
16, Point(-6.5, 5), 3);</font></tt></b>
<br><b><tt><font color="#000099">  clocks[1] = WorldClock("Taipei",
7, Point(0, 5), 3);</font></tt></b>
<br><b><tt><font color="#000099">  clocks[2] = WorldClock("Berlin",
1, Point(6.5, 5), 3);</font></tt></b>
<br><b><tt><font color="#000099">  clocks[3] = WorldClock("Cairo",
2, Point(-6.5, -5), 3);</font></tt></b>
<br><b><tt><font color="#000099">  clocks[4] = WorldClock("New York",
19, Point(0, -5), 3);</font></tt></b>
<br><b><tt><font color="#000099">  clocks[5] = WorldClock("Bombay",
4.5, Point(6.5, -5), 3);</font></tt></b><b><tt><font color="#000099"></font></tt></b>
</p>
<p><b><tt><font color="#000099">  for (int i = 0; i &lt; clocks.size();
i++) clocks[i].draw();</font></tt></b>
<br><b><tt><font color="#000099">  return 0;</font></tt></b>
<br><b><tt><font color="#000099">}</font></tt></b>
<br> 
</p>
<center><table border cellspacing="0">
<tr>
<td align="CENTER" valign="CENTER"><img src="clocks.gif" height="480" width="640"></td>
</tr>
</table></center>

<p>
</p>
<hr width="100%">
<br> 
<br> 
</body>
</html>
