<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>l11</title>
</head>
<body>
<h3><font color="#000000">13. </font><font color="#000000">&#1044;&#1080;&#1085;&#1072;&#1084;&#1080;&#1095;&#1085;&#1086;
&#1086;&#1087;&#1090;&#1080;&#1084;&#1080;&#1088;&#1072;&#1085;&#1077; - &#1087;&#1088;&#1086;&#1089;&#1090;&#1080; &#1089;&#1083;&#1091;&#1095;&#1072;&#1080;</font><font color="#000000"> [8]<br>
</font></h3>
<big>** &#1042;&#1098;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1077;
[8.1, &#1089;&#1090;&#1088;. 449]</big>
<br>
<br>
<big>** &#1047;&#1072;&#1076;&#1072;&#1095;&#1072; &#1079;&#1072; &#1088;&#1072;&#1085;&#1080;&#1094;&#1072;&#1090;&#1072; [8.2.1, &#1089;&#1090;&#1088;. 452]</big><b><font
 color="#660000"><br>
</font></b>
<p>&nbsp;&nbsp;<big>&nbsp; &#1050;&#1083;&#1072;&#1089;&#1080;&#1095;&#1077;&#1089;&#1082;&#1072; &#1079;&#1072;&#1076;&#1072;&#1095;&#1072; &#1079;&#1072; &#1088;&#1072;&#1085;&#1080;&#1094;&#1072;&#1090;&#1072;:
<br>
&nbsp;&nbsp;&nbsp; &#1044;&#1072;&#1076;&#1077;&#1085;&#1072; &#1077; &#1088;&#1072;&#1085;&#1080;&#1094;&#1072; &#1089; &#1074;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084;&#1086;&#1089;&#1090; <i>M</i> &#1082;&#1080;&#1083;&#1086;&#1075;&#1088;&#1072;&#1084;&#1072;
&#1080; <i>N</i> &#1087;&#1088;&#1077;&#1076;&#1084;&#1077;&#1090;&#1072;, &#1074;&#1089;&#1077;&#1082;&#1080; &#1086;&#1090; &#1082;&#1086;&#1080;&#1090;&#1086; &#1089;&#1077; &#1093;&#1072;&#1088;&#1072;&#1082;&#1090;&#1077;&#1088;&#1080;&#1079;&#1080;&#1088;&#1072; &#1089; &#1076;&#1074;&#1077; &#1095;&#1080;&#1089;&#1083;&#1072; -
&#1090;&#1077;&#1075;&#1083;&#1086;
<i>m<sub>i</sub></i> &#1080; &#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090; <i>c<sub>i</sub></i>. &#1044;&#1072; &#1089;&#1077; &#1080;&#1079;&#1073;&#1077;&#1088;&#1077;
&#1090;&#1072;&#1082;&#1086;&#1074;&#1072;
&#1084;&#1085;&#1086;&#1078;&#1077;&#1089;&#1090;&#1074;&#1086; &#1086;&#1090; &#1087;&#1088;&#1077;&#1076;&#1084;&#1077;&#1090;&#1080;, &#1095;&#1080;&#1103;&#1090;&#1086; &#1089;&#1091;&#1084;&#1072;&#1088;&#1085;&#1072; &#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090; &#1077; &#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1085;&#1072;, &#1072; &#1089;&#1091;&#1084;&#1072;&#1090;&#1072; &#1086;&#1090;
&#1090;&#1077;&#1075;&#1083;&#1072;&#1090;&#1072; &#1085;&#1077; &#1085;&#1072;&#1076;&#1074;&#1080;&#1096;&#1072;&#1074;&#1072; <i>M</i>.
</big></p>
<p><big>&nbsp;&nbsp;&nbsp; &#1044;&#1077;&#1092;&#1080;&#1085;&#1080;&#1088;&#1072;&#1084;&#1077; &#1088;&#1077;&#1082;&#1091;&#1088;&#1077;&#1085;&#1090;&#1085;&#1072; &#1094;&#1077;&#1083;&#1077;&#1074;&#1072; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;:
</big></p>
<center>
<p><big><i>F</i>(0) = 0;&nbsp; <i>F</i>(<i>i</i>) = max { <i>c<sub>j</sub></i>
+ <i>F</i>(<i>i - m<sub>j</sub></i>),&nbsp; <i>j = </i>1, 2, ..., <i>N</i>,&nbsp;
<i>m<sub>j</sub> &#8804; i </i>},<i> i &gt; </i>0</big></p>
</center>
<p><big>&nbsp;&nbsp;&nbsp; &#1052;&#1077;&#1090;&#1086;&#1076;&#1098;&#1090; &#1085;&#1072; &#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1095;&#1085;&#1086;&#1090;&#1086; &#1086;&#1087;&#1090;&#1080;&#1084;&#1080;&#1088;&#1072;&#1085;&#1077; &#1080;&#1079;&#1080;&#1089;&#1082;&#1074;&#1072;
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1085;&#1086;
&#1087;&#1088;&#1077;&#1089;&#1084;&#1103;&#1090;&#1072;&#1085;&#1077; &#1085;&#1072; &#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090;&#1080;&#1090;&#1077; &#1085;&#1072; <i>F</i>(<i>i</i>), &#1082;&#1072;&#1090;&#1086; &#1079;&#1072; &#1090;&#1086;&#1074;&#1072;
&#1087;&#1088;&#1077;&#1089;&#1084;&#1103;&#1090;&#1072;&#1085;&#1077;
&#1089;&#1077; &#1080;&#1079;&#1087;&#1086;&#1083;&#1079;&#1074;&#1072;&#1090; &#1074;&#1077;&#1095;&#1077; &#1087;&#1088;&#1077;&#1089;&#1084;&#1077;&#1090;&#1085;&#1072;&#1090;&#1080;&#1090;&#1077; &#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090;&#1080; &#1079;&#1072; &#1087;&#1086;-&#1084;&#1072;&#1083;&#1082;&#1080; <i>i</i>.
</big></p>
<p><b><tt><font color="#000099">// knapsack.c</font></tt></b>
<br>
<b><tt><font color="#000099">#include &lt;string.h&gt;</font></tt></b>
<br>
<b><tt><font color="#000099">#include &lt;stdio.h&gt;</font></tt></b>
</p>
<p><b><tt><font color="#000099">#define MAXN 30&nbsp;&nbsp;&nbsp;</font><font
 color="#660000">
/* max &#1073;&#1088;&#1086;&#1081; &#1087;&#1088;&#1077;&#1076;&#1084;&#1077;&#1090;&#1080; */</font></tt></b>
<br>
<b><tt><font color="#000099">#define MAXM 1000&nbsp; </font><font
 color="#660000">/*
max &#1074;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084;&#1086;&#1089;&#1090; &#1085;&#1072; &#1088;&#1072;&#1085;&#1080;&#1094;&#1072;&#1090;&#1072; */</font></tt></b>
</p>
<p><b><tt><font color="#000099">char set[MAXM][MAXN];</font></tt></b>
<br>
<b><tt><font color="#660000">/* &#1072;&#1082;&#1086; set[i][j]==1, &#1090;&#1086; &#1085;&#1072; &#1089;&#1090;&#1098;&#1087;&#1082;&#1072; i
(&#1074;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084;&#1086;&#1089;&#1090;
i) &#1074; &#1088;&#1072;&#1085;&#1080;&#1094;&#1072;&#1090;&#1072; &#1077; &#1087;&#1088;&#1077;&#1076;&#1084;&#1077;&#1090; j */</font></tt></b>
</p>
<p><b><tt><font color="#000099">unsigned Fn[MAXM]; </font><font
 color="#660000">/*
&#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090; &#1085;&#1072; &#1094;&#1077;&#1083;&#1077;&#1074;&#1072;&#1090;&#1072; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; */</font></tt></b>
</p>
<p><b><tt><font color="#660000">/* &#1055;&#1056;&#1045;&#1044;&#1052;&#1045;&#1058;&#1048; */</font></tt></b>
<br>
<b><tt><font color="#000099">const unsigned m[MAXN] = {0, 30, 15, 50,
10, 20, 40, 5, 65}; </font><font color="#660000">/* &#1090;&#1077;&#1075;&#1083;&#1086; */</font></tt></b>
<br>
<b><tt><font color="#000099">const unsigned c[MAXN] = {0,&nbsp;
5,&nbsp;
3,&nbsp; 9,&nbsp; 1,&nbsp; 2,&nbsp; 7, 1, 12}; </font><font
 color="#660000">/*
&#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090; */</font></tt></b>
</p>
<p><b><tt><font color="#000099">const unsigned M = 70; </font><font
 color="#660000">/*
&#1074;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084;&#1086;&#1089;&#1090; &#1085;&#1072; &#1088;&#1072;&#1085;&#1080;&#1094;&#1072;&#1090;&#1072; */</font></tt></b>
<br>
<b><tt><font color="#000099">const unsigned N = 8;&nbsp;</font><font
 color="#660000">
/* &#1073;&#1088;&#1086;&#1081; &#1087;&#1088;&#1077;&#1076;&#1084;&#1077;&#1090;&#1080; */</font></tt></b>
</p>
<p><b><tt><font color="#000099">void calculate(void)</font></tt></b>
<br>
<b><tt><font color="#000099">{ unsigned maxValue, maxIndex, i, j;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; memset(set,0,sizeof(set)); </font><font
 color="#660000">/*
set[i][j] = 0 */</font></tt></b>
</p>
<p><b><tt><font color="#000099">&nbsp; for (i=1; i&lt;=M; i++)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; { maxValue = maxIndex = 0;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; for (j=1; j&lt;=N;
j++)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font
 color="#660000">
/* &#1086;&#1087;&#1080;&#1090; &#1089; &#1087;&#1088;&#1077;&#1076;&#1084;&#1077;&#1090;&#1072; &#1089; &#1085;&#1086;&#1084;&#1077;&#1088; j */</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp; if (m[j]&lt;=i
&amp;&amp; !set[i-m[j]][j])</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (c[j]
+ Fn[i-m[j]] &gt; maxValue)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; { maxValue = c[j] +
Fn[i-m[j]];</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxIndex
= j;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; }</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; if
(maxIndex&gt;0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font
 color="#660000">
/* &#1080;&#1084;&#1072; &#1091;&#1089;&#1087;&#1077;&#1096;&#1077;&#1085; &#1086;&#1087;&#1080;&#1090; */</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; { Fn[i] = maxValue;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
memcpy(set[i],set[i-m[maxIndex]],
N);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
set[i][maxIndex]
= 1;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; }</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; if (Fn[i] &lt; Fn[i-1])</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; { Fn[i] = Fn[i-1];</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
memcpy(set[i],set[i-1],
N);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp; }</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; }</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; printf("No:");</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; for (i=1; i&lt;=N; i++)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp; if (set[M][i])
printf("%5u", i);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; printf("\n Max value: %u", Fn[M]);</font></tt></b>
<br>
<b><tt><font color="#000099">}</font></tt></b>
</p>
<p><b><tt><font color="#000099">int main()</font></tt></b>
<br>
<b><tt><font color="#000099">{ calculate();</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; return 0;</font></tt></b>
<br>
<b><tt><font color="#000099">}</font></tt></b>
<br>
<font color="#000000">&nbsp;&nbsp;&nbsp; <big>&#1044;&#1072; &#1088;&#1072;&#1079;&#1075;&#1083;&#1077;&#1076;&#1072;&#1084;&#1077; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1072;:</big></font><big>
<br>
<b><tt><font color="#000000">N = 8;</font></tt></b>
<br>
<b><tt><font color="#000000">index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;
1&nbsp; 2&nbsp; 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; 7&nbsp; 8</font></tt></b>
<br>
<b><tt><font color="#000000">m[MAXN] = {0, 3, 7, 6, 1, 2, 4, 5, 5};</font></tt></b>
<br>
<b><tt><font color="#000000">c[MAXN] = {0, 5, 3, 9, 1, 1, 2, 5, 2}</font></tt></b>
<br>
<b><tt><font color="#000000">M = 7;</font></tt></b></big>
</p>
<p><big><b><tt><font color="#000000">Fn[0] = 0;</font></tt></b>
<br>
<b><tt><font color="#000000">Fn[1] = max { </font><font color="#993300">c[4]+Fn[0]</font><font
 color="#000000">
} = 1 /4/</font></tt></b>
<br>
<b><tt><font color="#000000">Fn[2] = max { </font><font color="#993300">c[5]+Fn[0]</font><font
 color="#000000">
} = 1 /5/</font></tt></b>
<br>
<b><tt><font color="#000000">Fn[3] = max { </font><font color="#993300">c[1]+Fn[0]</font><font
 color="#000000">,
c[4]+Fn[2], c[5]+Fn[1] } = max{5,3,2} = 5 /1/</font></tt></b>
<br>
<b><tt><font color="#000000">Fn[4] = max { </font><font color="#993300">c[1]+Fn[1]</font><font
 color="#000000">,
c[4]+Fn[3], c[6]+Fn[0] } = max{6,6,2} = 6 /1,4/</font></tt></b>
<br>
<b><tt><font color="#000000">Fn[5] = max { </font><font color="#993300">c[1]+Fn[2]</font><font
 color="#000000">,
c[5]+Fn[3], c[6]+Fn[1], c[7]+Fn[0], c[8]+Fn[0] } = max{</font><font
 color="#993300">6</font><font color="#000000">,6,3,5,2}
= 6 /1,5/</font></tt></b>
<br>
<b><tt><font color="#000000">Fn[6] = max { </font><font color="#993300">c[3]+Fn[0]</font><font
 color="#000000">,
c[4]+Fn[5], c[5]+Fn[4], c[6]+Fn[2], c[7]+Fn[2], c[8]+Fn[1] } = max{</font><font
 color="#993300">9+0</font><font color="#000000">,1+5,1+6,2+1,5+1,2+1}
= 9 /3/</font></tt></b>
<br>
<b><tt><font color="#000000">Fn[7] = max { c[2]+Fn[0], </font><font
 color="#993300">c[3]+Fn[1]</font><font color="#000000">,
c[4]+Fn[6], c[6]+Fn[5], c[7]+Fn[2], c[8]+Fn[5] } = {5+0,</font><font
 color="#993300">9+1</font><font color="#000000">,1+9,2+6,5+1,2+6}
= 10 /3,4/<br>
</font></tt></b></big></p>
<hr style="width: 100%; height: 2px;"><big><b>**</b> &#1053;&#1072;&#1081;-&#1076;&#1098;&#1083;&#1075;&#1072; &#1086;&#1073;&#1097;&#1072;
&#1087;&#1086;&#1076;&#1088;&#1077;&#1076;&#1080;&#1094;&#1072;
[8.2.6, &#1089;&#1090;&#1088;. 479]<br>
&nbsp;&nbsp;&nbsp; &#1044;&#1072;&#1076;&#1077;&#1085;&#1080; &#1089;&#1072; &#1076;&#1074;&#1077; &#1095;&#1080;&#1089;&#1083;&#1086;&#1074;&#1080; &#1088;&#1077;&#1076;&#1080;&#1094;&#1080;:
</big>
<center><big><i>X = </i>(<i>x</i><sub>1</sub>, <i>x</i><sub>2</sub>,
..., <i>x<sub>m</sub></i>)<i><sub>
</sub></i>&#1080;&nbsp; <i>Y</i> = ( <i>y</i><sub>1</sub>, <i>y</i><sub>2</sub>,
..., <i>y<sub>n</sub></i>)</big></center>
<big>&nbsp;&nbsp;&nbsp; &#1058;&#1098;&#1088;&#1089;&#1080; &#1089;&#1077; &#1085;&#1072;&#1081;-&#1076;&#1098;&#1083;&#1075;&#1072; &#1088;&#1077;&#1076;&#1080;&#1094;&#1072;&nbsp; <i>Z = </i>(<i>z</i><sub>1</sub>,
<i>z</i><sub>2</sub>,
..., <i>z<sub>k</sub></i>), &#1082;&#1086;&#1103;&#1090;&#1086; &#1077; &#1087;&#1086;&#1076;&#1088;&#1077;&#1076;&#1080;&#1094;&#1072; &#1085;&#1072; <i>X&nbsp;<sub> </sub></i>&#1080;
<i>Y</i>
&#1077;&#1076;&#1085;&#1086;&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;. <i>Z </i>&#1077; &#1087;&#1086;&#1076;&#1088;&#1077;&#1076;&#1080;&#1094;&#1072; &#1085;&#1072;&nbsp; <i>X</i>, &#1072;&#1082;&#1086; <i>Z
</i>&#1084;&#1086;&#1078;&#1077;
&#1076;&#1072; &#1073;&#1098;&#1076;&#1077; &#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1072; &#1095;&#1088;&#1077;&#1079; &#1087;&#1088;&#1077;&#1084;&#1072;&#1093;&#1074;&#1072;&#1085;&#1077; &#1085;&#1072; (0 &#1080;&#1083;&#1080; &#1085;&#1103;&#1082;&#1086;&#1083;&#1082;&#1086;) &#1095;&#1083;&#1077;&#1085;&#1086;&#1074;&#1077; &#1085;&#1072; <i>X</i>.
&#1053;&#1072;&#1081;-&#1085;&#1072;&#1087;&#1088;&#1077;&#1076; &#1097;&#1077; &#1090;&#1098;&#1088;&#1089;&#1080;&#1084; &#1089;&#1072;&#1084;&#1086; &#1076;&#1098;&#1083;&#1078;&#1080;&#1085;&#1072;&#1090;&#1072; &#1085;&#1072; &#1085;&#1072;&#1081;-&#1076;&#1098;&#1083;&#1075;&#1072;&#1090;&#1072; &#1086;&#1073;&#1097;&#1072; &#1087;&#1086;&#1076;&#1088;&#1077;&#1076;&#1080;&#1094;&#1072;. &#1065;&#1077;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1080;&#1084;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1072; &#1085;&#1072; &#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1095;&#1085;&#1086;&#1090;&#1086; &#1086;&#1087;&#1090;&#1080;&#1084;&#1080;&#1088;&#1072;&#1085;&#1077;, &#1082;&#1072;&#1090;&#1086; <i>F</i>(<i>i, j</i>) &#1077;
&#1090;&#1098;&#1088;&#1089;&#1077;&#1085;&#1072;&#1090;&#1072;
&#1076;&#1098;&#1083;&#1078;&#1080;&#1085;&#1072; &#1079;&#1072; &#1087;&#1098;&#1088;&#1074;&#1080;&#1090;&#1077; <i>i</i> &#1095;&#1083;&#1077;&#1085;&#1072; &#1085;&#1072; &#1088;&#1077;&#1076;&#1080;&#1094;&#1072;&#1090;&#1072; <i>X</i> &#1080; &#1087;&#1098;&#1088;&#1074;&#1080;&#1090;&#1077;
<i>j</i>
&#1095;&#1083;&#1077;&#1085;&#1072; &#1085;&#1072; &#1088;&#1077;&#1076;&#1080;&#1094;&#1072;&#1090;&#1072; <i>Y</i>. &#1054;&#1095;&#1077;&#1074;&#1080;&#1076;&#1085;&#1086;
<i>F</i>(<i>i,</i>0) = 0 &#1079;&#1072; &#1074;&#1089;&#1103;&#1082;&#1086;
<i>i</i> &#1080; <i>F</i>(0<i>, j</i>) = 0 &#1079;&#1072; &#1074;&#1089;&#1103;&#1082;&#1086; <i>j</i>. <i>F</i>(<i>i,
j</i>) = <i>F</i>(<i>i-</i>1<i>, j-</i>1) + 1 &#1079;&#1072; <i>x</i><sub>i</sub>
=
<i>y<sub>j</sub></i>,
&#1072; <i>F</i>(<i>i, j</i>) = max {<i>F</i>(<i>i-</i>1<i>, j</i>), <i>F</i>(<i>i,
j-</i>1)} &#1074; &#1087;&#1088;&#1086;&#1090;&#1080;&#1074;&#1077;&#1085; &#1089;&#1083;&#1091;&#1095;&#1072;&#1081;. &#1053;&#1072;&#1084;&#1080;&#1088;&#1072;&#1084;&#1077; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1085;&#1086; &#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090;&#1080;&#1090;&#1077; &#1085;&#1072; <i>F</i>(<i>i,
j</i>) &#1080; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1072;&#1090;&#1072; &#1085;&#1072;&#1084;&#1077;&#1088;&#1077;&#1085;&#1072; &#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090; <i>F</i>(<i>m,n</i>) &#1077; &#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1077;&#1090;&#1086;
&#1085;&#1072; &#1079;&#1072;&#1076;&#1072;&#1095;&#1072;&#1090;&#1072;.
<br>
&nbsp;&nbsp;&nbsp; &#1053;&#1072;&#1084;&#1080;&#1088;&#1072;&#1085;&#1077;&#1090;&#1086; &#1085;&#1072; &#1077;&#1076;&#1085;&#1072; &#1085;&#1072;&#1081;-&#1076;&#1098;&#1083;&#1075;&#1072; &#1087;&#1086;&#1076;&#1088;&#1077;&#1076;&#1080;&#1094;&#1072; &#1089;&#1090;&#1072;&#1074;&#1072; &#1087;&#1086;
&#1089;&#1098;&#1097;&#1080;&#1103; &#1085;&#1072;&#1095;&#1080;&#1085;, &#1082;&#1072;&#1090;&#1086; &#1090;&#1088;&#1098;&#1075;&#1074;&#1072;&#1084;&#1077; &#1086;&#1090; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1103; &#1077;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090; &#1080; &#1089;&#1083;&#1077;&#1076;&#1080;&#1084; &#1086;&#1090;&#1082;&#1098;&#1076;&#1077; &#1080;&#1076;&#1074;&#1072;
&#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1085;&#1072;&#1090;&#1072;
&#1089;&#1090;&#1086;&#1081;&#1085;&#1086;&#1089;&#1090;.</big>
<p><big><b><tt><font color="#000099">//</font><font color="#660000">
lsc.c</font></tt></b>
<br>
<b><tt><font color="#000099">#include &lt;stdio.h&gt;</font></tt></b>
<br>
<b><tt><font color="#000099">#include &lt;string.h&gt;</font></tt></b>
<br>
<b><tt><font color="#000099">#define MAXN 100</font></tt></b>
<br>
<b><tt><font color="#000099">#define MAX(a,b) (((a)&gt;(b)) ? (a) : (b))</font></tt></b>
</big></p>
<p><big><b><tt><font color="#000099">char F[MAXN][MAXN];</font></tt></b>
</big></p>
<p><big><b><tt><font color="#000099">const char x[MAXN] = "acbcacbcaba";</font></tt></b>
<br>
<b><tt><font color="#000099">const char y[MAXN] = "abacacacababa";</font></tt></b>
<br>
<b><tt><font color="#000099">unsigned m,n;</font></tt></b>
<br>
<b><tt><font color="#000099">/*</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"acb cacbcaba&nbsp; "&nbsp;&nbsp; "a&nbsp; cbcac bcaba"</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"a bacacacababa"&nbsp;&nbsp; "abacacacab aba"</font></tt></b>
<br>
<b><tt><font color="#000099">solution "a b cac caba&nbsp; "&nbsp;&nbsp;
"a&nbsp; c cac b aba"</font></tt></b>
<br>
<b><tt><font color="#000099">*/</font></tt></b>
<br>
<b><tt><font color="#000099">unsigned lcs_len(void)</font></tt></b>
<br>
<b><tt><font color="#000099">{ unsigned i,j;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; for (i=0; i&lt;=m; i++) F[i][0]
= 0;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; for (j=0; j&lt;=n; j++) F[0][j]
= 0;</font></tt></b>
</big></p>
<p><big><b><tt><font color="#000099">&nbsp; for (i=1; i&lt;=m; i++)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp; for (j=1;
j&lt;=n;
j++)</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;if (x[i-1] == y[j-1])
F[i][j]=F[i-1][j-1]+1;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;else F[i][j] = MAX(F[i-1][j],
F[i][j-1]);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; return F[m][n];</font></tt></b>
<br>
<b><tt><font color="#000099">}</font></tt></b>
</big></p>
<p><big><b><tt><font color="#000099">void print(unsigned i, unsigned j)</font></tt></b>
<br>
<b><tt><font color="#000099">{ if (i==0 || j==0) return;</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; if (x[i-1] == y[j-1])</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; {&nbsp; print(i-1,j-1);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp; printf("%c",
x[i-1]);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; }</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; else if (F[i][j] == F[i-1][j])
print(i-1,j);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; else print(i,j-1);</font></tt></b>
<br>
<b><tt><font color="#000099">}</font></tt></b>
</big></p>
<p><big><b><tt><font color="#000099">int main()</font></tt></b>
<br>
<b><tt><font color="#000099">{ m = strlen(x); n = strlen(y);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; printf("%u\n", lcs_len());</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; print(m,n);</font></tt></b>
<br>
<b><tt><font color="#000099">&nbsp; return 0;</font></tt></b>
<br>
<b><tt><font color="#000099">}</font></tt></b>
</big><br>
&nbsp;
<table style="width: 100%;" border="1" cellpadding="4" cellspacing="1">
  <tbody>
    <tr>
      <td><big><b><tt><font color="#006600">9</font></tt></b> <br>
      <b><tt><font color="#006600">accacbaba</font></tt></b></big></td>
    </tr>
  </tbody>
</table>
</p>
<hr style="width: 100%; height: 2px;"><big><font color="#000000">&#1047;&#1072;&#1076;&#1072;&#1095;&#1072;,
&#1076;&#1072;&#1076;&#1077;&#1085;&#1072; &#1085;&#1072; &#1064;&#1077;&#1089;&#1090;&#1080; &#1084;&#1077;&#1078;&#1076;&#1091;&#1091;&#1085;&#1080;&#1074;&#1077;&#1088;&#1089;&#1080;&#1090;&#1077;&#1090;&#1089;&#1082;&#1080; &#1090;&#1091;&#1088;&#1085;&#1080;&#1088;
&#1087;&#1086; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1080;&#1088;&#1072;&#1085;&#1077; - &#1064;&#1091;&#1084;&#1077;&#1085;, 10 &#1084;&#1072;&#1081; 2003 &#1075;.</font></big>
<p><big><span style="font-weight: bold;">&#1047;&#1072;&#1076;&#1072;&#1095;&#1072; 13a.</span> <font
 style="font-weight: bold;" color="#000000">&#1047;&#1072;&#1081;&#1095;&#1077; &#1074; &#1073;&#1077;&#1076;&#1072;</font></big>
</p>
<p><big><font color="#000000">&nbsp;&nbsp;&nbsp; &#1042;&#1077;&#1076;&#1085;&#1098;&#1078; &#1084;&#1072;&#1083;&#1082;&#1086;&#1090;&#1086; &#1073;&#1103;&#1083;&#1086;
&#1079;&#1072;&#1081;&#1095;&#1077;,
&#1075;&#1086;&#1085;&#1077;&#1085;&#1086; &#1086;&#1090; &#1077;&#1076;&#1080;&#1085; &#1083;&#1086;&#1074;&#1077;&#1094; &#1087;&#1086;&#1087;&#1072;&#1076;&#1085;&#1072;&#1083;&#1086; &#1074; &#1075;&#1086;&#1088;&#1085;&#1080;&#1103; &#1083;&#1103;&#1074; &#1098;&#1075;&#1098;&#1083; &#1085;&#1072; &#1083;&#1072;&#1073;&#1080;&#1088;&#1080;&#1085;&#1090;, &#1082;&#1086;&#1080;&#1090;&#1086;
&#1080;&#1084;&#1072;&#1083;
&#1092;&#1086;&#1088;&#1084;&#1072; &#1085;&#1072; &#1082;&#1074;&#1072;&#1076;&#1088;&#1072;&#1090;&#1085;&#1072; &#1076;&#1098;&#1089;&#1082;&#1072; <i>N</i> x <i>N</i>. &#1042; &#1085;&#1077;&#1075;&#1086; &#1095;&#1072;&#1082;&#1072;&#1083; &#1075;&#1086;&#1083;&#1077;&#1084;&#1080;&#1103;
&#1083;&#1086;&#1096;
&#1074;&#1098;&#1083;&#1082;, &#1082;&#1086;&#1080;&#1090;&#1086; &#1087;&#1088;&#1077;&#1076;&#1074;&#1072;&#1088;&#1080;&#1090;&#1077;&#1083;&#1085;&#1086; &#1080;&#1079;&#1082;&#1086;&#1087;&#1072;&#1083; &#1076;&#1091;&#1087;&#1082;&#1080;, &#1082;&#1098;&#1076;&#1077;&#1090;&#1086; &#1079;&#1072;&#1081;&#1095;&#1077;&#1090;&#1086; &#1076;&#1072; &#1087;&#1072;&#1076;&#1085;&#1077;, &#1072; &#1090;&#1086;&#1081;
&#1076;&#1072; &#1075;&#1086; &#1093;&#1074;&#1072;&#1085;&#1077; &#1087;&#1086;-&#1083;&#1077;&#1089;&#1085;&#1086;. &#1042; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1103; &#1084;&#1086;&#1084;&#1077;&#1085;&#1090; &#1079;&#1072;&#1081;&#1095;&#1077;&#1090;&#1086; &#1089; &#1091;&#1078;&#1072;&#1089; &#1088;&#1072;&#1079;&#1073;&#1088;&#1072;&#1083;&#1086;, &#1095;&#1077;
&#1084;&#1086;&#1078;&#1077;
&#1076;&#1072; &#1089;&#1077; &#1076;&#1074;&#1080;&#1078;&#1080; &#1089;&#1072;&#1084;&#1086; &#1074; &#1087;&#1086;&#1089;&#1086;&#1082;&#1072; &#1085;&#1072;&#1076;&#1086;&#1083;&#1091; &#1080; &#1085;&#1072;&#1076;&#1103;&#1089;&#1085;&#1086;, &#1080; &#1095;&#1077; &#1080;&#1079;&#1093;&#1086;&#1076;&#1072; &#1086;&#1090; &#1083;&#1072;&#1073;&#1080;&#1088;&#1080;&#1085;&#1090;&#1072; &#1077;
&#1095;&#1072;&#1082; &#1074; &#1076;&#1086;&#1083;&#1085;&#1080;&#1103; &#1076;&#1077;&#1089;&#1077;&#1085; &#1098;&#1075;&#1098;&#1083; &#1085;&#1072; &#1076;&#1098;&#1089;&#1082;&#1072;&#1090;&#1072;.</font>
<br>
<font color="#000000">&nbsp;&nbsp;&nbsp; &#1047;&#1072;&#1081;&#1095;&#1077;&#1090;&#1086; &#1090;&#1088;&#1103;&#1073;&#1074;&#1072;&#1083;&#1086; &#1076;&#1072; &#1088;&#1072;&#1079;&#1073;&#1077;&#1088;&#1077;
&#1082;&#1072;&#1082;&#1074;&#1072; &#1077; &#1074;&#1077;&#1088;&#1086;&#1103;&#1090;&#1085;&#1086;&#1089;&#1090;&#1090;&#1072; &#1076;&#1072; &#1080;&#1079;&#1083;&#1077;&#1079;&#1077; &#1086;&#1090; &#1083;&#1072;&#1073;&#1080;&#1088;&#1080;&#1085;&#1090;&#1072; &#1073;&#1077;&#1079; &#1076;&#1072; &#1087;&#1072;&#1076;&#1085;&#1077; &#1074; &#1085;&#1103;&#1082;&#1086;&#1103; &#1076;&#1091;&#1087;&#1082;&#1072;.
&#1047;&#1072; &#1094;&#1077;&#1083;&#1090;&#1072; &#1090;&#1088;&#1103;&#1073;&#1074;&#1072;&#1083;&#1086; &#1076;&#1072; &#1080;&#1079;&#1095;&#1080;&#1089;&#1083;&#1080; &#1073;&#1088;&#1086;&#1103; &#1087;&#1098;&#1090;&#1080;&#1097;&#1072; &#1086;&#1090; &#1074;&#1093;&#1086;&#1076;&#1072; &#1076;&#1086; &#1080;&#1079;&#1093;&#1086;&#1076;&#1072; &#1085;&#1072;
&#1083;&#1072;&#1073;&#1080;&#1088;&#1080;&#1085;&#1090;&#1072;,
&#1082;&#1072;&#1090;&#1086; &#1091;&#1089;&#1087;&#1103;&#1083;&#1086; &#1076;&#1072; &#1089;&#1077; &#1089;&#1085;&#1072;&#1073;&#1076;&#1080; &#1089; &#1082;&#1072;&#1088;&#1090;&#1072;&#1090;&#1072; &#1085;&#1072; &#1090;&#1086;&#1079;&#1080; &#1083;&#1072;&#1073;&#1080;&#1088;&#1080;&#1085;&#1090;. &#1052;&#1077;&#1089;&#1090;&#1072;&#1090;&#1072; &#1085;&#1072; &#1076;&#1091;&#1087;&#1082;&#1080;&#1090;&#1077;
&#1085;&#1072; &#1082;&#1072;&#1088;&#1090;&#1072;&#1090;&#1072; &#1089;&#1072; &#1086;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080; &#1089; 0, &#1072; &#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1080;&#1084;&#1080;&#1090;&#1077; &#1084;&#1077;&#1089;&#1090;&#1072; &#1089; 1. &#1053;&#1072;&#1087;&#1080;&#1096;&#1077;&#1090;&#1077; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1072;
</font><font color="#000000"><span style="font-family: monospace;">F.EXE</span></font><font
 color="#000000">, &#1082;&#1086;&#1103;&#1090;&#1086; &#1087;&#1088;&#1077;&#1089;&#1084;&#1103;&#1090;&#1072; &#1090;&#1098;&#1088;&#1089;&#1077;&#1085;&#1080;&#1103; &#1073;&#1088;&#1086;&#1081; &#1087;&#1098;&#1090;&#1080;&#1097;&#1072;.</font>
<br>
<font color="#000000">&nbsp;&nbsp;&nbsp; &#1044;&#1072;&#1085;&#1085;&#1080;&#1090;&#1077; &#1089;&#1077; &#1095;&#1077;&#1090;&#1072;&#1090; &#1086;&#1090;
&#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1080;&#1103;
&#1074;&#1093;&#1086;&#1076;, &#1082;&#1098;&#1076;&#1077;&#1090;&#1086; &#1085;&#1072; &#1087;&#1098;&#1088;&#1074;&#1080;&#1103; &#1088;&#1077;&#1076; &#1077; &#1079;&#1072;&#1087;&#1080;&#1089;&#1072;&#1085;&#1086; &#1094;&#1103;&#1083;&#1086;&#1090;&#1086; &#1095;&#1080;&#1089;&#1083;&#1086; <i>&#1050;</i> - &#1073;&#1088;&#1086;&#1103; &#1085;&#1072;
&#1090;&#1077;&#1089;&#1090;&#1086;&#1074;&#1080;&#1090;&#1077;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1080;, &#1072; &#1079;&#1072; &#1074;&#1089;&#1077;&#1082;&#1080; &#1090;&#1077;&#1089;&#1090;&#1086;&#1074; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088; &#1089;&#1077; &#1076;&#1072;&#1074;&#1072; &#1095;&#1080;&#1089;&#1083;&#1086;&#1090;&#1086; <i>N &lt;= </i>40;&nbsp;
&#1089;&#1083;&#1077;&#1076;&#1074;&#1072;&#1090; <i>N</i> &#1088;&#1077;&#1076;&#1072; &#1089; &#1087;&#1086; <i>N</i> &#1095;&#1080;&#1089;&#1083;&#1072;, &#1082;&#1072;&#1090;&#1086; &#1085;&#1072; &#1074;&#1089;&#1103;&#1082;&#1072; &#1082;&#1083;&#1077;&#1090;&#1082;&#1072;
&#1089;&#1098;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1072;
&#1087;&#1086; &#1077;&#1076;&#1085;&#1086; &#1095;&#1080;&#1089;&#1083;&#1086; 1 &#1080;&#1083;&#1080; 0 (&#1087;&#1088;&#1086;&#1093;&#1086;&#1076;&#1080;&#1084;&#1072; &#1082;&#1083;&#1077;&#1090;&#1082;&#1072; &#1080;&#1083;&#1080; &#1076;&#1091;&#1087;&#1082;&#1072;).</font>
<br>
<font color="#000000">&nbsp;&nbsp;&nbsp; &#1053;&#1072; &#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1080;&#1103; &#1080;&#1079;&#1093;&#1086;&#1076; &#1089;&#1077;
&#1080;&#1079;&#1074;&#1077;&#1078;&#1076;&#1072;&#1090;
<i>&#1050;</i> &#1095;&#1080;&#1089;&#1083;&#1072; - &#1087;&#1086; &#1077;&#1076;&#1085;&#1086; &#1079;&#1072; &#1074;&#1089;&#1077;&#1082;&#1080; &#1090;&#1077;&#1089;&#1090;&#1086;&#1074; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1087;&#1086;&#1082;&#1072;&#1079;&#1074;&#1072;&#1097;&#1080; &#1073;&#1088;&#1086;&#1103; &#1085;&#1072;
&#1087;&#1098;&#1090;&#1080;&#1097;&#1072;&#1090;&#1072;
&#1079;&#1072; &#1089;&#1098;&#1086;&#1090;&#1074;&#1077;&#1090;&#1085;&#1080;&#1103; &#1090;&#1077;&#1089;&#1090;&#1086;&#1074; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;. &#1042;&#1089;&#1103;&#1082;&#1086; &#1077;&#1076;&#1085;&#1086; &#1086;&#1090; &#1095;&#1080;&#1089;&#1083;&#1072;&#1090;&#1072; &#1089;&#1077; &#1080;&#1079;&#1074;&#1077;&#1078;&#1076;&#1072; &#1085;&#1072;
&#1086;&#1090;&#1076;&#1077;&#1083;&#1077;&#1085;
&#1088;&#1077;&#1076;.</font>
</big></p>
<p><big><font color="#000000">&#1055;&#1088;&#1080;&#1084;&#1077;&#1088;.</font></big>
<table style="width: 100%; text-align: left;" border="0" cellpadding="0"
 cellspacing="0" cols="2">
  <tbody>
    <tr>
      <td><big><font color="#000000">&#1042;&#1093;&#1086;&#1076;:</font> <br>
      <b style="font-family: monospace;"><font color="#000000">1</font></b><span
 style="font-family: monospace;"> </span><br
 style="font-family: monospace;">
      <b style="font-family: monospace;"><font color="#000000">4&nbsp;&nbsp;&nbsp;</font></b><span
 style="font-family: monospace;"> </span><br
 style="font-family: monospace;">
      <b style="font-family: monospace;"><font color="#000000">1 1 1
1&nbsp;</font></b><span style="font-family: monospace;"> </span><br
 style="font-family: monospace;">
      <b style="font-family: monospace;"><font color="#000000">1 1 0 1</font></b><span
 style="font-family: monospace;"> </span><br
 style="font-family: monospace;">
      <b style="font-family: monospace;"><font color="#000000">1 0 1 1</font></b><span
 style="font-family: monospace;"> </span><br
 style="font-family: monospace;">
      <b style="font-family: monospace;"><font color="#000000">1 1 1 1</font></b></big></td>
      <td valign="top"><big><font color="#000000">&#1048;&#1079;&#1093;&#1086;&#1076;:</font> <br>
      <b><tt><font color="#000000">2</font></tt></b></big></td>
    </tr>
  </tbody>
</table>
</p>
<hr style="width: 100%; height: 2px;">
<p><big><br>
Second International Programming Contest - March 28, 2004, Blagoevgrad,
Bulgaria<br>
<br>
</big><big><span style="font-weight: bold;">&#1047;&#1072;&#1076;&#1072;&#1095;&#1072; 13b. </span></big><big>Winnie-the-Pooh<br>
<p>One day Winnie-the-Pooh decided to go to his friend Piglet. As his
custom he wanted to give a present to Piglet. Because he lived in the
forest, Pooh decided to take as much acorns as he could on his way to
Piglet. You are asked to help Pooh. Note that the forest is a square (<span
 style="font-style: italic;">M</span> x<span style="font-style: italic;">
M</span>, 3 &lt; <span style="font-style: italic;">M</span> &lt; 101).
Pooh's house is the leftmost and uppermost cell, Piglet's house is the
rightmost and bottom most cell. The number <span
 style="font-style: italic;">N</span> means that there are <span
 style="font-style: italic;">N</span> acorns in the cell, for <span
 style="font-style: italic;">N</span> = 0, 1, 2, 3, 4. The path begins
in cell (1, 1) and ends in cell (<span style="font-style: italic;">M</span>,
<span style="font-style: italic;">M</span>). Pooh can go from one cell
to another if they have a common side and must arrive at Piglet's house
as soon as possible (i.e. visiting exact 2<span
 style="font-style: italic;">M -</span> 1 cells).</p>
<p>Input<br>
The first line of input contains a single number <span
 style="font-style: italic;">N</span> - number of tests. The next lines
are tests. The first line of each test contains a single number <span
 style="font-style: italic;">M</span>. Each of the next <span
 style="font-style: italic;">M</span> lines contains <span
 style="font-style: italic;">M</span> numbers - the number found on the
<span style="font-style: italic;">j</span>-th position on the <span
 style="font-style: italic;">i</span>-th line represent a cell (<span
 style="font-style: italic;">i</span>, <span
 style="font-style: italic;">j</span>). </p>
<p>
Output<br>
You should output a single number on a single line for each test - the
maximum possible amount of acorns collected by Pooh and given to
Piglet. </p>
</big></p>
<table style="width: 100%; text-align: left;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;"><big>Sample Input<br>
      <span style="font-family: monospace;">2 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">3 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">0 1 1 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">0 4 2 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">1 1 1 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">5 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">1 1 1 1 1 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">0 0 3 4 3 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">0 1 2 0 1 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">1 1 1 0 1 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">2 4 0 4 0</span> </big></td>
      <td style="vertical-align: top;"><big>Sample Output<br>
      <span style="font-family: monospace;">8 </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">15</span> </big></td>
    </tr>
  </tbody>
</table>
<hr style="width: 100%; height: 2px;">
<p></p>
<p><big>&#1044;&#1086;&#1087;&#1098;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1085;&#1072; &#1083;&#1080;&#1090;&#1077;&#1088;&#1072;&#1090;&#1091;&#1088;&#1072;: <br>
</big></p>
<p><big>[1] &#1051;&#1077;&#1085;&#1076;&#1077;&#1088;&#1090; &#1040;&#1084;&#1077;&#1088;&#1072;&#1083;, &#1040;&#1083;&#1075;&#1086;&#1088;&#1080;&#1090;&#1084;&#1080; &#1080; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1080; &#1086;&#1090; &#1076;&#1072;&#1085;&#1085;&#1080; &#1074; &#1057;++, &#1048;&#1050;
"&#1057;&#1086;&#1092;&#1090;&#1077;&#1093;",
&#1057;&#1086;&#1092;&#1080;&#1103;,&nbsp; 2001, &#1089;&#1090;&#1088;. 340
<br>
[2] &#1045;&#1084;&#1080;&#1083; &#1050;&#1077;&#1083;&#1077;&#1074;&#1077;&#1076;&#1078;&#1080;&#1077;&#1074;, &#1044;&#1080;&#1085;&#1072;&#1084;&#1080;&#1095;&#1085;&#1086; &#1086;&#1087;&#1088;&#1080;&#1084;&#1080;&#1088;&#1072;&#1085;&#1077;, &#1052;&#1091;&#1089;&#1072;&#1083;&#1072; &#1057;&#1086;&#1092;&#1090; &#1080; &#1040;&#1085;&#1091;&#1073;&#1080;&#1089;, &#1057;&#1086;&#1092;&#1080;&#1103;
2001.
<br>
[3] &#1056;&#1086;&#1073;&#1098;&#1088;&#1090; &#1057;&#1077;&#1076;&#1078;&#1091;&#1080;&#1082;, &#1040;&#1083;&#1075;&#1086;&#1088;&#1080;&#1090;&#1084;&#1080; &#1085;&#1072; &#1057;. &#1058;&#1086;&#1084; 1, &#1048;&#1050; "&#1057;&#1086;&#1092;&#1090;&#1077;&#1093;", &#1057;&#1086;&#1092;&#1080;&#1103;, 2002,
&#1089;&#1090;&#1088;. 229.<br>
<br>
</big></p>
<hr style="width: 100%; height: 2px;"><br>
</body>
</html>
