<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
   <meta name="Author" content="Nikolay Kirov">
   <meta name="GENERATOR" content="Mozilla/4.75 [en] (Win98; U) [Netscape]">
   <title>os5</title>
</head>
<body>
<b>16. Конкуренция: "мъртва хватка" и "гладна смърт"</b>
<br><b>Принцини на "мъртва хватка" (МХ).</b>
<p>--- FIGURE 6.1 ---
<p><b>6.1 Принцини на "мъртва хватка" (МХ)</b>
<br>&nbsp;&nbsp;&nbsp; Пример.
<table CELLPADDING=4 COLS=2 WIDTH="100%" >
<tr>
<td><b><tt><font color="#000000">PROCESS&nbsp; P&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get A&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get B&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release A&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release B&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b></td>

<td><b><tt><font color="#000000">PROCESS&nbsp; Q&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get B&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get A&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release B&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release A&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b></td>
</tr>
</table>
&nbsp;&nbsp;&nbsp; Възможни са следните сценарии:
<br><b><tt>1. Q gets B,A -> Q releases B,A -> P executes</tt></b>
<br><b><tt>2. Q gets B,A -> P blocks&nbsp; (A)&nbsp; -> Q releases B,A
-> P executes</tt></b>
<br><b><tt>3. Q gets B&nbsp;&nbsp; -> P gets&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;
-> deadlock !</tt></b>
<br><b><tt>4. P gets A&nbsp;&nbsp; -> Q gets&nbsp;&nbsp;&nbsp;&nbsp; B&nbsp;&nbsp;
-> deadlock !</tt></b>
<br><b><tt>5. P gets A,B -> Q blocks&nbsp; (B)&nbsp; -> P releases A,B
-> Q executes</tt></b>
<br><b><tt>6. P gets A,B -> P releases A,B -> Q executes</tt></b>
<br>--- FIGURE 6.2 ---
<table CELLPADDING=4 WIDTH="100%" >
<tr>
<td><b><tt><font color="#000000">PROCESS P</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get A&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get B&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release A</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release B</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b></td>

<td><b><tt><font color="#000000">PROCESS Q</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get B&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get A&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release B</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release A</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b></td>
</tr>
</table>

<p>&nbsp;&nbsp;&nbsp; Възможна промяна в работата на процеса - за избягване
на МХ:
<br>--- FIGURE 6.3 ---
<table CELLPADDING=4 WIDTH="100%" >
<tr>
<td VALIGN=CENTER><b><tt><font color="#000000">PROCESS P</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b>
<br><b><tt><font color="#006600">Get A</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b>
<br><b><tt><font color="#006600">Release A</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b>
<br><b><tt><font color="#006600">Get B</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b>
<br><b><tt><font color="#006600">Release B</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b></td>

<td><b><tt><font color="#000000">PROCESS Q</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get B&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Get A&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release B</font></tt></b>
<br><b><tt><font color="#006600">...&nbsp;</font></tt></b>
<br><b><tt><font color="#006600">Release A</font></tt></b>
<br><b><tt><font color="#006600">...</font></tt></b></td>
</tr>
</table>

<p>** Многократно използваеми ресурси (Reusable Resources) -&nbsp; процесори,
I/O канали, основна и допълнителна памет, устройства, структури от данни
като файлове, бази данни и семафори.
<p>&nbsp;&nbsp;&nbsp; Пример 1.
<br>&nbsp;&nbsp;&nbsp; Два процеса P и Q използват ресурси магнитен диск
D и магнитна лента T.
<table CELLPADDING=4 COLS=2 WIDTH="100%" >
<tr>
<td><b><font color="#000000">Process P</font></b>
<table BORDER=0 CELLPADDING=4 >
<tr>
<td><b><font color="#006600">Step</font></b></td>

<td><b><font color="#006600">Action</font></b></td>
</tr>

<tr>
<td><font color="#006600">p0</font></td>

<td><font color="#006600">Request (D)</font></td>
</tr>

<tr>
<td><font color="#006600">p1</font></td>

<td><font color="#006600">Lock (D)</font></td>
</tr>

<tr>
<td><font color="#006600">p2</font></td>

<td><font color="#006600">Request (T)</font></td>
</tr>

<tr>
<td><font color="#006600">p3</font></td>

<td><font color="#006600">Lock (T)</font></td>
</tr>

<tr>
<td><font color="#006600">p4</font></td>

<td><font color="#006600">Perform function</font></td>
</tr>

<tr>
<td><font color="#006600">p5</font></td>

<td><font color="#006600">Unlock (D)</font></td>
</tr>

<tr>
<td><font color="#006600">p6</font></td>

<td><font color="#006600">Unlock (T)</font></td>
</tr>
</table>
</td>

<td><b><font color="#000000">Process Q</font></b>
<table CELLSPACING=0 CELLPADDING=4 >
<tr>
<td><b><font color="#006600">Step</font></b></td>

<td><b><font color="#006600">Action</font></b></td>
</tr>

<tr>
<td><font color="#006600">q0</font></td>

<td><font color="#006600">Request (T)</font></td>
</tr>

<tr>
<td><font color="#006600">q1</font></td>

<td><font color="#006600">Lock (T)</font></td>
</tr>

<tr>
<td><font color="#006600">q2</font></td>

<td><font color="#006600">Request (D)</font></td>
</tr>

<tr>
<td><font color="#006600">q3</font></td>

<td><font color="#006600">Lock (D)</font></td>
</tr>

<tr>
<td><font color="#006600">q4</font></td>

<td><font color="#006600">Perform function</font></td>
</tr>

<tr>
<td><font color="#006600">q5</font></td>

<td><font color="#006600">Unlock (T)</font></td>
</tr>

<tr>
<td><font color="#006600">q6</font></td>

<td><font color="#006600">Unlock (D)</font></td>
</tr>
</table>
</td>
</tr>
</table>
&nbsp;&nbsp;&nbsp; МХ се получава при следния сценарии:
<br><b><font color="#006600">&nbsp;&nbsp;&nbsp;<tt> p0 -> p1 -> q0 -> q1
-> p2(-) -> q2(-) -> MX</tt></font></b>
<p>&nbsp;&nbsp;&nbsp; Пример 2.
<br>&nbsp;&nbsp;&nbsp; Два процеса се конкурират за ресурс 200MB памет.
<table CELLSPACING=0 CELLPADDING=4 COLS=2 WIDTH="100%" >
<tr>
<td><b><font color="#006600">Process P1</font></b></td>

<td><b><font color="#006600">Process P2</font></b></td>
</tr>

<tr>
<td><font color="#006600">...</font>
<br><font color="#006600">Request 80 MB</font>
<br><font color="#006600">...</font>
<br><font color="#006600">Request 60 MB</font></td>

<td><font color="#006600">...</font>
<br><font color="#006600">Request 70 MB</font>
<br><font color="#006600">...</font>
<br><font color="#006600">Request 80 MB</font></td>
</tr>
</table>
се конкурират за нея. При страртиране и на двата процеса се получава МХ
при второто искане за памет.
<p>** Условия за МХ.
<br>&nbsp;&nbsp;&nbsp; 1. Взаимно изключване (mutual exclusion) - само
един процес може да владее ресурс в даден момент.
<br>&nbsp;&nbsp;&nbsp; 2. Владея и чакам (очакване на ресурси, hold and
wait) - един процес блокира (владее) един ресурс, докато чака за друг.
<br>&nbsp;&nbsp;&nbsp; 3. Няма отстъпки (непреразпределение, no preemtion)
- един ресурс не може да бъде насилствено освободен от владението на процес.
<br>&nbsp;&nbsp;&nbsp; МХ може да се появи при тези 3 условия, но може
и да не се появи. Следващото условие е достатъчно за поява на МХ.
<br>&nbsp;&nbsp;&nbsp; 4. Циклично чакане (circular wait) -&nbsp; затворена
верига от процеси, като всеки процес владее пони един ресурс, за който
чака следващият процес от веригата.
<br>--- FIGURE 6.5 ---
<br>
<hr WIDTH="100%">
</body>
</html>
